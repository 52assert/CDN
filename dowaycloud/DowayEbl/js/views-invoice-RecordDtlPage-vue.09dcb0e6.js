(window["webpackJsonp_cloud-ebl-app"]=window["webpackJsonp_cloud-ebl-app"]||[]).push([["views-invoice-RecordDtlPage-vue"],{1148:function(e,t,n){"use strict";var i=n("a691"),c=n("1d80");e.exports="".repeat||function(e){var t=String(c(this)),n="",o=i(e);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},"24b4":function(e,t,n){"use strict";n("fe4f")},"3f6c":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("b32d"),c="http://cloud.dowaycn.com/Gateway/CenterService/api/v1/tenant";function o(e){return Object(i["a"])({url:c+"/loadById",method:"get",params:e})}},"408a":function(e,t,n){var i=n("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=i(e))throw TypeError("Incorrect invocation");return+e}},"455d":function(e,t,n){},"4f48":function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"j",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"b",(function(){return f}));var i=n("b32d"),c="http://cloud.dowaycn.com/Gateway/EblService/api/v1/invoice";function o(e){return Object(i["a"])({url:c+"/loadById",method:"get",params:e})}function r(e){return Object(i["a"])({url:c+"/loadByIdReceived",method:"get",params:e})}function a(){return Object(i["a"])({url:c+"/queryAll",method:"get"})}function s(){return Object(i["a"])({url:c+"/queryAllReceived",method:"get"})}function u(e){return Object(i["a"])({url:c+"/searchByExp",method:"post",data:e})}function l(e){return Object(i["a"])({url:c+"/searchReceivedByExp",method:"post",data:e})}function d(e){return Object(i["a"])({url:c+"/add",method:"post",data:e})}function b(e){return Object(i["a"])({url:c+"/update",method:"post",data:e})}function v(e){return Object(i["a"])({url:c+"/sendInvoice",method:"post",data:e})}function f(e){return Object(i["a"])({url:c+"/handleReceiveInvoice",method:"post",data:e})}},"5ed4":function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"k",(function(){return d})),n.d(t,"j",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return m}));var i=n("b32d"),c="http://cloud.dowaycn.com/Gateway/EblService/api/v1/statement";function o(e){return Object(i["a"])({url:c+"/loadById",method:"get",params:e})}function r(e){return Object(i["a"])({url:c+"/loadByIdReceived",method:"get",params:e})}function a(){return Object(i["a"])({url:c+"/queryAll",method:"get"})}function s(){return Object(i["a"])({url:c+"/queryAllReceived",method:"get"})}function u(e){return Object(i["a"])({url:c+"/generateInvoice",method:"post",data:e})}function l(e){return Object(i["a"])({url:c+"/add",method:"post",data:e})}function d(e){return Object(i["a"])({url:c+"/update",method:"post",data:e})}function b(e){return Object(i["a"])({url:c+"/sendStatement",method:"post",data:e})}function v(e){return Object(i["a"])({url:c+"/handleReceivedStatement",method:"post",data:e})}function f(e){return Object(i["a"])({url:c+"/searchByExp",method:"post",data:e})}function m(e){return Object(i["a"])({url:c+"/searchReceivedByExp",method:"post",data:e})}},"74d2":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a}));var i=n("b32d"),c="http://cloud.dowaycn.com/Gateway/BaseService/api/v1/customer";function o(e){return Object(i["a"])({url:c+"/loadByName",method:"get",params:e})}function r(e){return Object(i["a"])({url:c+"/queryAllContacts",method:"get",params:e})}function a(){return Object(i["a"])({url:c+"/query",method:"get"})}},"79a7":function(e,t,n){"use strict";n("455d")},"7db0":function(e,t,n){"use strict";var i=n("23e7"),c=n("b727").find,o=n("44d2"),r=n("ae40"),a="find",s=!0,u=r(a);a in[]&&Array(1)[a]((function(){s=!1})),i({target:"Array",proto:!0,forced:s||!u},{find:function(e){return c(this,e,arguments.length>1?arguments[1]:void 0)}}),o(a)},"8c7d":function(e,t,n){"use strict";n.r(t);n("b0c0"),n("b680");var i=n("7a23"),c=Object(i["withScopeId"])("data-v-6c489de6");Object(i["pushScopeId"])("data-v-6c489de6");var o={class:"page_header"},r=Object(i["createTextVNode"])("发送"),a=Object(i["createTextVNode"])("确认"),s=Object(i["createTextVNode"])("驳回"),u=Object(i["createTextVNode"])("保存"),l=Object(i["createTextVNode"])("编辑"),d=Object(i["createTextVNode"])("放弃"),b={class:"page_body"},v={class:"page_box"},f=Object(i["createVNode"])("span",{class:"title"},"基本信息",-1),m=Object(i["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),h=Object(i["createVNode"])("br",null,null,-1),y=Object(i["createVNode"])("br",null,null,-1),p={class:"page_box"},j=Object(i["createVNode"])("span",{class:"title"},"发票详情",-1),O=Object(i["createTextVNode"])(" 添加明细 "),g=Object(i["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),w={style:{"text-align":"right"}},S={class:"sum_item"},k=Object(i["createVNode"])("span",{style:{"font-weight":"600"}},"未税金额：",-1),V={class:"sum_item"},N=Object(i["createVNode"])("span",{style:{"font-weight":"600"}},"总税额：",-1),x={class:"sum_item"},D=Object(i["createVNode"])("span",{style:{"font-weight":"600"}},"价税总计：",-1),A=Object(i["createVNode"])("div",{class:"clearfix"},null,-1),R={class:"page_box"},T=Object(i["createVNode"])("span",{class:"title"},"对账单详情",-1),I=Object(i["createTextVNode"])(" 添加明细 "),C=Object(i["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),B={style:{height:"475px",overflow:"auto"}};Object(i["popScopeId"])();var _=c((function(e,t,n,_,E,q){var F=Object(i["resolveComponent"])("a-button"),U=Object(i["resolveComponent"])("a-input"),L=Object(i["resolveComponent"])("a-form-item"),P=Object(i["resolveComponent"])("a-date-picker"),H=Object(i["resolveComponent"])("a-select-option"),z=Object(i["resolveComponent"])("a-select"),G=Object(i["resolveComponent"])("a-form"),Y=Object(i["resolveComponent"])("BaseTableEditable"),M=Object(i["resolveComponent"])("a-textarea"),$=Object(i["resolveComponent"])("a-modal"),J=Object(i["resolveComponent"])("a-table");return Object(i["openBlock"])(),Object(i["createBlock"])(i["Fragment"],null,[Object(i["createVNode"])("div",o,[Object(i["withDirectives"])(Object(i["createVNode"])(F,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:e.send},{default:c((function(){return[r]})),_:1},8,["onClick"]),[[i["vShow"],("send"===e.type||void 0!==e.id)&&"草稿"===e.invoice.status]]),Object(i["withDirectives"])(Object(i["createVNode"])(F,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[1]||(t[1]=function(t){return e.handleReceivedPurchaseOrder("adopt")})},{default:c((function(){return[a]})),_:1},512),[[i["vShow"],"receive"===e.type&&void 0!==e.id]]),Object(i["withDirectives"])(Object(i["createVNode"])(F,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[2]||(t[2]=function(t){return e.rejectReasonVisible=!0})},{default:c((function(){return[s]})),_:1},512),[[i["vShow"],"receive"===e.type&&void 0!==e.id]]),Object(i["withDirectives"])(Object(i["createVNode"])(F,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:e.saveHandler},{default:c((function(){return[u]})),_:1},8,["onClick"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])(F,{style:{color:"#5259e5",border:"1px solid #5259e5"},onClick:t[3]||(t[3]=function(t){return e.sysStatus="edit"})},{default:c((function(){return[l]})),_:1},512),[[i["vShow"],"send"===e.type&&"view"===e.sysStatus&&void 0!==e.id]]),Object(i["withDirectives"])(Object(i["createVNode"])(F,{style:{color:"#5259e5",border:"1px solid #5259e5"},onClick:e.cancelEdit},{default:c((function(){return[d]})),_:1},8,["onClick"]),[[i["vShow"],"send"===e.type&&"edit"===e.sysStatus]])]),Object(i["createVNode"])("div",b,[Object(i["createVNode"])("div",v,[f,m,Object(i["createVNode"])(G,{ref:"purchaseBaseForm",model:e.invoice,rules:e.rules,layout:"inline","label-col":{offset:1,span:5},"wrapper-col":{offset:1,span:17}},{default:c((function(){return[Object(i["createVNode"])(L,{label:"发票编码",name:"code","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.code,"onUpdate:value":t[4]||(t[4]=function(t){return e.invoice.code=t}),placeholder:"请输入发票编码"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.code),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"开票日期",name:"date","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(P,{value:e.invoice.date,"onUpdate:value":t[5]||(t[5]=function(t){return e.invoice.date=t}),placeholder:"请选择开票日期",style:{width:"100%"}},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.dateFormat(e.invoice.date)),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"服务名称",name:"name","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.name,"onUpdate:value":t[6]||(t[6]=function(t){return e.invoice.name=t}),placeholder:"请输入服务名称"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.name),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"备注",name:"remark","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.remark,"onUpdate:value":t[7]||(t[7]=function(t){return e.invoice.remark=t}),placeholder:"请输入备注"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.remark),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"发票金额",name:"amount","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.invoice.amount)+" 元 ",1)]})),_:1}),h,Object(i["createVNode"])(L,{label:"购票方",name:"buyer","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])("div",null,[Object(i["createVNode"])(z,{value:e.invoice.buyer,"onUpdate:value":t[8]||(t[8]=function(t){return e.invoice.buyer=t}),placeholder:"请选择客户名称","show-search":"","default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",style:{width:"100%"},onFocus:e.focusHandler,onSearch:e.handleCustomerSearch,onSelect:e.handleCustomerSelect},{default:c((function(){return[(Object(i["openBlock"])(!0),Object(i["createBlock"])(i["Fragment"],null,Object(i["renderList"])(e.customers,(function(e){return Object(i["openBlock"])(),Object(i["createBlock"])(H,{key:e.id},{default:c((function(){return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.name),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])],512),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.buyer),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"公司地址",name:"buyerAddress","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.buyerAddress,"onUpdate:value":t[9]||(t[9]=function(t){return e.invoice.buyerAddress=t}),placeholder:"请输入公司地址"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.buyerAddress),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"联系电话",name:"buyerAddress","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.buyerAddress,"onUpdate:value":t[10]||(t[10]=function(t){return e.invoice.buyerAddress=t}),placeholder:"请输入联系电话"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.buyerAddress),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"联系电话",name:"buyerTel","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.buyerTel,"onUpdate:value":t[11]||(t[11]=function(t){return e.invoice.buyerTel=t}),placeholder:"请输入联系电话"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.buyerTel),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"纳税号",name:"buyerIdentification","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{disabled:"",value:e.invoice.buyerIdentification,"onUpdate:value":t[12]||(t[12]=function(t){return e.invoice.buyerIdentification=t}),placeholder:"请输入纳税号"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.buyerIdentification),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"开户行",name:"buyerRegBank","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.buyerRegBank,"onUpdate:value":t[13]||(t[13]=function(t){return e.invoice.buyerRegBank=t}),placeholder:"请输入开户行"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.buyerRegBank),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"银行账号",name:"buyerAccount","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.buyerAccount,"onUpdate:value":t[14]||(t[14]=function(t){return e.invoice.buyerAccount=t}),placeholder:"请输入银行账号"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.buyerAccount),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),y,Object(i["createVNode"])(L,{label:"销售方",name:"seller","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.seller,"onUpdate:value":t[15]||(t[15]=function(t){return e.invoice.seller=t}),placeholder:"请输入销售方"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.seller),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"公司地址",name:"sellerAddress","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.sellerAddress,"onUpdate:value":t[16]||(t[16]=function(t){return e.invoice.sellerAddress=t}),placeholder:"请输入公司地址"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.sellerAddress),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"联系电话",name:"sellerTel","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.sellerTel,"onUpdate:value":t[17]||(t[17]=function(t){return e.invoice.sellerTel=t}),placeholder:"请输入联系电话"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.sellerTel),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"纳税号",name:"sellerIdentification","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{disabled:"",value:e.invoice.sellerIdentification,"onUpdate:value":t[18]||(t[18]=function(t){return e.invoice.sellerIdentification=t}),placeholder:"请输入纳税号"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.sellerIdentification),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"开户行",name:"sellerRegBank","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.sellerRegBank,"onUpdate:value":t[19]||(t[19]=function(t){return e.invoice.sellerRegBank=t}),placeholder:"请输入开户行"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.sellerRegBank),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(i["createVNode"])(L,{label:"银行账号",name:"sellerAccount","has-feedback":"",style:{width:"31%"}},{default:c((function(){return[Object(i["withDirectives"])(Object(i["createVNode"])(U,{value:e.invoice.sellerAccount,"onUpdate:value":t[20]||(t[20]=function(t){return e.invoice.sellerAccount=t}),placeholder:"请输入银行账号"},null,8,["value"]),[[i["vShow"],"edit"===e.sysStatus]]),Object(i["withDirectives"])(Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.invoice.sellerAccount),513),[[i["vShow"],"view"===e.sysStatus]])]})),_:1})]})),_:1},8,["model","rules"])]),Object(i["createVNode"])("div",p,[j,Object(i["withDirectives"])(Object(i["createVNode"])(F,{style:{float:"right",color:"#5259e5",border:"1px solid #5259e5"},onClick:e.addInvoiceDtl},{default:c((function(){return[O]})),_:1},8,["onClick"]),[[i["vShow"],"edit"===e.sysStatus]]),g,Object(i["createVNode"])(Y,{columns:e.invoiceDtlColumns,sourceData:e.invoiceDtls,editableCols:e.editableCols,onRowDelete:e.rowDeleteHandler,onCancelEdit:e.cancelEditHandler,onRowChange:e.rowChangeHandler},null,8,["columns","sourceData","editableCols","onRowDelete","onCancelEdit","onRowChange"]),Object(i["createVNode"])("div",w,[Object(i["createVNode"])("div",S,[k,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.noTaxAmount.toFixed(2)),1)]),Object(i["createVNode"])("div",V,[N,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.totalTaxAmount.toFixed(2)),1)]),Object(i["createVNode"])("div",x,[D,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.totalAmount.toFixed(2)),1)]),A])]),Object(i["createVNode"])("div",R,[T,Object(i["withDirectives"])(Object(i["createVNode"])(F,{style:{float:"right",color:"#5259e5",border:"1px solid #5259e5"},onClick:e.addStatement},{default:c((function(){return[I]})),_:1},8,["onClick"]),[[i["vShow"],"edit"===e.sysStatus]]),C,Object(i["createVNode"])(Y,{columns:e.statementColumns,sourceData:e.statements},null,8,["columns","sourceData"])])]),Object(i["createVNode"])($,{visible:e.rejectReasonVisible,"onUpdate:visible":t[22]||(t[22]=function(t){return e.rejectReasonVisible=t}),centered:"",closable:!1,"mask-closable":!1,onOk:t[23]||(t[23]=function(t){return e.handleReceivedInvoice("reject")}),okText:"确定",cancelText:"取消"},{default:c((function(){return[Object(i["createVNode"])(M,{value:e.reason,"onUpdate:value":t[21]||(t[21]=function(t){return e.reason=t}),placeholder:"请输入驳回原因",rows:8},null,8,["value"])]})),_:1},8,["visible"]),Object(i["createVNode"])($,{visible:e.statementShowVisible,"onUpdate:visible":t[24]||(t[24]=function(t){return e.statementShowVisible=t}),title:"请选择相应的对账单",centered:"",width:"1080px",closable:!1,"mask-closable":!1,onOk:e.selectStatement,okText:"确定",cancelText:"取消"},{default:c((function(){return[Object(i["createVNode"])("div",B,[Object(i["createVNode"])(J,{columns:e.statementColumns,"data-source":e.statementData,"row-selection":e.rowSelection,pagination:!1},null,8,["columns","data-source","row-selection"])])]})),_:1},8,["visible","onOk"])],64)})),E=(n("7db0"),n("4160"),n("a434"),n("d3b7"),n("159b"),n("368b"),n("56cd")),q=(n("519e"),n("0bb7")),F=(n("04f3"),n("ed3b")),U=(n("e1f5"),n("5efb")),L=n("9096"),P=n("c1df"),H=n.n(P),z=n("4f48"),G=n("5ed4"),Y=n("74d2"),M=n("3f6c"),$=Object(i["defineComponent"])({components:{"a-button":U["a"],"a-modal":F["a"],"a-date-picker":q["a"],BaseTableEditable:L["a"]},setup:function(){var e=Object(i["ref"])("edit"),t=function(e,t,n){return null===t?Promise.reject(e.message):Promise.resolve()},n=Object(i["reactive"])([{title:"序号",dataIndex:"key",key:"key",width:70},{title:"服务名称",dataIndex:"name",key:"name",slots:{customRender:"name"}},{title:"规格型号",dataIndex:"model",key:"model",ellipsis:!0,slots:{customRender:"model"}},{title:"计量单位",dataIndex:"uom",key:"uom",ellipsis:!0,slots:{customRender:"uom"}},{title:"数量",dataIndex:"num",key:"num",ellipsis:!0,slots:{customRender:"num"}},{title:"单价",dataIndex:"price",key:"price",ellipsis:!0,slots:{customRender:"price"}},{title:"税率",dataIndex:"taxRate",key:"taxRate",ellipsis:!0,slots:{customRender:"taxRate"}},{title:"金额",dataIndex:"money",key:"money",ellipsis:!0,slots:{customRender:"money"}},{title:"税额",dataIndex:"taxAmount",key:"taxAmount",ellipsis:!0,slots:{customRender:"taxAmount"}},{title:"价税合计",dataIndex:"total",key:"total",ellipsis:!0,slots:{customRender:"total"}},{title:"操作",dataIndex:"operation",key:"operation",slots:{customRender:"operation"}}]),c=(Object(i["reactive"])({code:[{required:!0,message:"发票编码不能为空",trigger:"blur"}],name:[{required:!0,message:"服务名称不能为空",trigger:"blur"}],date:[{validator:t,message:"开票日期不能为空",trigger:"blur"}],remark:[{required:!0,message:"备注不能为空",trigger:"blur"}],buyer:[{required:!0,message:"购票方不能为空",trigger:"blur"}],buyerAddress:[{required:!0,message:"公司地址不能为空",trigger:"blur"}],buyerTel:[{required:!0,message:"联系电话不能为空",trigger:"blur"}],buyerIdentification:[{required:!0,message:"纳税号不能为空",trigger:"blur"}],buyerRegBank:[{required:!0,message:"开户行不能为空",trigger:"blur"}],buyerAccount:[{required:!0,message:"银行账号不能为空",trigger:"blur"}],seller:[{required:!0,message:"销售方不能为空",trigger:"blur"}],sellerAddress:[{required:!0,message:"公司地址不能为空",trigger:"blur"}],sellerTel:[{required:!0,message:"联系电话不能为空",trigger:"blur"}],sellerIdentification:[{required:!0,message:"纳税号不能为空",trigger:"blur"}],sellerRegBank:[{required:!0,message:"开户行不能为空",trigger:"blur"}],sellerAccount:[{required:!0,message:"银行帐号不能为空",trigger:"blur"}]}),Object(i["reactive"])({id:"",name:"",code:"",date:H()(),remark:"",amount:0,buyer:"",buyerAddress:"",buyerTel:"",buyerIdentification:"",buyerRegBank:"",buyerAccount:"",seller:"",sellerAddress:"",sellerTel:"",sellerIdentification:"",sellerRegBank:"",sellerAccount:"",status:"draft",authorizationCode:"",businessLicense:"",senderBusinessLicense:"",rowVersion:"",invoiceDetails:[],statements:[]})),o=["name","model","uom","num","price","taxRate"],r=Object(i["reactive"])([]),a=function(){r.push({key:String(r.length+1),name:"",model:"",uom:"",num:"",price:"",money:0,taxRate:"",taxAmount:0,total:0,rowVersion:"",editable:!0})},s=Object(i["reactive"])([{title:"序号",dataIndex:"key",key:"key",width:70},{title:"对账单号",dataIndex:"code",key:"code"},{title:"客户名称",dataIndex:"custName",key:"custName",ellipsis:!0},{title:"开始时间",dataIndex:"startTime",key:"startTime",ellipsis:!0},{title:"结束时间",dataIndex:"endTime",key:"endTime",ellipsis:!0},{title:"对账方",dataIndex:"statementParty",key:"statementParty",ellipsis:!0},{title:"对账金额",dataIndex:"amount",key:"amount",ellipsis:!0},{title:"已收金额",dataIndex:"received",key:"received",ellipsis:!0},{title:"欠款金额",dataIndex:"unreceived",key:"unreceived",ellipsis:!0},{title:"操作",dataIndex:"operation",key:"operation",slots:{customRender:"operation"}}]),u=Object(i["reactive"])([]),l=Object(i["reactive"])([]),d=Object(i["reactive"])([]),b=[],v=Object(i["ref"])(!1),f=Object(i["reactive"])({onChange:function(e,t){void 0!==t&&(b=t)}}),m=function(){v.value=!0,b=[],Object(G["g"])().then((function(e){e.content.forEach((function(e){u.push({key:String(u.length+1),id:e.id,code:e.code,custName:e.custName,startTime:e.startTime,endTime:e.endTime,statementParty:e.statementParty,amount:e.amount,received:e.received,unreceived:e.unreceived,rowVersion:e.rowVersion})}))})).catch((function(e){E["a"].error({message:"错误",description:e}),console.debug(e)}))},h=function(e){l.splice(e,1)},y=function(){d=b,d.forEach((function(e){l.push({key:String(l.length+1),id:e.id,code:e.code,custName:e.custName,startTime:e.startTime,endTime:e.endTime,statementParty:e.statementParty,amount:e.amount,received:e.received,unreceived:e.unreceived,rowVersion:e.rowVersion})})),v.value=!1},p=Object(i["ref"])(!1),j=Object(i["ref"])(""),O=function(e){r.forEach((function(t,n,i){t.key===e&&i.splice(n,1)}))},g=function(e){r.forEach((function(t,n,i){t.key===e&&(i[n].name="",i[n].model="",i[n].uom="",i[n].num="",i[n].price="",i[n].taxRate="",i[n].money=0,i[n].taxAmount=0,i[n].total=0)}))},w=function(e){e.money=e.num*e.price,e.taxAmount=e.money*e.taxRate,e.total=e.money+e.taxAmount},S=function(){""===c.businessLicense?E["a"].error({message:"错误",description:"未填写供应商信用代码，无法识别当前供应商，请完善供应商信息，并重新选取供应商"}):""===c.authorizationCode?E["a"].error({message:"错误",description:"当前所选供应商还不是您的合作伙伴"}):F["a"].confirm({title:"请确认",content:"确定要发送当前发票吗？",cancelText:"取消",okText:"确认",onOk:function(){Object(z["i"])([c.id]).then((function(e){200===e.code&&E["a"].success({message:"成功",description:"发送成功"})})).catch((function(e){E["a"].error({message:"错误",description:e}),console.debug(e)}))}})};return{sysStatus:e,invoiceDtlColumns:n,invoice:c,editableCols:o,invoiceDtls:r,addInvoiceDtl:a,statementColumns:s,statementData:u,statements:l,statementShowVisible:v,rowSelection:f,addStatement:m,deleteStatement:h,selectStatement:y,reason:j,rejectReasonVisible:p,rowDeleteHandler:O,cancelEditHandler:g,rowChangeHandler:w,send:S}},data:function(){return{id:this.$route.query.id,type:this.$route.query.type,customers:[]}},computed:{noTaxAmount:function(){var e=0;return this.invoiceDtls.forEach((function(t){e+=t.money})),e},totalTaxAmount:function(){var e=0;return this.invoiceDtls.forEach((function(t){e+=t.taxAmount})),e},totalAmount:function(){var e=0;return this.invoiceDtls.forEach((function(t){e+=t.total})),e}},created:function(){void 0!==this.id&&void 0!==this.type?(this.getData(String(this.id),String(this.type)),this.sysStatus="view"):(this.sysStatus="edit",this.loadTenant())},methods:{getInvoice:function(e){var t=this;Object(z["c"])({id:e}).then((function(e){t.invoice.id=e.content.id,t.invoice.code=e.content.code,t.invoice.date=e.content.date,t.invoice.amount=e.content.amount,t.invoice.buyer=e.content.buyer,t.invoice.buyerIdentification=e.content.buyerIdentification,t.invoice.buyerAddress=e.content.buyerAddress,t.invoice.buyerTel=e.content.buyerTel,t.invoice.buyerRegBank=e.content.buyerRegBank,t.invoice.buyerAccount=e.content.buyerAccount,t.invoice.seller=e.content.seller,t.invoice.sellerIdentification=e.content.sellerIdentification,t.invoice.sellerAddress=e.content.sellerAddress,t.invoice.sellerTel=e.content.sellerTel,t.invoice.sellerRegBank=e.content.sellerRegBank,t.invoice.sellerAccount=e.content.sellerAccount,t.invoice.remark=e.content.remark,t.invoice.status=t.textFormat(e.content.status),t.invoice.authorizationCode=e.content.authorizationCode,t.invoice.businessLicense=e.content.businessLicense,t.invoice.senderBusinessLicense=e.content.senderBusinessLicense,t.invoice.rowVersion=e.content.rowVersion,e.content.invoiceDetails.forEach((function(e){t.invoiceDtls.push({key:String(t.invoiceDtls.length+1),name:e.name,model:e.model,uom:e.uom,num:e.num,price:e.price,money:e.money,taxRate:e.taxRate,taxAmount:e.taxAmount,total:e.total,rowVersion:e.rowVersion})})),e.content.statements.forEach((function(e){t.statements.push({key:String(t.statements.length+1),id:e.id,code:e.code,custName:e.custName,startTime:e.startTime,endTime:e.endTime,statementParty:e.statementParty,amount:e.amount,received:e.received,unreceived:e.unreceived,rowVersion:e.rowVersion})}))})).catch((function(e){E["a"].error({message:"错误",description:e}),console.debug(e)}))},getInvoiceReceived:function(e){var t=this;Object(z["d"])({id:e}).then((function(e){t.invoice.id=e.content.id,t.invoice.code=e.content.code,t.invoice.date=e.content.date,t.invoice.amount=e.content.amount,t.invoice.buyer=e.content.buyer,t.invoice.buyerIdentification=e.content.buyerIdentification,t.invoice.buyerAddress=e.content.buyerAddress,t.invoice.buyerTel=e.content.buyerTel,t.invoice.buyerRegBank=e.content.buyerRegBank,t.invoice.buyerAccount=e.content.buyerAccount,t.invoice.seller=e.content.seller,t.invoice.sellerIdentification=e.content.sellerIdentification,t.invoice.sellerAddress=e.content.sellerAddress,t.invoice.sellerTel=e.content.sellerTel,t.invoice.sellerRegBank=e.content.sellerRegBank,t.invoice.sellerAccount=e.content.sellerAccount,t.invoice.remark=e.content.remark,t.invoice.status=t.textFormat(e.content.status),t.invoice.authorizationCode=e.content.authorizationCode,t.invoice.businessLicense=e.content.businessLicense,t.invoice.senderBusinessLicense=e.content.senderBusinessLicense,t.invoice.rowVersion=e.content.rowVersion,e.content.invoiceDetailReceiveds.forEach((function(e){t.invoiceDtls.push({key:String(t.invoiceDtls.length+1),name:e.name,model:e.model,uom:e.uom,num:e.num,price:e.price,money:e.money,taxRate:e.taxRate,taxAmount:e.taxAmount,total:e.total,rowVersion:e.rowVersion})})),e.content.statementReceiveds.forEach((function(e){t.statements.push({key:String(t.statements.length+1),id:e.id,code:e.code,custName:e.custName,startTime:e.startTime,endTime:e.endTime,statementParty:e.statementParty,amount:e.amount,received:e.received,unreceived:e.unreceived,rowVersion:e.rowVersion})}))})).catch((function(e){E["a"].error({message:"错误",description:e}),console.debug(e)}))},getData:function(e,t){"send"===t?this.getInvoice(e):"receive"===t&&this.getInvoiceReceived(e)},focusHandler:function(){var e=this;Object(Y["b"])().then((function(t){e.customers=t.content})).catch((function(e){E["a"].error({message:"错误",description:e}),console.debug(e)}))},handleCustomerSelect:function(e){var t=this.customers.find((function(t){return t.id===e}));this.invoice.buyerIdentification=t.businessLicense,this.invoice.buyerAddress=t.address,this.invoice.buyerTel=t.tel,this.invoice.buyerRegBank=t.regBank,this.invoice.buyerAccount=t.regBankAccount,this.invoice.authorizationCode=t.authorizationCode,this.invoice.businessLicense=t.businessLicense},handleCustomerSearch:function(e){var t=this;t.customers=[],Object(Y["a"])({name:e}).then((function(e){t.customers=e.content})).catch((function(e){E["a"].error({message:"错误",description:e}),console.debug(e)}))},loadTenant:function(){var e=this;Object(M["a"])({id:localStorage.getItem("doway_cloud_tenant_id")}).then((function(t){200===t.code&&(e.invoice.senderBusinessLicense=t.content.creditCode,e.invoice.sellerIdentification=t.content.creditCode,t.content.name&&t.content.address&&t.content.tel&&t.content.regBank&&t.content.account||E["a"].warning({message:"警告",description:"当前租户信息缺失，请到信息设置中完善"}),e.invoice.seller=t.content.name,e.invoice.sellerAddress=t.content.address,e.invoice.sellerTel=t.content.tel,e.invoice.sellerRegBank=t.content.regBank,e.invoice.sellerAccount=t.content.account)})).catch((function(e){E["a"].error({message:"错误",description:e}),console.debug(e)}))},cancelEdit:function(){void 0!==this.id?this.sysStatus="view":this.$router.push({path:"/invoiceRecord"})},handleReceivedInvoice:function(e){var t=this,n={ids:[t.invoice.id],result:e,reason:t.reason};Object(z["b"])(n).then((function(e){t.rejectReasonVisible=!1,200===e.code&&E["a"].success({message:"成功",description:"已处理"})})).catch((function(e){E["a"].error({message:"错误",description:e}),console.debug(e)}))},textFormat:function(e){switch(e){case"draft":return"草稿";case"published":return"已发布";case"confirmed":return"已确认";case"rejected":return"已驳回";case"untreated":return"未处理";default:return e}},saveHandler:function(){var e=this;e.invoice.statements=e.statements,e.invoice.invoiceDetails=e.invoiceDtls;var t=e.invoice;void 0!==e.id?Object(z["j"])(t).then((function(t){200===t.code&&(e.sysStatus="view")})).catch((function(e){E["a"].error({message:"错误",description:e}),console.debug(e)})):Object(z["a"])(t).then((function(t){200===t.code&&(e.sysStatus="view",e.id=t.content)})).catch((function(e){E["a"].error({message:"错误",description:e}),console.debug(e)}))},dateFormat:function(e){return H()(e).format("YYYY-MM-DD")}}});n("79a7"),n("24b4");$.render=_,$.__scopeId="data-v-6c489de6";t["default"]=$},b0c0:function(e,t,n){var i=n("83ab"),c=n("9bf2").f,o=Function.prototype,r=o.toString,a=/^\s*function ([^ (]*)/,s="name";i&&!(s in o)&&c(o,s,{configurable:!0,get:function(){try{return r.call(this).match(a)[1]}catch(e){return""}}})},b680:function(e,t,n){"use strict";var i=n("23e7"),c=n("a691"),o=n("408a"),r=n("1148"),a=n("d039"),s=1..toFixed,u=Math.floor,l=function(e,t,n){return 0===t?n:t%2===1?l(e,t-1,n*e):l(e*e,t/2,n)},d=function(e){var t=0,n=e;while(n>=4096)t+=12,n/=4096;while(n>=2)t+=1,n/=2;return t},b=s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!a((function(){s.call({})}));i({target:"Number",proto:!0,forced:b},{toFixed:function(e){var t,n,i,a,s=o(this),b=c(e),v=[0,0,0,0,0,0],f="",m="0",h=function(e,t){var n=-1,i=t;while(++n<6)i+=e*v[n],v[n]=i%1e7,i=u(i/1e7)},y=function(e){var t=6,n=0;while(--t>=0)n+=v[t],v[t]=u(n/e),n=n%e*1e7},p=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==v[e]){var n=String(v[e]);t=""===t?n:t+r.call("0",7-n.length)+n}return t};if(b<0||b>20)throw RangeError("Incorrect fraction digits");if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return String(s);if(s<0&&(f="-",s=-s),s>1e-21)if(t=d(s*l(2,69,1))-69,n=t<0?s*l(2,-t,1):s/l(2,t,1),n*=4503599627370496,t=52-t,t>0){h(0,n),i=b;while(i>=7)h(1e7,0),i-=7;h(l(10,i,1),0),i=t-1;while(i>=23)y(1<<23),i-=23;y(1<<i),h(1,1),y(2),m=p()}else h(0,n),h(1<<-t,0),m=p()+r.call("0",b);return b>0?(a=m.length,m=f+(a<=b?"0."+r.call("0",b-a)+m:m.slice(0,a-b)+"."+m.slice(a-b))):m=f+m,m}})},fe4f:function(e,t,n){}}]);