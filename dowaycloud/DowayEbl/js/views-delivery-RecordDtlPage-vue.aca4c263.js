(window["webpackJsonp_cloud-ebl-app"]=window["webpackJsonp_cloud-ebl-app"]||[]).push([["views-delivery-RecordDtlPage-vue"],{"1ce7":function(e,t,o){"use strict";o("bbb4")},"307e":function(e,t,o){"use strict";o("e48b")},"74d2":function(e,t,o){"use strict";o.d(t,"a",(function(){return c})),o.d(t,"c",(function(){return i})),o.d(t,"b",(function(){return a}));var r=o("b32d"),n="http://cloud.dowaycn.com/Gateway/BaseService/api/v1/customer";function c(e){return Object(r["a"])({url:n+"/loadByName",method:"get",params:e})}function i(e){return Object(r["a"])({url:n+"/queryAllContacts",method:"get",params:e})}function a(){return Object(r["a"])({url:n+"/query",method:"get"})}},"7c49":function(e,t,o){"use strict";o.r(t);o("b0c0");var r=o("7a23"),n=Object(r["withScopeId"])("data-v-f2387354");Object(r["pushScopeId"])("data-v-f2387354");var c={class:"header"},i=Object(r["createTextVNode"])("发送"),a=Object(r["createTextVNode"])("确认"),s=Object(r["createTextVNode"])("驳回"),d=Object(r["createTextVNode"])("保存为草稿"),l={style:{float:"right","text-align":"center"}},u=Object(r["createVNode"])("a",{href:"http://cloud.dowaycn.com/Gateway/EblService/api/v1/delivery/deliveryDown"},"下载模板",-1),v=Object(r["createTextVNode"])("上传文件"),b={class:"info"},h={class:"box"},y=Object(r["createVNode"])("span",{class:"title"},"基本信息",-1),p=Object(r["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),f={key:1},m={key:1},j=Object(r["createVNode"])("br",null,null,-1),O=Object(r["createVNode"])("br",null,null,-1),g=Object(r["createVNode"])("br",null,null,-1),w=Object(r["createVNode"])("br",null,null,-1),S={class:"box"},V=Object(r["createVNode"])("span",{class:"title"},"送货信息",-1),D=Object(r["createTextVNode"])(" 添加明细 "),k=Object(r["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1);Object(r["popScopeId"])();var N=n((function(e,t,o,N,C,T){var x=Object(r["resolveComponent"])("a-button"),I=Object(r["resolveComponent"])("a-upload"),_=Object(r["resolveComponent"])("a-input"),B=Object(r["resolveComponent"])("a-form-item"),R=Object(r["resolveComponent"])("a-date-picker"),q=Object(r["resolveComponent"])("a-select-option"),E=Object(r["resolveComponent"])("a-select"),L=Object(r["resolveComponent"])("a-form"),F=Object(r["resolveComponent"])("BaseTableEditable"),U=Object(r["resolveComponent"])("a-textarea"),M=Object(r["resolveComponent"])("a-modal");return Object(r["openBlock"])(),Object(r["createBlock"])(r["Fragment"],null,[Object(r["createVNode"])("div",c,[Object(r["withDirectives"])(Object(r["createVNode"])(x,{style:{background:"#5259e5",color:"#fff",margin:"0px 10px"},onClick:e.send},{default:n((function(){return[i]})),_:1},8,["onClick"]),[[r["vShow"],("send"===e.type||void 0!==e.id)&&"草稿"===e.delivery.status]]),Object(r["withDirectives"])(Object(r["createVNode"])(x,{style:{background:"#5259e5",color:"#fff",margin:"0px 10px"},onClick:t[1]||(t[1]=function(t){return e.handleReceivedDeliveryOrder("adopt")})},{default:n((function(){return[a]})),_:1},512),[[r["vShow"],"receive"===e.type&&void 0!==e.id&&"untreated"===e.delivery.status]]),Object(r["withDirectives"])(Object(r["createVNode"])(x,{style:{background:"#5259e5",color:"#fff",margin:"0px 10px"},onClick:t[2]||(t[2]=function(t){return e.rejectReasonVisible=!0})},{default:n((function(){return[s]})),_:1},512),[[r["vShow"],"receive"===e.type&&void 0!==e.id&&"untreated"===e.statementInfo.status]]),Object(r["withDirectives"])(Object(r["createVNode"])(x,{style:{color:"#5259e5",border:"1px solid #5259e5"},onClick:e.saveAsDraft},{default:n((function(){return[d]})),_:1},8,["onClick"]),[[r["vShow"],void 0===e.id]]),Object(r["createVNode"])("div",l,[Object(r["withDirectives"])(Object(r["createVNode"])(x,{style:{"margin-right":"10px"}},{default:n((function(){return[u]})),_:1},512),[[r["vShow"],void 0===e.id]]),Object(r["withDirectives"])(Object(r["createVNode"])(I,{ref:"upload",action:"",multiple:!0,"file-list":e.fileList,"auto-upload":!1,limit:1,customRequest:e.importWordConfirm},{default:n((function(){return[Object(r["createVNode"])(x,{style:{color:"#5259e5",border:"1px solid #5259e5"}},{default:n((function(){return[v]})),_:1})]})),_:1},8,["file-list","customRequest"]),[[r["vShow"],void 0===e.id]])])]),Object(r["createVNode"])("div",b,[Object(r["createVNode"])("div",h,[y,p,Object(r["createVNode"])(L,{ref:"deliveryForm",model:e.delivery,rules:e.rules,layout:"inline","label-col":{offset:1,span:5},"wrapper-col":{offset:1,span:17}},{default:n((function(){return[Object(r["createVNode"])(B,{label:"送货单号",name:"code","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["withDirectives"])(Object(r["createVNode"])(_,{value:e.delivery.code,"onUpdate:value":t[3]||(t[3]=function(t){return e.delivery.code=t}),placeholder:"请输入送货单号"},null,8,["value"]),[[r["vShow"],"edit"===e.sysStatus]]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.code),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(r["createVNode"])(B,{label:"订单日期",name:"orderDate","has-feedback":"",style:{width:"31%"}},{default:n((function(){return["edit"===e.sysStatus?(Object(r["openBlock"])(),Object(r["createBlock"])(R,{key:0,placeholder:"请选择日期",value:e.delivery.orderDate,"onUpdate:value":t[4]||(t[4]=function(t){return e.delivery.orderDate=t}),style:{width:"100%"}},null,8,["value"])):Object(r["createCommentVNode"])("",!0),"view"===e.sysStatus?(Object(r["openBlock"])(),Object(r["createBlock"])("span",f,Object(r["toDisplayString"])(e.dateFormat(e.delivery.orderDate)),1)):Object(r["createCommentVNode"])("",!0)]})),_:1}),Object(r["createVNode"])(B,{label:"送货日期",name:"deliveryDate","has-feedback":"",style:{width:"31%"}},{default:n((function(){return["edit"===e.sysStatus?(Object(r["openBlock"])(),Object(r["createBlock"])(R,{key:0,placeholder:"请选择日期",value:e.delivery.deliveryDate,"onUpdate:value":t[5]||(t[5]=function(t){return e.delivery.deliveryDate=t}),style:{width:"100%"}},null,8,["value"])):Object(r["createCommentVNode"])("",!0),"view"===e.sysStatus?(Object(r["openBlock"])(),Object(r["createBlock"])("span",m,Object(r["toDisplayString"])(e.dateFormat(e.delivery.deliveryDate)),1)):Object(r["createCommentVNode"])("",!0)]})),_:1}),Object(r["createVNode"])(B,{label:"总重量",name:"totalWeight","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["withDirectives"])(Object(r["createVNode"])(_,{value:e.delivery.totalWeight,"onUpdate:value":t[6]||(t[6]=function(t){return e.delivery.totalWeight=t}),placeholder:"请输入总重量"},null,8,["value"]),[[r["vShow"],"edit"===e.sysStatus]]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.totalWeight),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(r["createVNode"])(B,{label:"总体积",name:"totalVol","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["withDirectives"])(Object(r["createVNode"])(_,{value:e.delivery.totalVol,"onUpdate:value":t[7]||(t[7]=function(t){return e.delivery.totalVol=t}),placeholder:"请输入总体积"},null,8,["value"]),[[r["vShow"],"edit"===e.sysStatus]]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.totalVol),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(r["createVNode"])(B,{label:"运输方式",name:"shippingType","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["withDirectives"])(Object(r["createVNode"])(_,{value:e.delivery.shippingType,"onUpdate:value":t[8]||(t[8]=function(t){return e.delivery.shippingType=t}),placeholder:"请输入运输方式"},null,8,["value"]),[[r["vShow"],"edit"===e.sysStatus]]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.shippingType),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1}),j,O,Object(r["createVNode"])(B,{label:"收货方",name:"shipTo","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["withDirectives"])(Object(r["createVNode"])("div",null,[Object(r["createVNode"])(E,{"show-search":"",value:e.delivery.customerId,"onUpdate:value":t[9]||(t[9]=function(t){return e.delivery.customerId=t}),placeholder:"请选择收货方",onFocus:e.focusHandler,style:{width:"100%"},"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",onSearch:e.handleCustomerSearch,onSelect:e.handleCustomerSelect},{default:n((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.customers,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])(q,{key:e.id},{default:n((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.name),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])],512),[[r["vShow"],"edit"===e.sysStatus]]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.shipTo),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(r["createVNode"])(B,{label:"收货联系人",name:"contacts","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["createVNode"])("div",null,[Object(r["createVNode"])(E,{"show-search":"",value:e.delivery.contacts,"onUpdate:value":t[10]||(t[10]=function(t){return e.delivery.contacts=t}),placeholder:"请选择收货联系人",onFocus:e.focusDeliCont,style:{width:"100%"},"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",onSearch:e.handleSearch,onSelect:e.handleSelect},{default:n((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.customerContacts,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])(q,{key:e.id},{default:n((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.contacts),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.contacts),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(r["createVNode"])(B,{label:"联系方式",name:"tel","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["withDirectives"])(Object(r["createVNode"])(_,{value:e.delivery.tel,"onUpdate:value":t[11]||(t[11]=function(t){return e.delivery.tel=t}),placeholder:"请输入联系方式"},null,8,["value"]),[[r["vShow"],"edit"===e.sysStatus]]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.tel),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(r["createVNode"])(B,{label:"收货地址",name:"address","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["withDirectives"])(Object(r["createVNode"])(_,{value:e.delivery.address,"onUpdate:value":t[12]||(t[12]=function(t){return e.delivery.address=t}),placeholder:"请输入收货地址"},null,8,["value"]),[[r["vShow"],"edit"===e.sysStatus]]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.address),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1}),g,w,Object(r["createVNode"])(B,{label:"送货方",name:"shipper","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["withDirectives"])(Object(r["createVNode"])(_,{value:e.delivery.shipper,"onUpdate:value":t[13]||(t[13]=function(t){return e.delivery.shipper=t}),placeholder:"请输入送货方名称"},null,8,["value"]),[[r["vShow"],"edit"===e.sysStatus]]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.shipper),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(r["createVNode"])(B,{label:"送货联系人",name:"shipperTel","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["withDirectives"])(Object(r["createVNode"])(_,{value:e.delivery.shipperTel,"onUpdate:value":t[14]||(t[14]=function(t){return e.delivery.shipperTel=t}),placeholder:"请输入送货联系人"},null,8,["value"]),[[r["vShow"],"edit"===e.sysStatus]]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.shipperTel),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(r["createVNode"])(B,{label:"路线",name:"route","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["withDirectives"])(Object(r["createVNode"])(_,{value:e.delivery.route,"onUpdate:value":t[15]||(t[15]=function(t){return e.delivery.route=t}),placeholder:"请输入路线"},null,8,["value"]),[[r["vShow"],"edit"===e.sysStatus]]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.route),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(r["createVNode"])(B,{label:"送货金额",name:"amount","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(r["withDirectives"])(Object(r["createVNode"])(_,{value:e.delivery.amount,"onUpdate:value":t[16]||(t[16]=function(t){return e.delivery.amount=t}),placeholder:"请输入送货金额"},null,8,["value"]),[[r["vShow"],"edit"===e.sysStatus]]),Object(r["withDirectives"])(Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(e.delivery.amount),513),[[r["vShow"],"view"===e.sysStatus]])]})),_:1})]})),_:1},8,["model","rules"])]),Object(r["createVNode"])("div",S,[V,Object(r["withDirectives"])(Object(r["createVNode"])(x,{style:{float:"right",color:"#5259e5",border:"1px solid #5259e5"},onClick:e.addDeliveryDtl},{default:n((function(){return[D]})),_:1},8,["onClick"]),[[r["vShow"],void 0===e.id]]),k,Object(r["createVNode"])(F,{columns:e.columns,sourceData:e.deliveryMats,editableCols:void 0===e.id&&"edit"===e.sysStatus?e.editableCols:[],onRowEdit:e.rowEditHandler,onCancelEdit:e.cancelEditHandler,onRowDelete:e.rowDeleteHandler},null,8,["columns","sourceData","editableCols","onRowEdit","onCancelEdit","onRowDelete"])])]),Object(r["createVNode"])(M,{visible:e.rejectReasonVisible,"onUpdate:visible":t[18]||(t[18]=function(t){return e.rejectReasonVisible=t}),centered:"",closable:!1,"mask-closable":!1,onOk:t[19]||(t[19]=function(t){return e.handleReceivedDeliveryOrder("reject")}),okText:"确定",cancelText:"取消"},{default:n((function(){return[Object(r["createVNode"])(U,{value:e.reason,"onUpdate:value":t[17]||(t[17]=function(t){return e.reason=t}),placeholder:"请输入驳回原因",rows:8},null,8,["value"])]})),_:1},8,["visible"])],64)})),C=(o("7db0"),o("4160"),o("a434"),o("d3b7"),o("159b"),o("368b"),o("56cd")),T=(o("7a59"),o("39ab")),x=(o("519e"),o("0bb7")),I=(o("04f3"),o("ed3b")),_=(o("e1f5"),o("5efb")),B=o("c1df"),R=o.n(B),q=o("a13b"),E=o("74d2"),L=o("9096"),F=o("3f6c"),U=Object(r["defineComponent"])({components:{"a-button":_["a"],"a-modal":I["a"],"a-date-picker":x["a"],"a-upload":T["a"],BaseTableEditable:L["a"]},setup:function(){var e=Object(r["ref"])("view"),t=Object(r["reactive"])([{title:"序号",dataIndex:"key",key:"key",slots:{customRender:"key"},width:70},{title:"物料编码",dataIndex:"code",key:"code",slots:{customRender:"code"}},{title:"规格型号",dataIndex:"name",key:"name",slots:{customRender:"name"}},{title:"送货数量",dataIndex:"qty",key:"qty",ellipsis:!0,slots:{customRender:"qty"}},{title:"送货金额",dataIndex:"amount",key:"amount",ellipsis:!0,slots:{customRender:"amount"}},{title:"销售单号",dataIndex:"salesCode",key:"salesCode",ellipsis:!0,slots:{customRender:"salesCode"}},{title:"行体积",dataIndex:"vol",key:"vol",ellipsis:!0,slots:{customRender:"vol"}},{title:"操作",dataIndex:"operation",key:"operation",slots:{customRender:"operation"}}]),o=Object(r["reactive"])({id:"",code:"",shipTo:"",customerId:void 0,shipper:"",orderDate:R()(),contacts:void 0,deliveryDate:R()(),tel:"",route:"",totalWeight:0,address:"",shippingType:"",shipperTel:"",totalVol:0,status:"draft",amount:0,authorizationCode:"",businessLicense:"",senderBusinessLicense:"",rowVersion:"",deliveryMats:[]}),n=function(e,t,o){return null===t?Promise.reject(e.message):Promise.resolve()},c=Object(r["reactive"])({code:[{required:!0,message:"送货单号不能为空",trigger:"blur"}],shipTo:[{validator:n,message:"客户名称不能为空",trigger:"blur"},{validator:n,message:"客户名称不能为空",trigger:"change"}],shipper:[{required:!0,message:"送货方不能为空",trigger:"blur"}],contacts:[{validator:n,message:"客户联系人不能为空",trigger:"blur"},{validator:n,message:"客户联系人不能为空",trigger:"change"}],amount:[{required:!0,message:"送货金额不能为空",trigger:"blur"}],address:[{required:!0,message:"收货地址不能为空",trigger:"blur"}],tel:[{required:!0,message:"联系方式不能为空",trigger:"blur"}],shipperTel:[{required:!0,message:"送货联系人不能为空",trigger:"blur"}],deliveryDate:[{validator:n,message:"送货联系人不能为空",trigger:"blur"},{validator:n,message:"需求日期不能为空",trigger:"change"}]}),i=Object(r["reactive"])([]),a=["code","name","qty","amount","salesCode","vol"],s=Object(r["ref"])([]),d=function(){i.push({key:String(i.length+1),id:"",code:"",name:"",qty:0,amount:0,salesCode:"",purCode:"",vol:0,deliveryId:"",editable:!0})},l=Object(r["reactive"])({key:"",id:"",code:"",name:"",qty:0,amount:0,salesCode:"",purCode:"",vol:0,deliveryId:""}),u=function(e){l.code=e.code,l.name=e.name,l.qty=e.qty,l.salesCode=e.salesCode},v=function(e){i.forEach((function(t,o,r){t.key===e&&(r[o].code=l.code,r[o].name=l.name,r[o].salesCode=l.salesCode)}))},b=function(e){i.forEach((function(t,o,r){t.key===e&&r.splice(o,1)}))},h=Object(r["ref"])(!1),y=Object(r["ref"])(""),p=function(){""===o.businessLicense?C["a"].error({message:"错误",description:"未填写客户信用代码，无法识别当前客户，请完善客户信息，并重新选取客户"}):""===o.authorizationCode?C["a"].error({message:"错误",description:"当前所选客户还不是您的合作伙伴"}):I["a"].confirm({title:"请确认",content:"确定要发送当前送货单吗？",cancelText:"取消",okText:"确认",onOk:function(){Object(q["k"])([o.id]).then((function(e){200===e.code&&C["a"].success({message:"成功",description:"发送成功"})})).catch((function(e){C["a"].error({message:"错误",description:e}),console.debug(e)}))}})};return{sysStatus:e,columns:t,delivery:o,deliveryMats:i,editableCols:a,fileList:s,addDeliveryDtl:d,rowEditHandler:u,cancelEditHandler:v,rowDeleteHandler:b,rejectReasonVisible:h,send:p,reason:y,rules:c}},data:function(){return{id:this.$route.query.id,type:this.$route.query.type,customers:[],customerContacts:[],customerId:""}},created:function(){"string"===typeof this.id&&"string"===typeof this.type?(this.getData(this.id,this.type),this.sysStatus="view"):(this.loadTenant(),this.sysStatus="edit")},methods:{getData:function(e,t){var o=this;"send"===t?Object(q["d"])({id:e}).then((function(e){o.delivery.id=e.content.id,o.delivery.code=e.content.code,o.delivery.shipTo=e.content.shipTo,o.delivery.customerId=e.content.customerId,o.delivery.shipper=e.content.shipper,o.delivery.shipperTel=e.content.shipperTel,o.delivery.orderDate=e.content.orderDate,o.delivery.contacts=e.content.contacts,o.delivery.deliveryDate=e.content.deliveryDate,o.delivery.tel=e.content.tel,o.delivery.route=e.content.route,o.delivery.totalWeight=e.content.totalWeight,o.delivery.address=e.content.address,o.delivery.shippingType=e.content.shippingType,o.delivery.totalVol=e.content.totalVol,o.delivery.amount=e.content.amount,o.delivery.status=o.textFormat(e.content.status),o.delivery.authorizationCode=e.content.authorizationCode,o.delivery.businessLicense=e.content.businessLicense,o.delivery.senderBusinessLicense=e.content.senderBusinessLicense,o.delivery.rowVersion=e.content.rowVersion,e.content.deliveryMats.forEach((function(e){o.deliveryMats.push({key:String(o.deliveryMats.length+1),id:e.code,code:e.code,name:e.name,qty:e.qty,amount:e.amount,salesCode:e.salesCode,purCode:e.purCode,vol:e.purCode,deliveryId:e.deliveryId})}))})).catch((function(e){C["a"].error({message:"错误",description:e}),console.debug(e)})):Object(q["f"])({id:e}).then((function(e){o.delivery.id=e.content.id,o.delivery.code=e.content.code,o.delivery.shipTo=e.content.shipTo,o.delivery.customerId=e.content.customerId,o.delivery.shipper=e.content.shipper,o.delivery.orderDate=e.content.orderDate,o.delivery.contacts=e.content.contacts,o.delivery.deliveryDate=e.content.deliveryDate,o.delivery.tel=e.content.tel,o.delivery.route=e.content.route,o.delivery.totalWeight=e.content.totalWeight,o.delivery.address=e.content.address,o.delivery.shippingType=e.content.shippingType,o.delivery.totalVol=e.content.totalVol,o.delivery.amount=e.content.amount,o.delivery.status=o.textFormat(e.content.status),o.delivery.authorizationCode=e.content.authorizationCode,o.delivery.businessLicense=e.content.businessLicense,o.delivery.senderBusinessLicense=e.content.senderBusinessLicense,o.delivery.rowVersion=e.content.rowVersion,e.content.deliveryMats.forEach((function(e){o.deliveryMats.push({key:String(o.deliveryMats.length+1),id:e.code,code:e.code,name:e.name,qty:e.qty,amount:e.amount,salesCode:e.salesCode,purCode:e.purCode,vol:e.purCode,deliveryId:e.deliveryId})}))})).catch((function(e){C["a"].error({message:"错误",description:e}),console.debug(e)}))},loadTenant:function(){var e=this;Object(F["a"])({id:localStorage.getItem("doway_cloud_tenant_id")}).then((function(t){200===t.code&&(e.delivery.senderBusinessLicense=t.content.creditCode,e.delivery.shipper=t.content.name,e.delivery.shipperTel=t.content.director)})).catch((function(e){C["a"].error({message:"错误",description:e}),console.debug(e)}))},focusHandler:function(){var e=this;Object(E["b"])().then((function(t){e.customers=t.content})).catch((function(e){C["a"].error({message:"错误",description:e}),console.debug(e)}))},focusDeliCont:function(){var e=this;e.customerId?Object(E["c"])({customerId:this.customerId}).then((function(t){e.customerContacts=t.content})).catch((function(e){C["a"].error({message:"错误",description:e}),console.debug(e)})):C["a"].warning({message:"警告",description:"当前客户信息缺失，请先选择客户"})},handleCustomerSelect:function(e){var t=this.customers.find((function(t){return t.id===e}));this.delivery.shipTo=t.name,this.delivery.address=t.address,this.delivery.authorizationCode=t.authorizationCode,this.delivery.businessLicense=t.businessLicense,this.customerId=e},handleCustomerSearch:function(e){var t=this;t.customers=[],Object(E["a"])({name:e}).then((function(e){t.customers=e.content})).catch((function(e){C["a"].error({message:"错误",description:e}),console.debug(e)}))},handleSelect:function(e){var t=this.customerContacts.find((function(t){return t.id=e}));this.delivery.contacts=t.contacts,this.delivery.tel=null===t.mobile?t.mobile:t.tel},handleSearch:function(e){var t=this;t.customerContacts=[],Object(E["c"])({customerId:this.customerId}).then((function(e){t.customerContacts=e.content})).catch((function(e){C["a"].error({message:"错误",description:e}),console.debug(e)}))},saveAsDraft:function(){var e=this,t=e.$refs.deliveryForm;t.validate().then((function(){e.delivery.deliveryMats=e.deliveryMats;var t=[];t.push(e.delivery),Object(q["a"])(t).then((function(t){200===t.code&&(e.id=t.content,C["a"].success({message:"成功",description:"录入送货单成功"}),e.sysStatus="view")})).catch((function(e){C["a"].error({message:"错误",description:e}),console.debug(e)}))})).catch((function(e){console.debug(e)}))},textFormat:function(e){switch(e){case"draft":return"草稿";case"published":return"已发布";case"confirmed":return"已确认";case"rejected":return"已驳回";case"untreated":return"未处理";default:return e}},dateFormat:function(e){return R()(e).format("YYYY-MM-DD")},handleReceivedDeliveryOrder:function(e){var t=this,o={ids:[t.delivery.id],result:e,reason:t.reason};Object(q["e"])(o).then((function(e){t.getData(String(t.id),String(t.type)),t.rejectReasonVisible=!1,200===e.code&&C["a"].success({message:"成功",description:"接收成功"})})).catch((function(e){C["a"].error({message:"错误",description:e}),console.debug(e)}))},importWordConfirm:function(e){var t=e.file,o=new FormData;o.append("file",t),Object(q["b"])(o).then((function(e){C["a"].success({message:"成功",description:e.msg})})).catch((function(e){C["a"].error({message:"错误",description:e}),console.debug(e)}))}}});o("1ce7"),o("307e");U.render=N,U.__scopeId="data-v-f2387354";t["default"]=U},a13b:function(e,t,o){"use strict";o.d(t,"d",(function(){return c})),o.d(t,"f",(function(){return i})),o.d(t,"c",(function(){return a})),o.d(t,"g",(function(){return s})),o.d(t,"j",(function(){return d})),o.d(t,"a",(function(){return l})),o.d(t,"e",(function(){return u})),o.d(t,"b",(function(){return v})),o.d(t,"k",(function(){return b})),o.d(t,"h",(function(){return h})),o.d(t,"i",(function(){return y}));var r=o("b32d"),n="http://cloud.dowaycn.com/Gateway/EblService/api/v1/delivery";function c(e){return Object(r["a"])({url:n+"/loadById",method:"get",params:e})}function i(e){return Object(r["a"])({url:n+"/loadByIdReceived",method:"get",params:e})}function a(e){return Object(r["a"])({url:n+"/generateStatement",method:"post",data:e})}function s(){return Object(r["a"])({url:n+"/queryAll",method:"get"})}function d(){return Object(r["a"])({url:n+"/searchReceivedDelivery",method:"get"})}function l(e){return Object(r["a"])({url:n+"/adds",method:"post",data:e})}function u(e){return Object(r["a"])({url:n+"/handleReceiveDeliveryOrder",method:"post",data:e})}function v(e){return Object(r["a"])({url:n+"/deliveryImport",method:"post",data:e})}function b(e){return Object(r["a"])({url:n+"/sendDeliveryOrder",method:"post",data:e})}function h(e){return Object(r["a"])({url:n+"/searchByExp",method:"post",data:e})}function y(e){return Object(r["a"])({url:n+"/searchReceivedByExp",method:"post",data:e})}},bbb4:function(e,t,o){},e48b:function(e,t,o){}}]);