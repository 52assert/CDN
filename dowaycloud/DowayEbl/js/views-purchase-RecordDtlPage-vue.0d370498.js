(window["webpackJsonp_cloud-ebl-app"]=window["webpackJsonp_cloud-ebl-app"]||[]).push([["views-purchase-RecordDtlPage-vue"],{"3e16":function(e,t,c){"use strict";c.d(t,"d",(function(){return r})),c.d(t,"e",(function(){return o})),c.d(t,"b",(function(){return s})),c.d(t,"g",(function(){return i})),c.d(t,"h",(function(){return u})),c.d(t,"i",(function(){return d})),c.d(t,"a",(function(){return l})),c.d(t,"j",(function(){return p})),c.d(t,"c",(function(){return h})),c.d(t,"f",(function(){return b}));var a=c("b32d"),n="http://cloud.dowaycn.com/Gateway/EblService/api/v1/purchase";function r(e){return Object(a["a"])({url:n+"/loadById",method:"get",params:e})}function o(e){return Object(a["a"])({url:n+"/loadByIdReceived",method:"get",params:e})}function s(){return Object(a["a"])({url:n+"/queryAll",method:"get"})}function i(){return Object(a["a"])({url:n+"/queryAllReceived",method:"get"})}function u(e){return Object(a["a"])({url:n+"/searchByExp",method:"post",data:e})}function d(e){return Object(a["a"])({url:n+"/searchReceivedByExp",method:"post",data:e})}function l(e){return Object(a["a"])({url:n+"/adds",method:"post",data:e})}function p(e){return Object(a["a"])({url:n+"/sendPurchaseOrder",method:"post",data:e})}function h(e){return Object(a["a"])({url:n+"/handleReceivedPurchaseOrder",method:"post",data:e})}function b(e){return Object(a["a"])({url:n+"/purchaseImport",method:"post",data:e})}},"48b4":function(e,t,c){"use strict";c("be04")},8151:function(e,t,c){"use strict";c.r(t);c("b0c0");var a=c("7a23"),n=Object(a["withScopeId"])("data-v-77dc9367");Object(a["pushScopeId"])("data-v-77dc9367");var r={class:"page_header"},o=Object(a["createTextVNode"])("发送"),s=Object(a["createTextVNode"])("保存为草稿"),i=Object(a["createTextVNode"])("确认"),u=Object(a["createTextVNode"])("驳回"),d={style:{float:"right"}},l=Object(a["createVNode"])("a",{href:"http://cloud.dowaycn.com/Gateway/EblService/api/v1/purchase/purchaseDown"},"下载模板",-1),p=Object(a["createTextVNode"])("上传文件"),h={class:"page_body"},b={class:"page_box"},f=Object(a["createVNode"])("span",{class:"title"},"基本信息",-1),v=Object(a["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),m={key:1},j={key:1},y=Object(a["createVNode"])("br",null,null,-1),O=Object(a["createVNode"])("br",null,null,-1),g={class:"page_box"},w=Object(a["createVNode"])("span",{class:"title"},"物料明细",-1),S=Object(a["createTextVNode"])(" 添加明细 "),N=Object(a["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),V={class:"page_box"},D=Object(a["createVNode"])("span",{class:"title"},"付款信息",-1),C=Object(a["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),k=Object(a["createTextVNode"])(" 人民币 "),T=Object(a["createTextVNode"])(" 美元 "),x=Object(a["createTextVNode"])(" 银行转账 "),_=Object(a["createTextVNode"])(" 货币交易 "),R=Object(a["createTextVNode"])(" 全款 "),q=Object(a["createTextVNode"])(" 先押后付 "),B=Object(a["createTextVNode"])(" 纸质发票 "),I=Object(a["createTextVNode"])(" 电子发票 ");Object(a["popScopeId"])();var L=n((function(e,t,c,L,F,E){var U=Object(a["resolveComponent"])("a-button"),M=Object(a["resolveComponent"])("a-upload"),W=Object(a["resolveComponent"])("a-input"),P=Object(a["resolveComponent"])("a-form-item"),H=Object(a["resolveComponent"])("a-date-picker"),z=Object(a["resolveComponent"])("a-select-option"),A=Object(a["resolveComponent"])("a-select"),Y=Object(a["resolveComponent"])("a-form"),$=Object(a["resolveComponent"])("BaseTableEditable"),G=Object(a["resolveComponent"])("a-textarea"),J=Object(a["resolveComponent"])("a-modal");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])("div",r,[Object(a["withDirectives"])(Object(a["createVNode"])(U,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:e.send},{default:n((function(){return[o]})),_:1},8,["onClick"]),[[a["vShow"],("send"===e.type||void 0!==e.id)&&"草稿"===e.purchase.status]]),Object(a["withDirectives"])(Object(a["createVNode"])(U,{style:{color:"#5259e5",border:"1px solid #5259e5"},onClick:e.saveAsDraft},{default:n((function(){return[s]})),_:1},8,["onClick"]),[[a["vShow"],void 0===e.id]]),Object(a["withDirectives"])(Object(a["createVNode"])(U,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[1]||(t[1]=function(t){return e.handleReceivedPurchaseOrder("adopt")})},{default:n((function(){return[i]})),_:1},512),[[a["vShow"],"receive"===e.type&&void 0!==e.id]]),Object(a["withDirectives"])(Object(a["createVNode"])(U,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[2]||(t[2]=function(t){return e.rejectReasonVisible=!0})},{default:n((function(){return[u]})),_:1},512),[[a["vShow"],"receive"===e.type&&void 0!==e.id]]),Object(a["createVNode"])("div",d,[Object(a["withDirectives"])(Object(a["createVNode"])(U,{style:{"margin-right":"10px"}},{default:n((function(){return[l]})),_:1},512),[[a["vShow"],void 0===e.id]]),Object(a["withDirectives"])(Object(a["createVNode"])(M,{action:"",multiple:!0,"file-list":e.fileList,"auto-upload":!1,limit:1,customRequest:e.importWordConfirm},{default:n((function(){return[Object(a["createVNode"])(U,{style:{color:"#5259e5",border:"1px solid #5259e5"}},{default:n((function(){return[p]})),_:1})]})),_:1},8,["file-list","customRequest"]),[[a["vShow"],void 0===e.id]])])]),Object(a["createVNode"])("div",h,[Object(a["createVNode"])("div",b,[f,v,Object(a["createVNode"])(Y,{ref:"purchaseBaseForm",model:e.purchase,rules:e.rules,layout:"inline","label-col":{offset:1,span:5},"wrapper-col":{offset:1,span:17}},{default:n((function(){return[Object(a["createVNode"])(P,{label:"采购单号",name:"orderCode","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])(W,{value:e.purchase.orderCode,"onUpdate:value":t[3]||(t[3]=function(t){return e.purchase.orderCode=t}),placeholder:"请输入采购单号"},null,8,["value"]),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.orderCode),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(a["createVNode"])(P,{label:"采购日期",name:"purDate","has-feedback":"",style:{width:"31%"}},{default:n((function(){return["edit"===e.sysStatus?(Object(a["openBlock"])(),Object(a["createBlock"])(H,{key:0,value:e.purchase.purDate,"onUpdate:value":t[4]||(t[4]=function(t){return e.purchase.purDate=t}),placeholder:"请选择日期",style:{width:"100%"}},null,8,["value"])):Object(a["createCommentVNode"])("",!0),"view"===e.sysStatus?(Object(a["openBlock"])(),Object(a["createBlock"])("span",m,Object(a["toDisplayString"])(e.dateFormat(e.purchase.purDate)),1)):Object(a["createCommentVNode"])("",!0)]})),_:1}),Object(a["createVNode"])(P,{label:"需求日期",name:"demandDate","has-feedback":"",style:{width:"31%"}},{default:n((function(){return["edit"===e.sysStatus?(Object(a["openBlock"])(),Object(a["createBlock"])(H,{key:0,value:e.purchase.demandDate,"onUpdate:value":t[5]||(t[5]=function(t){return e.purchase.demandDate=t}),placeholder:"请选择日期",style:{width:"100%"}},null,8,["value"])):Object(a["createCommentVNode"])("",!0),"view"===e.sysStatus?(Object(a["openBlock"])(),Object(a["createBlock"])("span",j,Object(a["toDisplayString"])(e.dateFormat(e.purchase.demandDate)),1)):Object(a["createCommentVNode"])("",!0)]})),_:1}),Object(a["createVNode"])(P,{label:"运输方式",name:"shippingType","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])(W,{value:e.purchase.shippingType,"onUpdate:value":t[6]||(t[6]=function(t){return e.purchase.shippingType=t}),placeholder:"请输入运输方式"},null,8,["value"]),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.shippingType),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),y,Object(a["createVNode"])(P,{label:"供应商",name:"supplyName",required:"","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])("div",null,[Object(a["createVNode"])(A,{value:e.purchase.supplyName,"onUpdate:value":t[7]||(t[7]=function(t){return e.purchase.supplyName=t}),placeholder:"请选择供应商名称","show-search":"","default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",style:{width:"100%"},onFocus:e.focusHandler,onSearch:e.handleSupplierSearch,onSelect:e.handleSupplierSelect},{default:n((function(){return[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.supplies,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])(z,{key:e.id},{default:n((function(){return[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.name),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])],512),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.supplyName),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(a["createVNode"])(P,{label:"联系人",name:"contacts",required:"","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])("div",null,[Object(a["createVNode"])(A,{value:e.purchase.contacts,"onUpdate:value":t[8]||(t[8]=function(t){return e.purchase.contacts=t}),placeholder:"请选择供应商联系人","show-search":"","default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",style:{width:"100%"},onFocus:e.focusSuplCont,onSearch:e.handleSearch,onSelect:e.handleSelect},{default:n((function(){return[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.supplyContacts,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])(z,{key:e.id},{default:n((function(){return[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.contacts),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])],512),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.contacts),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(a["createVNode"])(P,{label:"联系方式",name:"tel","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])(W,{value:e.purchase.tel,"onUpdate:value":t[9]||(t[9]=function(t){return e.purchase.tel=t}),placeholder:"请输入联系方式"},null,8,["value"]),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.tel),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(a["createVNode"])(P,{label:"信用代码",name:"businessLicense","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])(W,{disabled:"",value:e.purchase.businessLicense,"onUpdate:value":t[10]||(t[10]=function(t){return e.purchase.businessLicense=t})},null,8,["value"]),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.senderBusinessLicense),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),O,Object(a["createVNode"])(P,{label:"需求方",name:"demandSide","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])(W,{value:e.purchase.demandSide,"onUpdate:value":t[11]||(t[11]=function(t){return e.purchase.demandSide=t}),placeholder:"请输入需求方名称"},null,8,["value"]),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.demandSide),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(a["createVNode"])(P,{label:"联系人",name:"demandContacts","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])(W,{value:e.purchase.demandContacts,"onUpdate:value":t[12]||(t[12]=function(t){return e.purchase.demandContacts=t}),placeholder:"请输入需求方联系人"},null,8,["value"]),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.demandContacts),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(a["createVNode"])(P,{label:"联系方式",name:"demandTel","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])(W,{value:e.purchase.demandTel,"onUpdate:value":t[13]||(t[13]=function(t){return e.purchase.demandTel=t}),placeholder:"请输入需求方联系方式"},null,8,["value"]),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.demandTel),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1})]})),_:1},8,["model","rules"])]),Object(a["createVNode"])("div",g,[w,Object(a["withDirectives"])(Object(a["createVNode"])(U,{style:{float:"right",color:"#5259e5",border:"1px solid #5259e5"},onClick:e.addMat},{default:n((function(){return[S]})),_:1},8,["onClick"]),[[a["vShow"],void 0===e.id]]),N,Object(a["createVNode"])($,{columns:e.columns,sourceData:e.purchaseMats,editableCols:void 0===e.id&&"edit"===e.sysStatus?e.editableCols:[],onRowEdit:e.rowEditHandler,onRowChange:e.rowChangeHandler,onCancelEdit:e.cancelEditHandler,onRowDelete:e.rowDeleteHandler},null,8,["columns","sourceData","editableCols","onRowEdit","onRowChange","onCancelEdit","onRowDelete"])]),Object(a["createVNode"])("div",V,[D,C,Object(a["createVNode"])(Y,{ref:"purchasePayForm",model:e.purchase,rules:e.rules,layout:"inline","label-col":{offset:1,span:5},"wrapper-col":{offset:1,span:17}},{default:n((function(){return[Object(a["createVNode"])(P,{label:"交易货币",name:"currency",required:"","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])("div",null,[Object(a["createVNode"])(A,{value:e.purchase.currency,"onUpdate:value":t[14]||(t[14]=function(t){return e.purchase.currency=t}),style:{width:"100%"}},{default:n((function(){return[Object(a["createVNode"])(z,{value:"人民币"},{default:n((function(){return[k]})),_:1}),Object(a["createVNode"])(z,{value:"美元"},{default:n((function(){return[T]})),_:1})]})),_:1},8,["value"])],512),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.currency),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(a["createVNode"])(P,{label:"税率",name:"taxRate",required:"","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])(W,{value:e.purchase.taxRate,"onUpdate:value":t[15]||(t[15]=function(t){return e.purchase.taxRate=t}),placeholder:"请输入税率"},null,8,["value"]),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.taxRate),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(a["createVNode"])(P,{label:"付款方式",name:"payType",required:"","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])("div",null,[Object(a["createVNode"])(A,{value:e.purchase.payType,"onUpdate:value":t[16]||(t[16]=function(t){return e.purchase.payType=t}),style:{width:"100%"}},{default:n((function(){return[Object(a["createVNode"])(z,{value:"银行转账"},{default:n((function(){return[x]})),_:1}),Object(a["createVNode"])(z,{value:"货币交易"},{default:n((function(){return[_]})),_:1})]})),_:1},8,["value"])],512),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.payType),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(a["createVNode"])(P,{label:"付款形式",name:"payCondition",required:"","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])("div",null,[Object(a["createVNode"])(A,{value:e.purchase.payCondition,"onUpdate:value":t[17]||(t[17]=function(t){return e.purchase.payCondition=t}),style:{width:"100%"}},{default:n((function(){return[Object(a["createVNode"])(z,{value:"全款"},{default:n((function(){return[R]})),_:1}),Object(a["createVNode"])(z,{value:"先押后付"},{default:n((function(){return[q]})),_:1})]})),_:1},8,["value"])],512),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.payCondition),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(a["createVNode"])(P,{label:"发票类型",name:"invoiceType",required:"","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(a["withDirectives"])(Object(a["createVNode"])("div",null,[Object(a["createVNode"])(A,{value:e.purchase.invoiceType,"onUpdate:value":t[18]||(t[18]=function(t){return e.purchase.invoiceType=t}),style:{width:"100%"}},{default:n((function(){return[Object(a["createVNode"])(z,{value:"纸质发票"},{default:n((function(){return[B]})),_:1}),Object(a["createVNode"])(z,{value:"电子发票"},{default:n((function(){return[I]})),_:1})]})),_:1},8,["value"])],512),[[a["vShow"],"edit"===e.sysStatus]]),Object(a["withDirectives"])(Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(e.purchase.invoiceType),513),[[a["vShow"],"view"===e.sysStatus]])]})),_:1})]})),_:1},8,["model","rules"])])]),Object(a["createVNode"])(J,{visible:e.rejectReasonVisible,"onUpdate:visible":t[20]||(t[20]=function(t){return e.rejectReasonVisible=t}),centered:"",closable:!1,"mask-closable":!1,onOk:t[21]||(t[21]=function(t){return e.handleReceivedPurchaseOrder("reject")}),okText:"确定",cancelText:"取消"},{default:n((function(){return[Object(a["createVNode"])(G,{value:e.reason,"onUpdate:value":t[19]||(t[19]=function(t){return e.reason=t}),placeholder:"请输入驳回原因",rows:8},null,8,["value"])]})),_:1},8,["visible"])],64)})),F=(c("7db0"),c("4160"),c("a434"),c("d3b7"),c("159b"),c("368b"),c("56cd")),E=(c("7a59"),c("39ab")),U=(c("519e"),c("0bb7")),M=(c("04f3"),c("ed3b")),W=(c("e1f5"),c("5efb")),P=c("c1df"),H=c.n(P),z=c("3e16"),A=c("9096"),Y=c("d649"),$=c("3f6c"),G=Object(a["defineComponent"])({components:{"a-button":W["a"],"a-modal":M["a"],"a-date-picker":U["a"],"a-upload":E["a"],BaseTableEditable:A["a"]},setup:function(){var e=Object(a["ref"])("view"),t=function(e,t,c){return null===t?Promise.reject(e.message):Promise.resolve()},c=Object(a["reactive"])([{title:"序号",dataIndex:"key",key:"key",slots:{customRender:"key"},width:70},{title:"物料编码",dataIndex:"code",key:"code",ellipsis:!0,slots:{customRender:"code"}},{title:"规格型号",dataIndex:"name",key:"name",ellipsis:!0,slots:{customRender:"name"}},{title:"采购数量",dataIndex:"qty",key:"qty",ellipsis:!0,slots:{customRender:"qty"}},{title:"物料单位",dataIndex:"uom",key:"uom",ellipsis:!0,slots:{customRender:"uom"}},{title:"采购单价",dataIndex:"price",key:"price",ellipsis:!0,slots:{customRender:"price"}},{title:"采购金额",dataIndex:"amount",key:"amount",ellipsis:!0,slots:{customRender:"amount"}},{title:"收获仓",dataIndex:"receiveWh",key:"receiveWh",ellipsis:!0,slots:{customRender:"receiveWh"}},{title:"操作",dataIndex:"operation",key:"operation",slots:{customRender:"operation"}}]),n=Object(a["reactive"])({orderCode:[{required:!0,message:"采购单号不能为空",trigger:"blur"}],supplyName:[{validator:t,message:"供应商名称不能为空",trigger:"blur"}],demandSide:[{required:!0,message:"需求方名称不能为空",trigger:"blur"}],purDate:[{validator:t,message:"采购日期不能为空",trigger:"blur"},{validator:t,message:"采购日期不能为空",trigger:"change"}],contacts:[{validator:t,message:"供应商联系人不能为空",trigger:"blur"}],demandContacts:[{required:!0,message:"需求方联系人不能为空",trigger:"blur"}],demandDate:[{validator:t,message:"需求日期不能为空",trigger:"blur"},{validator:t,message:"需求日期不能为空",trigger:"change"}],tel:[{required:!0,message:"供应商联系方式不能为空",trigger:"blur"}],demandTel:[{required:!0,message:"需求方联系方式不能为空",trigger:"blur"}],shippingType:[{required:!0,message:"运输方式不能为空",trigger:"blur"}],businessLicense:[{required:!0,message:"供应商信用代码不能为空",trigger:"blur"}],senderBusinessLicense:[{required:!0,message:"需求方信用代码不能为空",trigger:"blur"}],currency:[{validator:t,message:"交易货币不能为空",trigger:"blur"}],taxRate:[{required:!0,message:"税率不能为空",trigger:"blur"}],payType:[{validator:t,message:"付款方式不能为空",trigger:"blur"}],payCondition:[{validator:t,message:"付款形式不能为空",trigger:"blur"}],invoiceType:[{validator:t,message:"发票类型不能为空",trigger:"blur"}]}),r=Object(a["reactive"])({id:"",orderCode:"",supplyName:void 0,demandSide:"",purDate:H()(),contacts:void 0,demandContacts:"",demandDate:H()(),tel:"",demandTel:"",shippingType:"",businessLicense:"",senderBusinessLicense:"",authorizationCode:"",currency:"人民币",taxRate:"",payType:"银行转账",payCondition:"全款",invoiceType:"电子发票",purchaseMats:[],rowVersion:"",status:"draft"}),o=Object(a["reactive"])([]),s=["code","name","qty","uom","price","receiveWh"],i=Object(a["ref"])([]),u=function(){o.push({key:String(o.length+1),id:"",code:"",name:"",qty:"",uom:"",price:"",amount:0,receiveWh:"",editable:!0})},d=Object(a["reactive"])({key:"",id:"",code:"",name:"",qty:"",uom:"",price:"",amount:0,receiveWh:""}),l=function(e){d.code=e.code,d.name=e.name,d.qty=e.qty,d.uom=e.uom,d.price=e.price,d.receiveWh=e.receiveWh},p=function(e){e.amount=e.qty*e.price},h=function(e){o.forEach((function(t,c,a){t.key===e&&(a[c].code=d.code,a[c].name=d.name,a[c].qty=d.qty,a[c].uom=d.uom,a[c].price=d.price,a[c].receiveWh=d.receiveWh)}))},b=function(e){o.forEach((function(t,c,a){t.key===e&&a.splice(c,1)}))},f=Object(a["ref"])(!1),v=Object(a["ref"])(""),m=function(){""===r.businessLicense?F["a"].error({message:"错误",description:"未填写供应商信用代码，无法识别当前供应商，请完善供应商信息，并重新选取供应商"}):""===r.authorizationCode?F["a"].error({message:"错误",description:"当前所选供应商还不是您的合作伙伴"}):M["a"].confirm({title:"请确认",content:"确定要发送当前采购单吗？",cancelText:"取消",okText:"确认",onOk:function(){Object(z["j"])([r.id]).then((function(e){200===e.code&&F["a"].success({message:"成功",description:"发送成功"})})).catch((function(e){F["a"].error({message:"错误",description:e}),console.debug(e)}))}})};return{sysStatus:e,columns:c,rules:n,purchase:r,purchaseMats:o,editableCols:s,fileList:i,addMat:u,rowEditHandler:l,rowChangeHandler:p,cancelEditHandler:h,rowDeleteHandler:b,rejectReasonVisible:f,send:m,reason:v}},data:function(){return{id:this.$route.query.id,type:this.$route.query.type,supplies:[],supplyContacts:[],supplierId:""}},created:function(){void 0!==this.id&&void 0!==this.type?(this.getData(String(this.id),String(this.type)),this.sysStatus="view"):(this.loadTenant(),this.sysStatus="edit")},methods:{getPurchase:function(e){var t=this;Object(z["d"])({id:e}).then((function(e){t.purchase.id=e.content.id,t.purchase.orderCode=e.content.orderCode,t.purchase.supplyName=e.content.supplyName,t.purchase.contacts=e.content.contacts,t.purchase.tel=e.content.tel,t.purchase.purDate=e.content.purDate,t.purchase.demandDate=e.content.demandDate,t.purchase.shippingType=e.content.shippingType,t.purchase.demandSide=e.content.demandSide,t.purchase.authorizationCode=e.content.authorizationCode,t.purchase.businessLicense=e.content.businessLicense,t.purchase.senderBusinessLicense=e.content.senderBusinessLicense,t.purchase.status=t.textFormat(e.content.status),t.purchase.currency=e.content.currency,t.purchase.taxRate=e.content.taxRate,t.purchase.payType=e.content.payType,t.purchase.payCondition=e.content.payCondition,t.purchase.invoiceType=e.content.invoiceType,t.purchase.rowVersion=e.content.rowVersion,t.purchase.demandContacts=e.content.demandContacts,t.purchase.demandTel=e.content.demandTel,e.content.purchaseMats.forEach((function(e){t.purchaseMats.push({key:String(t.purchaseMats.length+1),id:e.id,code:e.code,name:e.name,qty:e.qty,uom:e.uom,price:e.price,amount:e.amount,receiveWh:e.receiveWh})}))})).catch((function(e){F["a"].error({message:"错误",description:e}),console.debug(e)}))},getPurchaseReceived:function(e){var t=this;Object(z["e"])({id:e}).then((function(e){t.purchase.id=e.content.id,t.purchase.orderCode=e.content.orderCode,t.purchase.supplyName=e.content.supplyName,t.purchase.contacts=e.content.contacts,t.purchase.tel=e.content.tel,t.purchase.purDate=e.content.purDate,t.purchase.demandDate=e.content.demandDate,t.purchase.shippingType=e.content.shippingType,t.purchase.demandSide=e.content.demandSide,t.purchase.authorizationCode=e.content.authorizationCode,t.purchase.businessLicense=e.content.businessLicense,t.purchase.senderBusinessLicense=e.content.senderBusinessLicense,t.purchase.status=t.textFormat(e.content.status),t.purchase.currency=e.content.currency,t.purchase.taxRate=e.content.taxRate,t.purchase.payType=e.content.payType,t.purchase.payCondition=e.content.payCondition,t.purchase.invoiceType=e.content.invoiceType,t.purchase.rowVersion=e.content.rowVersion,t.purchase.demandContacts=e.content.demandContacts,t.purchase.demandTel=e.content.demandTel,e.content.purchaseMatReceiveds.forEach((function(e){t.purchaseMats.push({key:String(t.purchaseMats.length+1),id:e.id,code:e.code,name:e.name,qty:e.qty,uom:e.uom,price:e.price,amount:e.amount,receiveWh:e.receiveWh})}))})).catch((function(e){F["a"].error({message:"错误",description:e}),console.debug(e)}))},getData:function(e,t){"send"===t?this.getPurchase(e):"receive"===t&&this.getPurchaseReceived(e)},loadTenant:function(){var e=this;Object($["a"])({id:localStorage.getItem("doway_cloud_tenant_id")}).then((function(t){200===t.code&&(e.purchase.demandSide=t.content.name,e.purchase.senderBusinessLicense=t.content.creditCode,t.content.director&&t.content.tel||F["a"].warning({message:"警告",description:"当前租户负责人或联系方式信息缺失，请到信息设置中完善"}),e.purchase.demandContacts=t.content.director,e.purchase.demandTel=t.content.tel)})).catch((function(e){F["a"].error({message:"错误",description:e}),console.debug(e)}))},focusHandler:function(){var e=this;Object(Y["c"])().then((function(t){e.supplies=t.content})).catch((function(e){F["a"].error({message:"错误",description:e}),console.debug(e)}))},handleSupplierSelect:function(e){var t=this.supplies.find((function(t){return t.id===e}));this.purchase.authorizationCode=t.authorizationCode,this.purchase.businessLicense=t.businessLicense,this.supplierId=e},handleSupplierSearch:function(e){var t=this;t.supplies=[],Object(Y["a"])({name:e}).then((function(e){t.supplies=e.content})).catch((function(e){F["a"].error({message:"错误",description:e}),console.debug(e)}))},focusSuplCont:function(){var e=this;e.supplierId?Object(Y["b"])({supplierId:e.supplierId}).then((function(t){e.supplyContacts=t.content})).catch((function(e){F["a"].error({message:"错误",description:e}),console.debug(e)})):F["a"].warning({message:"警告",description:"当前供应商信息缺失，请先选择供应商"})},handleSelect:function(e){var t=this.supplyContacts.find((function(t){return t.id=e}));this.purchase.contacts=t.contacts,this.purchase.tel=null===t.mobile?t.mobile:t.tel},handleSearch:function(e){var t=this;t.supplierId?(t.supplyContacts=[],Object(Y["b"])({supplierId:t.supplierId}).then((function(e){t.supplyContacts=e.content})).catch((function(e){F["a"].error({message:"错误",description:e}),console.debug(e)}))):F["a"].warning({message:"警告",description:"当前供应商信息缺失，请先选择供应商"})},textFormat:function(e){switch(e){case"draft":return"草稿";case"published":return"已发布";case"confirmed":return"已确认";case"rejected":return"已驳回";case"untreated":return"未处理";default:return e}},saveAsDraft:function(){var e=this,t=e.$refs.purchaseBaseForm,c=e.$refs.purchasePayForm;t.validate().then((function(){c.validate().then((function(){e.purchase.purchaseMats=e.purchaseMats;var a=[];a.push(e.purchase),Object(z["a"])(a).then((function(a){e.id=a.content,t.resetFields(),c.resetFields(),e.purchaseMats.splice(0),F["a"].success({message:"成功",description:"添加成功"})})).catch((function(e){F["a"].error({message:"错误",description:e}),console.debug(e)}))})).catch((function(e){console.debug(e)}))})).catch((function(e){console.debug(e)}))},handleReceivedPurchaseOrder:function(e){var t={ids:[this.purchase.id],result:e,reason:this.reason};Object(z["c"])(t).then((function(e){200===e.code&&F["a"].success({message:"成功",description:"已处理"})})).catch((function(e){F["a"].error({message:"错误",description:e}),console.debug(e)}))},dateFormat:function(e){return H()(e).format("YYYY-MM-DD")},importWordConfirm:function(e){var t=e.file,c=new FormData;c.append("file",t),Object(z["f"])(c).then((function(e){F["a"].success({message:"成功",description:"数据导入成功，请至采购记录页面查看"})})).catch((function(e){F["a"].error({message:"错误",description:e}),console.debug(e)}))}}});c("48b4"),c("916f");G.render=L,G.__scopeId="data-v-77dc9367";t["default"]=G},"916f":function(e,t,c){"use strict";c("9749")},9749:function(e,t,c){},be04:function(e,t,c){},d649:function(e,t,c){"use strict";c.d(t,"a",(function(){return r})),c.d(t,"b",(function(){return o})),c.d(t,"c",(function(){return s}));var a=c("b32d"),n="http://cloud.dowaycn.com/Gateway/BaseService/api/v1/supplier";function r(e){return Object(a["a"])({url:n+"/loadByName",method:"get",params:e})}function o(e){return Object(a["a"])({url:n+"/queryAllContacts",method:"get",params:e})}function s(){return Object(a["a"])({url:n+"/query",method:"get"})}}}]);