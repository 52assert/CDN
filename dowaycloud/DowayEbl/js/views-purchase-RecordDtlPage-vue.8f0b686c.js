(window["webpackJsonp_cloud-ebl-app"]=window["webpackJsonp_cloud-ebl-app"]||[]).push([["views-purchase-RecordDtlPage-vue"],{"3e16":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"g",(function(){return i})),a.d(t,"a",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"d",(function(){return l})),a.d(t,"f",(function(){return p}));var c=a("b32d"),n="http://cloud.dowaycn.com/Gateway/EblService/api/v1/purchase";function r(e){return Object(c["a"])({url:n+"/loadById",method:"get",params:e})}function s(e){return Object(c["a"])({url:n+"/loadByIdReceived",method:"get",params:e})}function o(){return Object(c["a"])({url:n+"/queryAll",method:"get"})}function i(){return Object(c["a"])({url:n+"/queryAllReceived",method:"get"})}function u(e){return Object(c["a"])({url:n+"/adds",method:"post",data:e})}function d(e){return Object(c["a"])({url:n+"/sendPurchaseOrder",method:"post",data:e})}function l(e){return Object(c["a"])({url:n+"/handleReceivedPurchaseOrder",method:"post",data:e})}function p(e){return Object(c["a"])({url:n+"/purchaseImport",method:"post",data:e})}},"54db":function(e,t,a){"use strict";a("d64f")},8151:function(e,t,a){"use strict";a.r(t);a("b0c0");var c=a("7a23"),n=Object(c["withScopeId"])("data-v-80f46a1c");Object(c["pushScopeId"])("data-v-80f46a1c");var r={class:"page_header"},s=Object(c["createTextVNode"])("发送"),o=Object(c["createTextVNode"])("保存为草稿"),i=Object(c["createTextVNode"])("确认"),u=Object(c["createTextVNode"])("驳回"),d={style:{float:"right"}},l=Object(c["createVNode"])("a",{href:"http://cloud.dowaycn.com/Gateway/EblService/api/v1/purchase/purchaseDown"},"下载模板",-1),p=Object(c["createTextVNode"])("上传文件"),h={class:"page_body"},b={class:"page_box"},f=Object(c["createVNode"])("span",{class:"title"},"基本信息",-1),v=Object(c["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),m={class:"page_box"},y=Object(c["createVNode"])("span",{class:"title"},"物料明细",-1),O=Object(c["createTextVNode"])(" 添加明细 "),j=Object(c["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),w={class:"page_box"},g=Object(c["createVNode"])("span",{class:"title"},"付款信息",-1),S=Object(c["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),N=Object(c["createTextVNode"])(" 人民币 "),V=Object(c["createTextVNode"])(" 美元 "),D=Object(c["createTextVNode"])(" 银行转账 "),C=Object(c["createTextVNode"])(" 货币交易 "),k=Object(c["createTextVNode"])(" 全款 "),T=Object(c["createTextVNode"])(" 先押后付 "),x=Object(c["createTextVNode"])(" 纸质发票 "),_=Object(c["createTextVNode"])(" 电子发票 ");Object(c["popScopeId"])();var q=n((function(e,t,a,q,R,B){var L=Object(c["resolveComponent"])("a-button"),I=Object(c["resolveComponent"])("a-upload"),U=Object(c["resolveComponent"])("a-input"),F=Object(c["resolveComponent"])("a-form-item"),M=Object(c["resolveComponent"])("a-select-option"),E=Object(c["resolveComponent"])("a-select"),W=Object(c["resolveComponent"])("a-date-picker"),P=Object(c["resolveComponent"])("a-form"),z=Object(c["resolveComponent"])("BaseTableEditable"),A=Object(c["resolveComponent"])("a-textarea"),H=Object(c["resolveComponent"])("a-modal");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])("div",r,[Object(c["withDirectives"])(Object(c["createVNode"])(L,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:e.send},{default:n((function(){return[s]})),_:1},8,["onClick"]),[[c["vShow"],"send"===e.type||void 0===e.id]]),Object(c["withDirectives"])(Object(c["createVNode"])(L,{style:{color:"#5259e5",border:"1px solid #5259e5"},onClick:e.saveAsDraft},{default:n((function(){return[o]})),_:1},8,["onClick"]),[[c["vShow"],void 0===e.id]]),Object(c["withDirectives"])(Object(c["createVNode"])(L,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[1]||(t[1]=function(t){return e.handleReceivedPurchaseOrder("adopt")})},{default:n((function(){return[i]})),_:1},512),[[c["vShow"],"receive"===e.type&&void 0!==e.id]]),Object(c["withDirectives"])(Object(c["createVNode"])(L,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[2]||(t[2]=function(t){return e.rejectReasonVisible=!0})},{default:n((function(){return[u]})),_:1},512),[[c["vShow"],"receive"===e.type&&void 0!==e.id]]),Object(c["createVNode"])("div",d,[Object(c["withDirectives"])(Object(c["createVNode"])(L,{style:{"margin-right":"10px"}},{default:n((function(){return[l]})),_:1},512),[[c["vShow"],void 0===e.id]]),Object(c["withDirectives"])(Object(c["createVNode"])(I,{action:"",multiple:!0,"file-list":e.fileList,"auto-upload":!1,limit:1,customRequest:e.importWordConfirm},{default:n((function(){return[Object(c["createVNode"])(L,{style:{color:"#5259e5",border:"1px solid #5259e5"}},{default:n((function(){return[p]})),_:1})]})),_:1},8,["file-list","customRequest"]),[[c["vShow"],void 0===e.id]])])]),Object(c["createVNode"])("div",h,[Object(c["createVNode"])("div",b,[f,v,Object(c["createVNode"])(P,{ref:"purchaseBaseForm",model:e.purchase,rules:e.rules,layout:"inline","label-col":{offset:1,span:5},"wrapper-col":{offset:1,span:17}},{default:n((function(){return[Object(c["createVNode"])(F,{label:"采购单号",name:"orderCode","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(U,{value:e.purchase.orderCode,"onUpdate:value":t[3]||(t[3]=function(t){return e.purchase.orderCode=t}),placeholder:"请输入采购单号"},null,8,["value"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.orderCode),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"供应商",name:"supplyName","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(E,{"show-search":"",value:e.purchase.supplyName,"onUpdate:value":t[4]||(t[4]=function(t){return e.purchase.supplyName=t}),onFocus:e.focus,placeholder:"请选择供应商名称",style:{width:"100%"},"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",onSearch:e.handleSupplierSearch,onSelect:e.handleSupplierSelect},{default:n((function(){return[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.supplies,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])(M,{key:e.id},{default:n((function(){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.name),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.supplyName),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"需求方",name:"demandSide","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(U,{value:e.purchase.demandSide,"onUpdate:value":t[5]||(t[5]=function(t){return e.purchase.demandSide=t}),placeholder:"请输入需求方名称"},null,8,["value"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.demandSide),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"采购日期",name:"purDate","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(W,{value:e.purchase.purDate,"onUpdate:value":t[6]||(t[6]=function(t){return e.purchase.purDate=t}),placeholder:"请选择日期",style:{width:"100%"}},null,8,["value"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.dateFormat(e.purchase.purDate)),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"联系人",name:"contacts","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(E,{disabled:void 0===e.purchase.contacts,"show-search":"",value:e.purchase.contacts,"onUpdate:value":t[7]||(t[7]=function(t){return e.purchase.contacts=t}),placeholder:"请选择供应商联系人","default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",style:{width:"100%"},onFocus:e.focusSuplCont,onSearch:e.handleSearch,onSelect:e.handleSelect},{default:n((function(){return[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.supplyContacts,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])(M,{key:e.id},{default:n((function(){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.contacts),1)]})),_:2},1024)})),128))]})),_:1},8,["disabled","value","onFocus","onSearch","onSelect"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.contacts),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"联系人",name:"demandContacts","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(U,{disabled:""===e.purchase.demandContacts,value:e.purchase.demandContacts,"onUpdate:value":t[8]||(t[8]=function(t){return e.purchase.demandContacts=t}),placeholder:"请输入需求方联系人"},null,8,["disabled","value"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.demandContacts),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"需求日期",name:"demandDate","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(W,{value:e.purchase.demandDate,"onUpdate:value":t[9]||(t[9]=function(t){return e.purchase.demandDate=t}),placeholder:"请选择日期",style:{width:"100%"}},null,8,["value"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.dateFormat(e.purchase.demandDate)),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"联系方式",name:"tel","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(U,{disabled:""===e.purchase.tel,value:e.purchase.tel,"onUpdate:value":t[10]||(t[10]=function(t){return e.purchase.tel=t}),placeholder:"请输入联系方式"},null,8,["disabled","value"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.tel),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"联系方式",name:"demandTel","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(U,{disabled:""===e.purchase.demandTel,value:e.purchase.demandTel,"onUpdate:value":t[11]||(t[11]=function(t){return e.purchase.demandTel=t}),placeholder:"请输入需求方联系方式"},null,8,["disabled","value"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.demandTel),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"运输方式",name:"shippingType","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(U,{value:e.purchase.shippingType,"onUpdate:value":t[12]||(t[12]=function(t){return e.purchase.shippingType=t}),placeholder:"请输入运输方式"},null,8,["value"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.shippingType),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"信用代码",name:"businessLicense","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(U,{value:e.purchase.businessLicense,"onUpdate:value":t[13]||(t[13]=function(t){return e.purchase.businessLicense=t}),placeholder:"请输入供应商信用代码"},null,8,["value"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.senderBusinessLicense),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"信用代码",name:"senderBusinessLicense","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(U,{value:e.purchase.senderBusinessLicense,"onUpdate:value":t[14]||(t[14]=function(t){return e.purchase.senderBusinessLicense=t}),placeholder:"请输入需求方信用代码"},null,8,["value"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.senderBusinessLicense),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1})]})),_:1},8,["model","rules"])]),Object(c["createVNode"])("div",m,[y,Object(c["withDirectives"])(Object(c["createVNode"])(L,{style:{float:"right",color:"#5259e5",border:"1px solid #5259e5"},onClick:e.addMat},{default:n((function(){return[O]})),_:1},8,["onClick"]),[[c["vShow"],void 0===e.id]]),j,Object(c["createVNode"])(z,{columns:e.columns,sourceData:e.purchaseMats,editableCols:void 0===e.id?e.editableCols:[],onRowDelete:e.rowDeleteHandler,onCancelEdit:e.cancelEditHandler},null,8,["columns","sourceData","editableCols","onRowDelete","onCancelEdit"])]),Object(c["createVNode"])("div",w,[g,S,Object(c["createVNode"])(P,{ref:"purchasePayForm",model:e.purchase,rules:e.rules,layout:"inline","label-col":{offset:1,span:5},"wrapper-col":{offset:1,span:17}},{default:n((function(){return[Object(c["createVNode"])(F,{label:"交易货币",name:"currency","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["createVNode"])(E,{value:e.purchase.currency,"onUpdate:value":t[15]||(t[15]=function(t){return e.purchase.currency=t}),style:{width:"100%"}},{default:n((function(){return[Object(c["createVNode"])(M,{value:"人民币"},{default:n((function(){return[N]})),_:1}),Object(c["createVNode"])(M,{value:"美元"},{default:n((function(){return[V]})),_:1})]})),_:1},8,["value"]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.currency),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"税率",name:"taxRate","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])(U,{value:e.purchase.taxRate,"onUpdate:value":t[16]||(t[16]=function(t){return e.purchase.taxRate=t}),placeholder:"请输入税率"},null,8,["value"]),[[c["vShow"],"edit"===e.sysStatus]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.taxRate),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"付款方式",name:"payType","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["createVNode"])(E,{value:e.purchase.payType,"onUpdate:value":t[17]||(t[17]=function(t){return e.purchase.payType=t}),style:{width:"100%"}},{default:n((function(){return[Object(c["createVNode"])(M,{value:"银行转账"},{default:n((function(){return[D]})),_:1}),Object(c["createVNode"])(M,{value:"货币交易"},{default:n((function(){return[C]})),_:1})]})),_:1},8,["value"]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.payType),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"付款形式",name:"payCondition","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["createVNode"])(E,{value:e.purchase.payCondition,"onUpdate:value":t[18]||(t[18]=function(t){return e.purchase.payCondition=t}),style:{width:"100%"}},{default:n((function(){return[Object(c["createVNode"])(M,{value:"全款"},{default:n((function(){return[k]})),_:1}),Object(c["createVNode"])(M,{value:"先押后付"},{default:n((function(){return[T]})),_:1})]})),_:1},8,["value"]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.payCondition),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(c["createVNode"])(F,{label:"发票类型",name:"invoiceType","has-feedback":"",style:{width:"31%"}},{default:n((function(){return[Object(c["createVNode"])(E,{value:e.purchase.invoiceType,"onUpdate:value":t[19]||(t[19]=function(t){return e.purchase.invoiceType=t}),style:{width:"100%"}},{default:n((function(){return[Object(c["createVNode"])(M,{value:"纸质发票"},{default:n((function(){return[x]})),_:1}),Object(c["createVNode"])(M,{value:"电子发票"},{default:n((function(){return[_]})),_:1})]})),_:1},8,["value"]),Object(c["withDirectives"])(Object(c["createVNode"])("span",null,Object(c["toDisplayString"])(e.purchase.invoiceType),513),[[c["vShow"],"view"===e.sysStatus]])]})),_:1})]})),_:1},8,["model","rules"])])]),Object(c["createVNode"])(H,{visible:e.rejectReasonVisible,"onUpdate:visible":t[21]||(t[21]=function(t){return e.rejectReasonVisible=t}),centered:"",closable:!1,"mask-closable":!1,onOk:t[22]||(t[22]=function(t){return e.handleReceivedPurchaseOrder("reject")}),okText:"确定",cancelText:"取消"},{default:n((function(){return[Object(c["createVNode"])(A,{value:e.reason,"onUpdate:value":t[20]||(t[20]=function(t){return e.reason=t}),placeholder:"请输入驳回原因",rows:8},null,8,["value"])]})),_:1},8,["visible"])],64)})),R=(a("7db0"),a("4160"),a("a434"),a("159b"),a("368b"),a("56cd")),B=(a("7a59"),a("39ab")),L=(a("02cf"),a("9839")),I=(a("519e"),a("0bb7")),U=(a("a71a"),a("b558")),F=(a("04f3"),a("ed3b")),M=(a("e1f5"),a("5efb")),E=a("c1df"),W=a.n(E),P=a("3e16"),z=a("9096"),A=a("d649"),H=a("3f6c"),Y=Object(c["defineComponent"])({components:{"a-button":M["a"],"a-modal":F["a"],"a-input":U["a"],"a-date-picker":I["a"],"a-select":L["b"],"a-upload":B["a"],BaseTableEditable:z["a"]},setup:function(){var e=Object(c["ref"])("view"),t=Object(c["reactive"])([{title:"序号",dataIndex:"key",key:"key",slots:{customRender:"key"},width:70},{title:"物料编码",dataIndex:"code",key:"code",ellipsis:!0,slots:{customRender:"code"}},{title:"规格型号",dataIndex:"name",key:"name",ellipsis:!0,slots:{customRender:"name"}},{title:"采购数量",dataIndex:"qty",key:"qty",ellipsis:!0,slots:{customRender:"qty"}},{title:"物料单位",dataIndex:"uom",key:"uom",ellipsis:!0,slots:{customRender:"uom"}},{title:"采购单价",dataIndex:"price",key:"price",ellipsis:!0,slots:{customRender:"price"}},{title:"采购金额",dataIndex:"amount",key:"amount",ellipsis:!0,slots:{customRender:"amount"}},{title:"收获仓",dataIndex:"receiveWh",key:"receiveWh",ellipsis:!0,slots:{customRender:"receiveWh"}},{title:"操作",dataIndex:"operation",key:"operation",slots:{customRender:"operation"}}]),a=Object(c["reactive"])({orderCode:[{required:!0,message:"请输入采购单号",trigger:"blur"}],supplyName:[{required:!0,message:"请选择供应商名称",trigger:"blur"}],demandSide:[{required:!0,message:"请输入需求方名称",trigger:"blur"}],purDate:[{required:!0,message:"请输入采购日期",trigger:"change"}],contacts:[{required:!0,message:"请输入供应商联系人",trigger:"blur"}],demandContacts:[{required:!0,message:"请输入需求方联系人",trigger:"blur"}],demandDate:[{required:!0,message:"请输入需求日期",trigger:"change"}],tel:[{required:!0,message:"请输入供应商联系方式",trigger:"blur"}],demandTel:[{required:!0,message:"请输入需求方联系方式",trigger:"blur"}],shippingType:[{required:!0,message:"请输入运输方式",trigger:"blur"}],businessLicense:[{required:!0,message:"请输入供应商信用代码",trigger:"blur"}],senderBusinessLicense:[{required:!0,message:"请输入需求方信用代码",trigger:"blur"}],currency:[{required:!0,message:"请输入交易货币",trigger:"blur"}],taxRate:[{required:!0,message:"请输入税率",trigger:"blur"}],payType:[{required:!0,message:"请输入付款方式",trigger:"blur"}],payCondition:[{required:!0,message:"请输入付款形式",trigger:"blur"}],invoiceType:[{required:!0,message:"请输入发票类型",trigger:"blur"}]}),n=Object(c["reactive"])({id:"",orderCode:"",supplyName:void 0,demandSide:"",purDate:W()(),contacts:void 0,demandContacts:"",demandDate:W()(),tel:"",demandTel:"",shippingType:"",businessLicense:"",senderBusinessLicense:"",authorizationCode:"",currency:"人民币",taxRate:0,payType:"银行转账",payCondition:"全款",invoiceType:"电子发票",purchaseMats:[],rowVersion:"",status:""}),r=Object(c["reactive"])([]),s=["code","name","qty","uom","price","amount","receiveWh"],o=Object(c["ref"])([]),i=function(){r.push({key:String(r.length+1),code:"",name:"",qty:0,uom:"",price:0,amount:0,receiveWh:""})},u=function(e){r.forEach((function(t,a,c){t.key===e&&c.splice(a,1)}))},d=function(e){r.forEach((function(t,a,c){t.key===e&&(c[a].code="",c[a].name="",c[a].qty=0,c[a].uom="",c[a].price=0,c[a].amount=0,c[a].receiveWh="")}))},l=Object(c["ref"])(!1),p=Object(c["ref"])(""),h=function(){F["a"].warning({title:"请确认",content:"确定要发送当前采购单吗？",onOk:function(){Object(P["h"])([n.id]).then((function(e){200===e.code&&R["a"].success({message:"成功",description:"发送成功"})})).catch((function(e){R["a"].error({message:"错误",description:e}),console.debug(e)}))},onCancel:function(){}})};return{sysStatus:e,columns:t,rules:a,purchase:n,purchaseMats:r,editableCols:s,fileList:o,addMat:i,rowDeleteHandler:u,cancelEditHandler:d,rejectReasonVisible:l,send:h,reason:p}},data:function(){return{id:this.$route.query.id,type:this.$route.query.type,supplies:[],supplyContacts:[],supplierId:""}},created:function(){void 0!==this.id&&void 0!==this.type?(this.getData(String(this.id),String(this.type)),this.sysStatus="view"):(this.loadTenant(),this.sysStatus="edit")},methods:{getData:function(e,t){var a=this;"send"===t?Object(P["b"])({id:e}).then((function(e){a.purchase.id=e.content.id,a.purchase.orderCode=e.content.orderCode,a.purchase.supplyName=e.content.supplyName,a.purchase.contacts=e.content.contacts,a.purchase.tel=e.content.tel,a.purchase.purDate=e.content.purDate,a.purchase.demandDate=e.content.demandDate,a.purchase.shippingType=e.content.shippingType,a.purchase.demandSide=e.content.demandSide,a.purchase.authorizationCode=e.content.authorizationCode,a.purchase.businessLicense=e.content.businessLicense,a.purchase.senderBusinessLicense=e.content.senderBusinessLicense,a.purchase.status=a.textFormat(e.content.status),a.purchase.currency=e.content.currency,a.purchase.taxRate=e.content.taxRate,a.purchase.payType=e.content.payType,a.purchase.payCondition=e.content.payCondition,a.purchase.invoiceType=e.content.invoiceType,a.purchase.rowVersion=e.content.rowVersion,a.purchase.demandContacts=e.content.demandContacts,a.purchase.demandTel=e.content.demandTel,e.content.purchaseMats.forEach((function(e){a.purchaseMats.push({key:e.id,code:e.code,name:e.name,qty:e.qty,uom:e.uom,price:e.price,amount:e.amount,receiveWh:e.receiveWh})}))})).catch((function(e){R["a"].error({message:"错误",description:e}),console.debug(e)})):"receive"===t&&Object(P["e"])({id:e}).then((function(e){a.purchase.id=e.content.id,a.purchase.orderCode=e.content.orderCode,a.purchase.supplyName=e.content.supplyName,a.purchase.contacts=e.content.contacts,a.purchase.tel=e.content.tel,a.purchase.purDate=e.content.purDate,a.purchase.demandDate=e.content.demandDate,a.purchase.shippingType=e.content.shippingType,a.purchase.demandSide=e.content.demandSide,a.purchase.authorizationCode=e.content.authorizationCode,a.purchase.businessLicense=e.content.businessLicense,a.purchase.senderBusinessLicense=e.content.senderBusinessLicense,a.purchase.status=a.textFormat(e.content.status),a.purchase.currency=e.content.currency,a.purchase.taxRate=e.content.taxRate,a.purchase.payType=e.content.payType,a.purchase.payCondition=e.content.payCondition,a.purchase.invoiceType=e.content.invoiceType,a.purchase.rowVersion=e.content.rowVersion,a.purchase.demandContacts=e.content.demandContacts,a.purchase.demandTel=e.content.demandTel,e.content.purchaseMatReceiveds.forEach((function(e){a.purchaseMats.push({key:e.id,code:e.code,name:e.name,qty:e.qty,uom:e.uom,price:e.price,amount:e.amount,receiveWh:e.receiveWh})}))})).catch((function(e){R["a"].error({message:"错误",description:e}),console.debug(e)}))},loadTenant:function(){var e=this;Object(H["a"])({id:localStorage.getItem("doway_cloud_tenant_id")}).then((function(t){200===t.code&&(e.purchase.demandSide=t.content.name,e.purchase.senderBusinessLicense=t.content.creditCode,e.purchase.demandContacts=t.content.director,e.purchase.demandTel=t.content.tel)})).catch((function(e){R["a"].error({message:"错误",description:e}),console.debug(e)}))},focus:function(){var e=this;Object(A["c"])().then((function(t){e.supplies=t.content})).catch((function(e){R["a"].error({message:"错误",description:e}),console.debug(e)}))},focusSuplCont:function(){var e=this;Object(A["b"])({supplierId:e.supplierId}).then((function(t){e.supplyContacts=t.content})).catch((function(e){R["a"].error({message:"错误",description:e}),console.debug(e)}))},handleSupplierSelect:function(e){var t=this.supplies.find((function(t){return t.id===e}));this.purchase.authorizationCode=t.authorizationCode,this.purchase.businessLicense=t.businessLicense,this.supplierId=e},handleSupplierSearch:function(e){var t=this;t.supplies=[],Object(A["a"])({name:e}).then((function(e){t.supplies=e.content})).catch((function(e){R["a"].error({message:"错误",description:e}),console.debug(e)}))},handleSelect:function(e){var t=this.supplyContacts.find((function(t){return t.id=e}));this.purchase.contacts=t.contacts,this.purchase.tel=null===t.mobile?t.mobile:t.tel},handleSearch:function(e){var t=this;t.supplyContacts=[],Object(A["b"])({supplierId:this.supplierId}).then((function(e){t.supplyContacts=e.content})).catch((function(e){R["a"].error({message:"错误",description:e}),console.debug(e)}))},textFormat:function(e){switch(e){case"saveAsDraft":return"草稿";case"published":return"已发布";case"confirmed":return"已确认";case"rejected":return"已驳回";case"untreated":return"未处理";default:return e}},saveAsDraft:function(){var e=this,t=e.$refs.purchaseBaseForm,a=e.$refs.purchasePayForm;t.validate().then((function(){a.validate().then((function(){e.purchase.purchaseMats=e.purchaseMats;var t=[];t.push(e.purchase),Object(P["a"])(t).then((function(t){e.sysStatus="view",R["a"].success({message:"成功",description:"添加成功"})})).catch((function(e){R["a"].error({message:"错误",description:e}),console.debug(e)}))})).catch((function(e){console.debug(e)}))})).catch((function(e){console.debug(e)}))},handleReceivedPurchaseOrder:function(e){var t={ids:[this.purchase.id],result:e,reason:this.reason};Object(P["d"])(t).then((function(e){200===e.code&&R["a"].success({message:"成功",description:"已进行确认"})})).catch((function(e){R["a"].error({message:"错误",description:e}),console.debug(e)}))},dateFormat:function(e){return W()(e).format("YYYY-MM-DD")},importWordConfirm:function(e){var t=e.file,a=new FormData;a.append("file",t),Object(P["f"])(a).then((function(e){R["a"].success({message:"成功",description:"数据导入成功，请至采购记录页面查看"})})).catch((function(e){R["a"].error({message:"错误",description:e}),console.debug(e)}))}}});a("54db");Y.render=q,Y.__scopeId="data-v-80f46a1c";t["default"]=Y},d649:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return o}));var c=a("b32d"),n="http://cloud.dowaycn.com/Gateway/BaseService/api/v1/supplier";function r(e){return Object(c["a"])({url:n+"/loadByName",method:"get",params:e})}function s(e){return Object(c["a"])({url:n+"/queryAllContacts",method:"get",params:e})}function o(){return Object(c["a"])({url:n+"/query",method:"get"})}},d64f:function(e,t,a){}}]);