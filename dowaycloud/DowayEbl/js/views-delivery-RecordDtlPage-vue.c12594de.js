(window["webpackJsonp_cloud-ebl-app"]=window["webpackJsonp_cloud-ebl-app"]||[]).push([["views-delivery-RecordDtlPage-vue"],{"1ce7":function(e,t,o){"use strict";o("bbb4")},6328:function(e,t,o){"use strict";o("ca56")},"74d2":function(e,t,o){"use strict";o.d(t,"a",(function(){return c})),o.d(t,"c",(function(){return a})),o.d(t,"b",(function(){return i}));var n=o("b32d"),r="http://cloud.dowaycn.com/Gateway/BaseService/api/v1/customer";function c(e){return Object(n["a"])({url:r+"/loadByName",method:"get",params:e})}function a(e){return Object(n["a"])({url:r+"/queryAllContacts",method:"get",params:e})}function i(){return Object(n["a"])({url:r+"/query",method:"get"})}},"7c49":function(e,t,o){"use strict";o.r(t);o("b0c0");var n=o("7a23"),r=Object(n["withScopeId"])("data-v-15a1365c");Object(n["pushScopeId"])("data-v-15a1365c");var c={class:"header"},a=Object(n["createTextVNode"])("发送"),i=Object(n["createTextVNode"])("保存为草稿"),s=Object(n["createTextVNode"])("确认"),d=Object(n["createTextVNode"])("驳回"),l={style:{float:"right","text-align":"center"}},u=Object(n["createVNode"])("a",{href:"http://cloud.dowaycn.com/Gateway/EblService/api/v1/delivery/deliveryDown"},"下载模板",-1),v=Object(n["createTextVNode"])("上传文件"),b={class:"info"},y={class:"box"},p=Object(n["createVNode"])("span",{class:"title"},"基本信息",-1),h=Object(n["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),f={key:1},m={key:1},j=Object(n["createVNode"])("br",null,null,-1),O=Object(n["createVNode"])("br",null,null,-1),g=Object(n["createVNode"])("br",null,null,-1),w=Object(n["createVNode"])("br",null,null,-1),S={class:"box"},V=Object(n["createVNode"])("span",{class:"title"},"送货信息",-1),D=Object(n["createTextVNode"])(" 添加明细 "),k=Object(n["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1);Object(n["popScopeId"])();var C=r((function(e,t,o,C,N,x){var T=Object(n["resolveComponent"])("a-button"),I=Object(n["resolveComponent"])("a-upload"),B=Object(n["resolveComponent"])("a-input"),_=Object(n["resolveComponent"])("a-form-item"),q=Object(n["resolveComponent"])("a-date-picker"),L=Object(n["resolveComponent"])("a-select-option"),R=Object(n["resolveComponent"])("a-select"),E=Object(n["resolveComponent"])("a-form"),F=Object(n["resolveComponent"])("BaseTableEditable"),U=Object(n["resolveComponent"])("a-textarea"),M=Object(n["resolveComponent"])("a-modal");return Object(n["openBlock"])(),Object(n["createBlock"])(n["Fragment"],null,[Object(n["createVNode"])("div",c,[Object(n["withDirectives"])(Object(n["createVNode"])(T,{loading:e.optLoading,style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:e.send},{default:r((function(){return[a]})),_:1},8,["loading","onClick"]),[[n["vShow"],("send"===e.type||void 0!==e.id)&&"草稿"===e.delivery.status]]),Object(n["withDirectives"])(Object(n["createVNode"])(T,{loading:e.saveLoading,style:{color:"#5259e5",border:"1px solid #5259e5"},onClick:e.saveAsDraft},{default:r((function(){return[i]})),_:1},8,["loading","onClick"]),[[n["vShow"],void 0===e.id]]),Object(n["withDirectives"])(Object(n["createVNode"])(T,{loading:e.optLoading,style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[1]||(t[1]=function(t){return e.handleReceivedDeliveryOrder("adopt")})},{default:r((function(){return[s]})),_:1},8,["loading"]),[[n["vShow"],"receive"===e.type&&void 0!==e.id&&"untreated"===e.delivery.status]]),Object(n["withDirectives"])(Object(n["createVNode"])(T,{loading:e.optLoading,style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[2]||(t[2]=function(t){return e.rejectReasonVisible=!0})},{default:r((function(){return[d]})),_:1},8,["loading"]),[[n["vShow"],"receive"===e.type&&void 0!==e.id&&"untreated"===e.statementInfo.status]]),Object(n["createVNode"])("div",l,[Object(n["withDirectives"])(Object(n["createVNode"])(T,{style:{"margin-right":"10px"}},{default:r((function(){return[u]})),_:1},512),[[n["vShow"],void 0===e.id]]),Object(n["withDirectives"])(Object(n["createVNode"])(I,{ref:"upload",action:"",multiple:!0,"file-list":e.fileList,"auto-upload":!1,limit:1,customRequest:e.importWordConfirm},{default:r((function(){return[Object(n["createVNode"])(T,{style:{color:"#5259e5",border:"1px solid #5259e5"}},{default:r((function(){return[v]})),_:1})]})),_:1},8,["file-list","customRequest"]),[[n["vShow"],void 0===e.id]])])]),Object(n["createVNode"])("div",b,[Object(n["createVNode"])("div",y,[p,h,Object(n["createVNode"])(E,{ref:"deliveryForm",model:e.delivery,rules:e.rules,layout:"inline","label-col":{offset:1,span:5},"wrapper-col":{offset:1,span:17}},{default:r((function(){return[Object(n["createVNode"])(_,{label:"送货单号",name:"code","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])(B,{value:e.delivery.code,"onUpdate:value":t[3]||(t[3]=function(t){return e.delivery.code=t}),placeholder:"请输入送货单号"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.code),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(_,{label:"订单日期",name:"orderDate","has-feedback":"",style:{width:"31%"}},{default:r((function(){return["edit"===e.sysStatus?(Object(n["openBlock"])(),Object(n["createBlock"])(q,{key:0,placeholder:"请选择日期",value:e.delivery.orderDate,"onUpdate:value":t[4]||(t[4]=function(t){return e.delivery.orderDate=t}),style:{width:"100%"}},null,8,["value"])):Object(n["createCommentVNode"])("",!0),"view"===e.sysStatus?(Object(n["openBlock"])(),Object(n["createBlock"])("span",f,Object(n["toDisplayString"])(e.dateFormat(e.delivery.orderDate)),1)):Object(n["createCommentVNode"])("",!0)]})),_:1}),Object(n["createVNode"])(_,{label:"送货日期",name:"deliveryDate","has-feedback":"",style:{width:"31%"}},{default:r((function(){return["edit"===e.sysStatus?(Object(n["openBlock"])(),Object(n["createBlock"])(q,{key:0,placeholder:"请选择日期",value:e.delivery.deliveryDate,"onUpdate:value":t[5]||(t[5]=function(t){return e.delivery.deliveryDate=t}),style:{width:"100%"}},null,8,["value"])):Object(n["createCommentVNode"])("",!0),"view"===e.sysStatus?(Object(n["openBlock"])(),Object(n["createBlock"])("span",m,Object(n["toDisplayString"])(e.dateFormat(e.delivery.deliveryDate)),1)):Object(n["createCommentVNode"])("",!0)]})),_:1}),Object(n["createVNode"])(_,{label:"总重量",name:"totalWeight","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])(B,{value:e.delivery.totalWeight,"onUpdate:value":t[6]||(t[6]=function(t){return e.delivery.totalWeight=t}),placeholder:"请输入总重量"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.totalWeight),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(_,{label:"总体积",name:"totalVol","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])(B,{value:e.delivery.totalVol,"onUpdate:value":t[7]||(t[7]=function(t){return e.delivery.totalVol=t}),placeholder:"请输入总体积"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.totalVol),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(_,{label:"运输方式",name:"shippingType","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])(B,{value:e.delivery.shippingType,"onUpdate:value":t[8]||(t[8]=function(t){return e.delivery.shippingType=t}),placeholder:"请输入运输方式"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.shippingType),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1}),j,O,Object(n["createVNode"])(_,{label:"收货方",name:"shipTo","has-feedback":"",style:{width:"31%"}},{default:r((function(){return["edit"===e.sysStatus?(Object(n["openBlock"])(),Object(n["createBlock"])(R,{key:0,"show-search":"",value:e.delivery.customerId,"onUpdate:value":t[9]||(t[9]=function(t){return e.delivery.customerId=t}),placeholder:"请选择收货方",onFocus:e.focusHandler,style:{width:"100%"},"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",onSearch:e.handleCustomerSearch,onSelect:e.handleCustomerSelect},{default:r((function(){return[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.customers,(function(e){return Object(n["openBlock"])(),Object(n["createBlock"])(L,{key:e.id},{default:r((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.name),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])):Object(n["createCommentVNode"])("",!0),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.shipTo),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(_,{label:"收货联系人",name:"contacts",required:"","has-feedback":"",style:{width:"31%"}},{default:r((function(){return["edit"===e.sysStatus?(Object(n["openBlock"])(),Object(n["createBlock"])(R,{key:0,"show-search":"",value:e.delivery.contacts,"onUpdate:value":t[10]||(t[10]=function(t){return e.delivery.contacts=t}),placeholder:"请选择收货联系人",onFocus:e.focusDeliCont,style:{width:"100%"},"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",onSearch:e.handleSearch,onSelect:e.handleSelect},{default:r((function(){return[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.customerContacts,(function(e){return Object(n["openBlock"])(),Object(n["createBlock"])(L,{key:e.id},{default:r((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.contacts),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])):Object(n["createCommentVNode"])("",!0),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.contacts),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(_,{label:"联系方式",name:"tel","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])(B,{value:e.delivery.tel,"onUpdate:value":t[11]||(t[11]=function(t){return e.delivery.tel=t}),placeholder:"请输入联系方式"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.tel),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(_,{label:"收货地址",name:"address","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])(B,{value:e.delivery.address,"onUpdate:value":t[12]||(t[12]=function(t){return e.delivery.address=t}),placeholder:"请输入收货地址"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.address),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1}),g,w,Object(n["createVNode"])(_,{label:"送货方",name:"shipper","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])(B,{value:e.delivery.shipper,"onUpdate:value":t[13]||(t[13]=function(t){return e.delivery.shipper=t}),placeholder:"请输入送货方名称"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.shipper),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(_,{label:"送货联系人",name:"shipperTel","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])(B,{value:e.delivery.shipperTel,"onUpdate:value":t[14]||(t[14]=function(t){return e.delivery.shipperTel=t}),placeholder:"请输入送货联系人"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.shipperTel),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(_,{label:"路线",name:"route","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])(B,{value:e.delivery.route,"onUpdate:value":t[15]||(t[15]=function(t){return e.delivery.route=t}),placeholder:"请输入路线"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.route),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(_,{label:"送货金额",name:"amount","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])(B,{value:e.delivery.amount,"onUpdate:value":t[16]||(t[16]=function(t){return e.delivery.amount=t}),placeholder:"请输入送货金额"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.delivery.amount),513),[[n["vShow"],"view"===e.sysStatus]])]})),_:1})]})),_:1},8,["model","rules"])]),Object(n["createVNode"])("div",S,[V,Object(n["withDirectives"])(Object(n["createVNode"])(T,{style:{float:"right",color:"#5259e5",border:"1px solid #5259e5"},onClick:e.addDeliveryDtl},{default:r((function(){return[D]})),_:1},8,["onClick"]),[[n["vShow"],void 0===e.id]]),k,Object(n["createVNode"])(F,{columns:e.columns,sourceData:e.deliveryMats,editableCols:void 0===e.id&&"edit"===e.sysStatus?e.editableCols:[],onRowEdit:e.rowEditHandler,onCancelEdit:e.cancelEditHandler,onRowDelete:e.rowDeleteHandler},null,8,["columns","sourceData","editableCols","onRowEdit","onCancelEdit","onRowDelete"])])]),Object(n["createVNode"])(M,{visible:e.rejectReasonVisible,"onUpdate:visible":t[18]||(t[18]=function(t){return e.rejectReasonVisible=t}),centered:"",closable:!1,"mask-closable":!1,onOk:t[19]||(t[19]=function(t){return e.handleReceivedDeliveryOrder("reject")}),okText:"确定",cancelText:"取消"},{default:r((function(){return[Object(n["createVNode"])(U,{value:e.reason,"onUpdate:value":t[17]||(t[17]=function(t){return e.reason=t}),placeholder:"请输入驳回原因",rows:8},null,8,["value"])]})),_:1},8,["visible"])],64)})),N=(o("7db0"),o("4160"),o("a434"),o("d3b7"),o("159b"),o("368b"),o("56cd")),x=(o("7a59"),o("39ab")),T=(o("519e"),o("0bb7")),I=(o("04f3"),o("ed3b")),B=(o("e1f5"),o("5efb")),_=o("c1df"),q=o.n(_),L=o("a13b"),R=o("74d2"),E=o("9096"),F=o("3f6c"),U=Object(n["defineComponent"])({components:{"a-button":B["a"],"a-modal":I["a"],"a-date-picker":T["a"],"a-upload":x["a"],BaseTableEditable:E["a"]},setup:function(){var e=Object(n["ref"])("view"),t=Object(n["ref"])(!1),o=Object(n["ref"])(!1),r=Object(n["reactive"])([{title:"序号",dataIndex:"key",key:"key",slots:{customRender:"key"},width:70},{title:"物料编码",dataIndex:"code",key:"code",slots:{customRender:"code"}},{title:"规格型号",dataIndex:"name",key:"name",slots:{customRender:"name"}},{title:"送货数量",dataIndex:"qty",key:"qty",ellipsis:!0,slots:{customRender:"qty"}},{title:"送货金额",dataIndex:"amount",key:"amount",ellipsis:!0,slots:{customRender:"amount"}},{title:"销售单号",dataIndex:"salesCode",key:"salesCode",ellipsis:!0,slots:{customRender:"salesCode"}},{title:"行体积",dataIndex:"vol",key:"vol",ellipsis:!0,slots:{customRender:"vol"}},{title:"操作",dataIndex:"operation",key:"operation",slots:{customRender:"operation"}}]),c=Object(n["reactive"])({id:"",code:"",shipTo:"",customerId:void 0,shipper:"",orderDate:q()(),contacts:void 0,deliveryDate:q()(),tel:"",route:"",totalWeight:"",address:"",shippingType:"",shipperTel:"",totalVol:"",status:"draft",amount:"",authorizationCode:"",businessLicense:"",senderBusinessLicense:"",rowVersion:"",deliveryMats:[]}),a=function(e,t,o){return null===t?Promise.reject(e.message):Promise.resolve()},i=Object(n["reactive"])({code:[{required:!0,message:"送货单号不能为空",trigger:"blur"}],shipTo:[{required:!0,message:"客户名称不能为空",trigger:"blur"}],shipper:[{required:!0,message:"送货方不能为空",trigger:"blur"}],contacts:[{required:!0,message:"客户联系人不能为空",trigger:"blur"}],amount:[{required:!0,message:"送货金额不能为空",trigger:"blur"}],address:[{required:!0,message:"收货地址不能为空",trigger:"blur"}],tel:[{required:!0,message:"联系方式不能为空",trigger:"blur"}],shipperTel:[{required:!0,message:"送货联系人不能为空",trigger:"blur"}],deliveryDate:[{validator:a,message:"送货日期不能为空",trigger:"blur"},{validator:a,message:"送货日期不能为空",trigger:"change"}]}),s=Object(n["reactive"])([]),d=["code","name","qty","amount","salesCode","vol"],l=Object(n["ref"])([]),u=function(){s.push({key:String(s.length+1),id:"",code:"",name:"",qty:"",amount:"",salesCode:"",purCode:"",vol:"",deliveryId:"",editable:!0})},v=Object(n["reactive"])({key:"",id:"",code:"",name:"",qty:"",amount:"",salesCode:"",purCode:"",vol:"",deliveryId:""}),b=function(e){v.code=e.code,v.name=e.name,v.qty=e.qty,v.salesCode=e.salesCode},y=function(e){s.forEach((function(t,o,n){t.key===e&&(n[o].code=v.code,n[o].name=v.name,n[o].salesCode=v.salesCode)}))},p=function(e){s.forEach((function(t,o,n){t.key===e&&n.splice(o,1)}))},h=Object(n["ref"])(!1),f=Object(n["ref"])(""),m=function(){""===c.businessLicense?N["a"].error({message:"错误",description:"未填写客户信用代码，无法识别当前客户，请完善客户信息，并重新选取客户"}):""===c.authorizationCode?N["a"].error({message:"错误",description:"当前所选客户还不是您的合作伙伴"}):I["a"].confirm({title:"请确认",content:"确定要发送当前送货单吗？",cancelText:"取消",okText:"确认",onOk:function(){o.value=!0,Object(L["k"])([c.id]).then((function(e){200===e.code&&N["a"].success({message:"成功",description:"发送成功"})})).catch((function(e){N["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){o.value=!1}))}})};return{sysStatus:e,saveLoading:t,optLoading:o,columns:r,delivery:c,deliveryMats:s,editableCols:d,fileList:l,addDeliveryDtl:u,rowEditHandler:b,cancelEditHandler:y,rowDeleteHandler:p,rejectReasonVisible:h,send:m,reason:f,rules:i}},data:function(){return{id:this.$route.query.id,type:this.$route.query.type,customers:[],customerContacts:[],customerId:""}},created:function(){"string"===typeof this.id&&"string"===typeof this.type?(this.getData(this.id,this.type),this.sysStatus="view"):(this.loadTenant(),this.sysStatus="edit")},methods:{getData:function(e,t){var o=this;"send"===t?Object(L["d"])({id:e}).then((function(e){o.delivery.id=e.content.id,o.delivery.code=e.content.code,o.delivery.shipTo=e.content.shipTo,o.delivery.customerId=e.content.customerId,o.delivery.shipper=e.content.shipper,o.delivery.shipperTel=e.content.shipperTel,o.delivery.orderDate=e.content.orderDate,o.delivery.contacts=e.content.contacts,o.delivery.deliveryDate=e.content.deliveryDate,o.delivery.tel=e.content.tel,o.delivery.route=e.content.route,o.delivery.totalWeight=e.content.totalWeight,o.delivery.address=e.content.address,o.delivery.shippingType=e.content.shippingType,o.delivery.totalVol=e.content.totalVol,o.delivery.amount=e.content.amount,o.delivery.status=o.textFormat(e.content.status),o.delivery.authorizationCode=e.content.authorizationCode,o.delivery.businessLicense=e.content.businessLicense,o.delivery.senderBusinessLicense=e.content.senderBusinessLicense,o.delivery.rowVersion=e.content.rowVersion,e.content.deliveryMats.forEach((function(e){o.deliveryMats.push({key:String(o.deliveryMats.length+1),id:e.code,code:e.code,name:e.name,qty:e.qty,amount:e.amount,salesCode:e.salesCode,purCode:e.purCode,vol:e.purCode,deliveryId:e.deliveryId})}))})).catch((function(e){N["a"].error({message:"错误",description:e}),console.debug(e)})):Object(L["f"])({id:e}).then((function(e){o.delivery.id=e.content.id,o.delivery.code=e.content.code,o.delivery.shipTo=e.content.shipTo,o.delivery.customerId=e.content.customerId,o.delivery.shipper=e.content.shipper,o.delivery.orderDate=e.content.orderDate,o.delivery.contacts=e.content.contacts,o.delivery.deliveryDate=e.content.deliveryDate,o.delivery.tel=e.content.tel,o.delivery.route=e.content.route,o.delivery.totalWeight=e.content.totalWeight,o.delivery.address=e.content.address,o.delivery.shippingType=e.content.shippingType,o.delivery.totalVol=e.content.totalVol,o.delivery.amount=e.content.amount,o.delivery.status=o.textFormat(e.content.status),o.delivery.authorizationCode=e.content.authorizationCode,o.delivery.businessLicense=e.content.businessLicense,o.delivery.senderBusinessLicense=e.content.senderBusinessLicense,o.delivery.rowVersion=e.content.rowVersion,e.content.deliveryMats.forEach((function(e){o.deliveryMats.push({key:String(o.deliveryMats.length+1),id:e.code,code:e.code,name:e.name,qty:e.qty,amount:e.amount,salesCode:e.salesCode,purCode:e.purCode,vol:e.purCode,deliveryId:e.deliveryId})}))})).catch((function(e){N["a"].error({message:"错误",description:e}),console.debug(e)}))},loadTenant:function(){var e=this;Object(F["a"])({id:localStorage.getItem("doway_cloud_tenant_id")}).then((function(t){200===t.code&&(e.delivery.senderBusinessLicense=t.content.creditCode,e.delivery.shipper=t.content.name,e.delivery.shipperTel=t.content.director)})).catch((function(e){N["a"].error({message:"错误",description:e}),console.debug(e)}))},focusHandler:function(){var e=this;Object(R["b"])().then((function(t){e.customers=t.content})).catch((function(e){N["a"].error({message:"错误",description:e}),console.debug(e)}))},focusDeliCont:function(){var e=this;e.customerId?Object(R["c"])({customerId:this.customerId}).then((function(t){e.customerContacts=t.content})).catch((function(e){N["a"].error({message:"错误",description:e}),console.debug(e)})):N["a"].warning({message:"警告",description:"当前客户信息缺失，请先选择客户"})},handleCustomerSelect:function(e){var t=this.customers.find((function(t){return t.id===e}));this.delivery.shipTo=t.name,this.delivery.address=t.address,this.delivery.authorizationCode=t.authorizationCode,this.delivery.businessLicense=t.businessLicense,this.customerId=e},handleCustomerSearch:function(e){var t=this;t.customers=[],Object(R["a"])({name:e}).then((function(e){t.customers=e.content})).catch((function(e){N["a"].error({message:"错误",description:e}),console.debug(e)}))},handleSelect:function(e){var t=this.customerContacts.find((function(t){return t.id=e}));this.delivery.contacts=t.contacts,this.delivery.tel=null===t.mobile?t.mobile:t.tel},handleSearch:function(e){var t=this;t.customerContacts=[],Object(R["c"])({customerId:this.customerId}).then((function(e){t.customerContacts=e.content})).catch((function(e){N["a"].error({message:"错误",description:e}),console.debug(e)}))},saveAsDraft:function(){var e=this,t=e.$refs.deliveryForm;t.validate().then((function(){e.delivery.deliveryMats=e.deliveryMats;var o=[];o.push(e.delivery),e.saveLoading=!0,Object(L["a"])(o).then((function(o){200===o.code&&(e.id=o.content,t.resetFields(),e.deliveryMats.splice(0),e.loadTenant(),N["a"].success({message:"成功",description:"录入送货单成功"}))})).catch((function(e){N["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){e.saveLoading=!1}))})).catch((function(e){console.debug(e)}))},textFormat:function(e){switch(e){case"draft":return"草稿";case"published":return"已发布";case"confirmed":return"已确认";case"rejected":return"已驳回";case"untreated":return"未处理";default:return e}},dateFormat:function(e){return q()(e).format("YYYY-MM-DD")},handleReceivedDeliveryOrder:function(e){var t=this,o={ids:[t.delivery.id],result:e,reason:t.reason};t.optLoading=!0,Object(L["e"])(o).then((function(e){t.getData(String(t.id),String(t.type)),t.rejectReasonVisible=!1,200===e.code&&N["a"].success({message:"成功",description:"接收成功"})})).catch((function(e){N["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){t.optLoading=!1}))},importWordConfirm:function(e){var t=e.file,o=new FormData;o.append("file",t),Object(L["b"])(o).then((function(e){N["a"].success({message:"成功",description:e.msg})})).catch((function(e){N["a"].error({message:"错误",description:e}),console.debug(e)}))}}});o("1ce7"),o("6328");U.render=C,U.__scopeId="data-v-15a1365c";t["default"]=U},a13b:function(e,t,o){"use strict";o.d(t,"d",(function(){return c})),o.d(t,"f",(function(){return a})),o.d(t,"c",(function(){return i})),o.d(t,"g",(function(){return s})),o.d(t,"j",(function(){return d})),o.d(t,"a",(function(){return l})),o.d(t,"e",(function(){return u})),o.d(t,"b",(function(){return v})),o.d(t,"k",(function(){return b})),o.d(t,"h",(function(){return y})),o.d(t,"i",(function(){return p}));var n=o("b32d"),r="http://cloud.dowaycn.com/Gateway/EblService/api/v1/delivery";function c(e){return Object(n["a"])({url:r+"/loadById",method:"get",params:e})}function a(e){return Object(n["a"])({url:r+"/loadByIdReceived",method:"get",params:e})}function i(e){return Object(n["a"])({url:r+"/generateStatement",method:"post",data:e})}function s(){return Object(n["a"])({url:r+"/queryAll",method:"get"})}function d(){return Object(n["a"])({url:r+"/searchReceivedDelivery",method:"get"})}function l(e){return Object(n["a"])({url:r+"/adds",method:"post",data:e})}function u(e){return Object(n["a"])({url:r+"/handleReceiveDeliveryOrder",method:"post",data:e})}function v(e){return Object(n["a"])({url:r+"/deliveryImport",method:"post",data:e})}function b(e){return Object(n["a"])({url:r+"/sendDeliveryOrder",method:"post",data:e})}function y(e){return Object(n["a"])({url:r+"/searchByExp",method:"post",data:e})}function p(e){return Object(n["a"])({url:r+"/searchReceivedByExp",method:"post",data:e})}},bbb4:function(e,t,o){},ca56:function(e,t,o){}}]);