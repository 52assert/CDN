(window["webpackJsonp_cloud-ebl-app"]=window["webpackJsonp_cloud-ebl-app"]||[]).push([["views-purchase-RecordDtlPage-vue"],{"3e16":function(e,t,c){"use strict";c.d(t,"b",(function(){return r})),c.d(t,"e",(function(){return o})),c.d(t,"c",(function(){return s})),c.d(t,"g",(function(){return u})),c.d(t,"a",(function(){return i})),c.d(t,"h",(function(){return d})),c.d(t,"d",(function(){return l})),c.d(t,"f",(function(){return p}));var n=c("b32d"),a="http://cloud.dowaycn.com/Gateway/EblService/api/v1/purchase";function r(e){return Object(n["a"])({url:a+"/loadById",method:"get",params:e})}function o(e){return Object(n["a"])({url:a+"/loadByIdReceived",method:"get",params:e})}function s(){return Object(n["a"])({url:a+"/queryAll",method:"get"})}function u(){return Object(n["a"])({url:a+"/queryAllReceived",method:"get"})}function i(e){return Object(n["a"])({url:a+"/adds",method:"post",data:e})}function d(e){return Object(n["a"])({url:a+"/sendPurchaseOrder",method:"post",data:e})}function l(e){return Object(n["a"])({url:a+"/handleReceivedPurchaseOrder",method:"post",data:e})}function p(e){return Object(n["a"])({url:a+"/purchaseImport",method:"post",data:e})}},8151:function(e,t,c){"use strict";c.r(t);c("b0c0");var n=c("7a23"),a=Object(n["withScopeId"])("data-v-6ad0d74d");Object(n["pushScopeId"])("data-v-6ad0d74d");var r={class:"header"},o=Object(n["createTextVNode"])("发送"),s=Object(n["createTextVNode"])("确认"),u=Object(n["createTextVNode"])("驳回"),i=Object(n["createTextVNode"])("保存为草稿"),d={style:{float:"right","text-align":"center"}},l=Object(n["createVNode"])("a",{href:"http://cloud.dowaycn.com/Gateway/EblService/api/v1/purchase/purchaseDown"},"下载模板",-1),p=Object(n["createTextVNode"])("上传文件"),h={class:"body"},b={class:"info"},f={class:"box"},O=Object(n["createVNode"])("span",{class:"title"},"基本信息",-1),j=Object(n["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),v=Object(n["createTextVNode"])("采购单号"),y=Object(n["createTextVNode"])("供应商"),m=Object(n["createTextVNode"])("联系人"),N=Object(n["createTextVNode"])("联系方式"),V=Object(n["createTextVNode"])("采购日期"),w=Object(n["createTextVNode"])("需求日期"),S=Object(n["createTextVNode"])("运输方式"),x=Object(n["createTextVNode"])("需求方"),g={class:"box"},D=Object(n["createVNode"])("span",{class:"title"},"物料明细",-1),T=Object(n["createTextVNode"])(" 添加明细 "),_=Object(n["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),C={class:"box"},k=Object(n["createVNode"])("span",{class:"title"},"付款信息",-1),R=Object(n["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),I=Object(n["createTextVNode"])("交易货币"),B=Object(n["createTextVNode"])(" 人民币 "),q=Object(n["createTextVNode"])(" 美元 "),F=Object(n["createTextVNode"])("税率"),L=Object(n["createTextVNode"])("付款方式"),M=Object(n["createTextVNode"])(" 银行转账 "),U=Object(n["createTextVNode"])(" 货币交易 "),E=Object(n["createTextVNode"])("付款形式"),W=Object(n["createTextVNode"])(" 全款 "),z=Object(n["createTextVNode"])(" 先押后付 "),Y=Object(n["createTextVNode"])("发票类型"),A=Object(n["createTextVNode"])(" 纸质发票 "),P=Object(n["createTextVNode"])(" 电子发票 ");Object(n["popScopeId"])();var H=a((function(e,t,c,H,G,J){var $=Object(n["resolveComponent"])("a-button"),K=Object(n["resolveComponent"])("a-upload"),Q=Object(n["resolveComponent"])("a-col"),X=Object(n["resolveComponent"])("a-input"),Z=Object(n["resolveComponent"])("a-select-option"),ee=Object(n["resolveComponent"])("a-select"),te=Object(n["resolveComponent"])("a-row"),ce=Object(n["resolveComponent"])("a-date-picker"),ne=Object(n["resolveComponent"])("BaseTableEditable"),ae=Object(n["resolveComponent"])("a-textarea"),re=Object(n["resolveComponent"])("a-modal");return Object(n["openBlock"])(),Object(n["createBlock"])(n["Fragment"],null,[Object(n["createVNode"])("div",r,[Object(n["withDirectives"])(Object(n["createVNode"])($,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:e.send},{default:a((function(){return[o]})),_:1},8,["onClick"]),[[n["vShow"],"send"===e.type&&"string"===typeof this.id]]),Object(n["withDirectives"])(Object(n["createVNode"])($,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[1]||(t[1]=function(t){return e.handleReceivedPurchaseOrder("adopt")})},{default:a((function(){return[s]})),_:1},512),[[n["vShow"],"receive"===e.type&&"string"===typeof this.id]]),Object(n["withDirectives"])(Object(n["createVNode"])($,{style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[2]||(t[2]=function(t){return e.rejectReasonVisible=!0})},{default:a((function(){return[u]})),_:1},512),[[n["vShow"],"receive"===e.type&&"string"===typeof this.id]]),Object(n["withDirectives"])(Object(n["createVNode"])($,{style:{color:"#5259e5",border:"1px solid #5259e5"},onClick:e.saveAsDraft},{default:a((function(){return[i]})),_:1},8,["onClick"]),[[n["vShow"],"string"!==typeof this.id]]),Object(n["createVNode"])("div",d,[Object(n["createVNode"])($,{style:{"margin-right":"10px"}},{default:a((function(){return[l]})),_:1}),Object(n["createVNode"])(K,{ref:"upload",action:"",multiple:!0,"file-list":e.fileList,"auto-upload":!1,limit:1,customRequest:e.importWordConfirm},{default:a((function(){return[Object(n["createVNode"])($,{style:{color:"#5259e5",border:"1px solid #5259e5"}},{default:a((function(){return[p]})),_:1})]})),_:1},8,["file-list","customRequest"])])]),Object(n["createVNode"])("div",h,[Object(n["createVNode"])("div",b,[Object(n["createVNode"])("div",f,[O,j,Object(n["createVNode"])(te,{style:{margin:"15px 0px"}},{default:a((function(){return[Object(n["createVNode"])(Q,{span:2,class:"text"},{default:a((function(){return[v]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.purchase.orderCode),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])(X,{value:e.purchase.orderCode,"onUpdate:value":t[3]||(t[3]=function(t){return e.purchase.orderCode=t}),placeholder:"请输入采购单号"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(Q,{offset:1,span:2,class:"text"},{default:a((function(){return[y]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.purchase.supplyName),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("div",null,[Object(n["createVNode"])(ee,{"show-search":"",value:e.purchase.supplyName,"onUpdate:value":t[4]||(t[4]=function(t){return e.purchase.supplyName=t}),onFocus:e.focus,placeholder:"请选择供应商名称",style:{width:"100%"},"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",onSearch:e.handleSupplierSearch,onSelect:e.handleSupplierSelect},{default:a((function(){return[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.supplies,(function(e){return Object(n["openBlock"])(),Object(n["createBlock"])(Z,{key:e.id},{default:a((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.name),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])],512),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(Q,{offset:1,span:2,class:"text"},{default:a((function(){return[m]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.purchase.contacts),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("div",null,[Object(n["createVNode"])(ee,{"show-search":"",value:e.purchase.contacts,"onUpdate:value":t[5]||(t[5]=function(t){return e.purchase.contacts=t}),placeholder:"请选择供应商联系人",onFocus:e.focusSuplCont,style:{width:"100%"},"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",onSearch:e.handleSearch,onSelect:e.handleSelect},{default:a((function(){return[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.supplyContacts,(function(e){return Object(n["openBlock"])(),Object(n["createBlock"])(Z,{key:e.id},{default:a((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.contacts),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])],512),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1})]})),_:1}),Object(n["createVNode"])(te,{style:{margin:"15px 0px"}},{default:a((function(){return[Object(n["createVNode"])(Q,{span:2,class:"text"},{default:a((function(){return[N]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.purchase.tel),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])(X,{value:e.purchase.tel,"onUpdate:value":t[6]||(t[6]=function(t){return e.purchase.tel=t}),placeholder:"请输入联系方式"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(Q,{offset:1,span:2,class:"text"},{default:a((function(){return[V]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.dateFormat(e.purchase.purDate)),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])(ce,{value:e.purchase.purDate,"onUpdate:value":t[7]||(t[7]=function(t){return e.purchase.purDate=t}),placeholder:"请选择日期",style:{width:"100%"}},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(Q,{offset:1,span:2,class:"text"},{default:a((function(){return[w]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.dateFormat(e.purchase.demandDate)),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])(ce,{value:e.purchase.demandDate,"onUpdate:value":t[8]||(t[8]=function(t){return e.purchase.demandDate=t}),placeholder:"请选择日期",style:{width:"100%"}},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1})]})),_:1}),Object(n["createVNode"])(te,{style:{margin:"15px 0px"}},{default:a((function(){return[Object(n["createVNode"])(Q,{span:2,class:"text"},{default:a((function(){return[S]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.purchase.shippingType),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])(X,{value:e.purchase.shippingType,"onUpdate:value":t[9]||(t[9]=function(t){return e.purchase.shippingType=t}),placeholder:"请输入运输方式"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(Q,{offset:1,span:2,class:"text"},{default:a((function(){return[x]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.purchase.demandSide),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])(X,{value:e.purchase.demandSide,"onUpdate:value":t[10]||(t[10]=function(t){return e.purchase.demandSide=t}),placeholder:"请输入需求方名称"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1})]})),_:1})]),Object(n["createVNode"])("div",g,[D,Object(n["createVNode"])($,{style:{float:"right",color:"#5259e5",border:"1px solid #5259e5"},onClick:e.addMat},{default:a((function(){return[T]})),_:1},8,["onClick"]),_,Object(n["createVNode"])(ne,{columns:e.columns,sourceData:e.purchaseMats,editableCols:e.editableCols,onRowDelete:e.rowDeleteHandler,onCancelEdit:e.cancelEditHandler},null,8,["columns","sourceData","editableCols","onRowDelete","onCancelEdit"])]),Object(n["createVNode"])("div",C,[k,R,Object(n["createVNode"])(te,{style:{margin:"15px 0px"}},{default:a((function(){return[Object(n["createVNode"])(Q,{span:2,class:"text"},{default:a((function(){return[I]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.purchase.currency),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("div",null,[Object(n["createVNode"])(ee,{ref:"select",value:e.purchase.currency,"onUpdate:value":t[11]||(t[11]=function(t){return e.purchase.currency=t}),style:{width:"100%"}},{default:a((function(){return[Object(n["createVNode"])(Z,{value:"人民币"},{default:a((function(){return[B]})),_:1}),Object(n["createVNode"])(Z,{value:"美元"},{default:a((function(){return[q]})),_:1})]})),_:1},8,["value"])],512),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(Q,{offset:1,span:2,class:"text"},{default:a((function(){return[F]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.purchase.taxRate),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])(X,{value:e.purchase.taxRate,"onUpdate:value":t[12]||(t[12]=function(t){return e.purchase.taxRate=t}),placeholder:"请输入税率"},null,8,["value"]),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(Q,{offset:1,span:2,class:"text"},{default:a((function(){return[L]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.purchase.payType),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("div",null,[Object(n["createVNode"])(ee,{ref:"select",value:e.purchase.payType,"onUpdate:value":t[13]||(t[13]=function(t){return e.purchase.payType=t}),style:{width:"100%"}},{default:a((function(){return[Object(n["createVNode"])(Z,{value:"银行转账"},{default:a((function(){return[M]})),_:1}),Object(n["createVNode"])(Z,{value:"货币交易"},{default:a((function(){return[U]})),_:1})]})),_:1},8,["value"])],512),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1})]})),_:1}),Object(n["createVNode"])(te,{style:{margin:"15px 0px"}},{default:a((function(){return[Object(n["createVNode"])(Q,{span:2,class:"text"},{default:a((function(){return[E]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.purchase.payCondition),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("div",null,[Object(n["createVNode"])(ee,{ref:"select",value:e.purchase.payCondition,"onUpdate:value":t[14]||(t[14]=function(t){return e.purchase.payCondition=t}),style:{width:"100%"}},{default:a((function(){return[Object(n["createVNode"])(Z,{value:"全款"},{default:a((function(){return[W]})),_:1}),Object(n["createVNode"])(Z,{value:"先押后付"},{default:a((function(){return[z]})),_:1})]})),_:1},8,["value"])],512),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1}),Object(n["createVNode"])(Q,{offset:1,span:2,class:"text"},{default:a((function(){return[Y]})),_:1}),Object(n["createVNode"])(Q,{span:5,class:"spanText"},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(e.purchase.invoiceType),513),[[n["vShow"],"view"===e.sysStatus]]),Object(n["withDirectives"])(Object(n["createVNode"])("div",null,[Object(n["createVNode"])(ee,{ref:"select",value:e.purchase.invoiceType,"onUpdate:value":t[15]||(t[15]=function(t){return e.purchase.invoiceType=t}),style:{width:"100%"}},{default:a((function(){return[Object(n["createVNode"])(Z,{value:"纸质发票"},{default:a((function(){return[A]})),_:1}),Object(n["createVNode"])(Z,{value:"电子发票"},{default:a((function(){return[P]})),_:1})]})),_:1},8,["value"])],512),[[n["vShow"],"edit"===e.sysStatus]])]})),_:1})]})),_:1})])])]),Object(n["createVNode"])(re,{visible:e.rejectReasonVisible,"onUpdate:visible":t[17]||(t[17]=function(t){return e.rejectReasonVisible=t}),centered:"",closable:!1,"mask-closable":!1,onOk:t[18]||(t[18]=function(t){return e.handleReceivedPurchaseOrder("reject")}),okText:"确定",cancelText:"取消"},{default:a((function(){return[Object(n["createVNode"])(ae,{value:e.reason,"onUpdate:value":t[16]||(t[16]=function(t){return e.reason=t}),placeholder:"请输入驳回原因",rows:8},null,8,["value"])]})),_:1},8,["visible"])],64)})),G=(c("7db0"),c("4160"),c("a434"),c("a9e3"),c("159b"),c("368b"),c("56cd")),J=(c("7a59"),c("39ab")),$=(c("02cf"),c("9839")),K=(c("519e"),c("0bb7")),Q=(c("a71a"),c("b558")),X=(c("04f3"),c("ed3b")),Z=(c("1815"),c("e32c")),ee=(c("50ac"),c("9a63")),te=(c("e1f5"),c("5efb")),ce=c("c1df"),ne=c.n(ce),ae=c("3e16"),re=c("9096"),oe=c("b32d"),se="http://cloud.dowaycn.com/Gateway/BaseService/api/v1/supplier";function ue(e){return Object(oe["a"])({url:se+"/loadByName",method:"get",params:e})}function ie(e){return Object(oe["a"])({url:se+"/queryAllContacts",method:"get",params:e})}function de(){return Object(oe["a"])({url:se+"/query",method:"get"})}var le=c("3f6c"),pe=Object(n["defineComponent"])({components:{"a-button":te["a"],"a-row":ee["a"],"a-col":Z["a"],"a-modal":X["a"],"a-input":Q["a"],"a-date-picker":K["a"],"a-select":$["b"],"a-upload":J["a"],BaseTableEditable:re["a"]},setup:function(){var e=Object(n["ref"])("view"),t=Object(n["reactive"])([{title:"序号",dataIndex:"key",key:"key",slots:{customRender:"key"},width:70},{title:"物料编码",dataIndex:"code",key:"code",ellipsis:!0,slots:{customRender:"code"}},{title:"规格型号",dataIndex:"name",key:"name",ellipsis:!0,slots:{customRender:"name"}},{title:"采购数量",dataIndex:"qty",key:"qty",ellipsis:!0,slots:{customRender:"qty"}},{title:"物料单位",dataIndex:"uom",key:"uom",ellipsis:!0,slots:{customRender:"uom"}},{title:"采购单价",dataIndex:"price",key:"price",ellipsis:!0,slots:{customRender:"price"}},{title:"采购金额",dataIndex:"amount",key:"amount",ellipsis:!0,slots:{customRender:"amount"}},{title:"收获仓",dataIndex:"receiveWh",key:"receiveWh",ellipsis:!0,slots:{customRender:"receiveWh"}},{title:"操作",dataIndex:"operation",key:"operation",slots:{customRender:"operation"}}]),c=Object(n["reactive"])({id:"",orderCode:"",supplyName:void 0,contacts:void 0,tel:"",purDate:ne()(),demandDate:ne()(),shippingType:"",demandSide:"",authorizationCode:"",businessLicense:"",senderBusinessLicense:"",currency:"人民币",taxRate:0,payType:"银行转账",payCondition:"全款",invoiceType:"电子发票",purchaseMats:[],rowVersion:"",status:""}),a=Object(n["reactive"])([]),r=["code","name","qty","uom","price","amount","receiveWh"],o=Object(n["ref"])([]),s=function(){a.push({key:String(a.length+1),code:"",name:"",qty:0,uom:"",price:0,amount:0,receiveWh:""})},u=function(e){a.forEach((function(t,c,n){t.key===e&&n.splice(c,1)}))},i=function(e){a.forEach((function(t,c,n){t.key===e&&(n[c].code="",n[c].name="",n[c].qty=0,n[c].uom="",n[c].price=0,n[c].amount=0,n[c].receiveWh="")}))},d=Object(n["ref"])(!1),l=Object(n["ref"])(""),p=function(){X["a"].warning({title:"请确认",content:"确定要发送当前采购单吗？",onOk:function(){Object(ae["h"])([c.id]).then((function(e){200===e.code&&G["a"].success({message:"成功",description:"发送成功"})})).catch((function(e){G["a"].error({message:"错误",description:e}),console.debug(e)}))},onCancel:function(){}})};return{sysStatus:e,columns:t,purchase:c,purchaseMats:a,editableCols:r,fileList:o,addMat:s,rowDeleteHandler:u,cancelEditHandler:i,rejectReasonVisible:d,send:p,reason:l}},data:function(){return{id:this.$route.query.id,type:this.$route.query.type,supplies:[],supplyContacts:[],supplierId:""}},created:function(){"string"===typeof this.id&&"string"===typeof this.type?(this.getData(this.id,this.type),this.sysStatus="view"):(this.loadTenant(),this.sysStatus="edit")},methods:{loadTenant:function(){var e=this;Object(le["a"])({id:localStorage.getItem("doway_cloud_tenant_id")}).then((function(t){200===t.code&&(e.purchase.demandSide=t.content.name,e.purchase.senderBusinessLicense=t.content.creditCode)})).catch((function(e){G["a"].error({message:"错误",description:e}),console.debug(e)}))},focus:function(){var e=this;de().then((function(t){e.supplies=t.content}))},focusSuplCont:function(){var e=this;ie({supplierId:this.supplierId}).then((function(t){e.supplyContacts=t.content}))},handleSupplierSelect:function(e){var t=this.supplies.find((function(t){return t.id===e}));this.purchase.authorizationCode=t.authorizationCode,this.purchase.businessLicense=t.businessLicense,this.supplierId=e},handleSupplierSearch:function(e){var t=this;t.supplies=[],ue({name:e}).then((function(e){t.supplies=e.content})).catch((function(e){G["a"].error({message:"错误",description:e}),console.debug(e)}))},handleSelect:function(e){var t=this.supplyContacts.find((function(t){return t.id=e}));this.purchase.contacts=t.contacts,this.purchase.tel=null===t.mobile?t.mobile:t.tel},handleSearch:function(e){var t=this;t.supplyContacts=[],ie({supplierId:this.supplierId}).then((function(e){t.supplyContacts=e.content})).catch((function(e){G["a"].error({message:"错误",description:e}),console.debug(e)}))},textFormat:function(e){switch(e){case"saveAsDraft":return"草稿";case"published":return"已发布";case"confirmed":return"已确认";case"rejected":return"已驳回";case"untreated":return"未处理";default:return e}},getData:function(e,t){var c=this;"send"===t?Object(ae["b"])({id:e}).then((function(e){c.purchase.id=e.content.id,c.purchase.orderCode=e.content.orderCode,c.purchase.supplyName=e.content.supplyName,c.purchase.contacts=e.content.contacts,c.purchase.tel=e.content.tel,c.purchase.purDate=e.content.purDate,c.purchase.demandDate=e.content.demandDate,c.purchase.shippingType=e.content.shippingType,c.purchase.demandSide=e.content.demandSide,c.purchase.authorizationCode=e.content.authorizationCode,c.purchase.businessLicense=e.content.businessLicense,c.purchase.senderBusinessLicense=e.content.senderBusinessLicense,c.purchase.status=c.textFormat(e.content.status),c.purchase.currency=e.content.currency,c.purchase.taxRate=e.content.taxRate,c.purchase.payType=e.content.payType,c.purchase.payCondition=e.content.payCondition,c.purchase.invoiceType=e.content.invoiceType,c.purchase.rowVersion=e.content.rowVersion,e.content.purchaseMats.forEach((function(e){c.purchaseMats.push({key:String(c.purchaseMats.length+1),code:e.code,name:e.name,qty:e.qty,uom:e.uom,price:e.price,amount:e.amount,receiveWh:e.receiveWh})}))})).catch((function(e){G["a"].error({message:"错误",description:e}),console.debug(e)})):Object(ae["e"])({id:e}).then((function(e){c.purchase.id=e.content.id,c.purchase.orderCode=e.content.orderCode,c.purchase.supplyName=e.content.supplyName,c.purchase.contacts=e.content.contacts,c.purchase.tel=e.content.tel,c.purchase.purDate=e.content.purDate,c.purchase.demandDate=e.content.demandDate,c.purchase.shippingType=e.content.shippingType,c.purchase.demandSide=e.content.demandSide,c.purchase.authorizationCode=e.content.authorizationCode,c.purchase.businessLicense=e.content.businessLicense,c.purchase.senderBusinessLicense=e.content.senderBusinessLicense,c.purchase.status=c.textFormat(e.content.status),c.purchase.currency=e.content.currency,c.purchase.taxRate=e.content.taxRate,c.purchase.payType=e.content.payType,c.purchase.payCondition=e.content.payCondition,c.purchase.invoiceType=e.content.invoiceType,c.purchase.rowVersion=e.content.rowVersion,e.content.purchaseMatReceiveds.forEach((function(e){c.purchaseMats.push({key:String(c.purchaseMats.length+1),code:e.code,name:e.name,qty:e.qty,uom:e.uom,price:e.price,amount:e.amount,receiveWh:e.receiveWh})}))})).catch((function(e){G["a"].error({message:"错误",description:e}),console.debug(e)}))},importWordConfirm:function(e){var t=e.file,c=new FormData;c.append("file",t),Object(ae["f"])(c).then((function(e){G["a"].success({message:"成功",description:e.msg})})).catch((function(e){G["a"].error({message:"错误",description:e})}))},saveAsDraft:function(){var e=this;e.purchase.purchaseMats=e.purchaseMats;var t=[];t.push(e.purchase),Object(ae["a"])(t).then((function(t){e.sysStatus="view",G["a"].success({message:"成功",description:"添加成功"})})).catch((function(e){G["a"].error({message:"错误",description:e}),console.debug(e)}))},handleReceivedPurchaseOrder:function(e){var t={ids:[this.purchase.id],result:e,reason:this.reason};Object(ae["d"])(t).then((function(e){200===e.code&&G["a"].success({message:"成功",description:"接收成功"})})).catch((function(e){G["a"].error({message:"错误",description:e}),console.debug(e)}))},formatDate:function(e,t){var c=new Date(24*(e-1)*36e5+1);c.setFullYear(c.getFullYear()-70);var n=c.getFullYear()+"",a=c.getMonth()+1+"",r=c.getDate()-1+"";return t&&1===t.length?n+t+a+t+r:n+(Number(a)<10?"0"+a:a)+(Number(r)<10?"0"+r:r)},dateFormat:function(e){return ne()(e).format("YYYY-MM-DD")}}});c("d8a8");pe.render=H,pe.__scopeId="data-v-6ad0d74d";t["default"]=pe},bd7d:function(e,t,c){},d8a8:function(e,t,c){"use strict";c("bd7d")}}]);