(window["webpackJsonp_cloud-ebl-app"]=window["webpackJsonp_cloud-ebl-app"]||[]).push([["views-statement-RecordDtlPage-vue"],{"03ca":function(e,t,n){},1467:function(e,t,n){},1815:function(e,t,n){"use strict";n("b550"),n("d79d")},"1dde":function(e,t,n){var o=n("d039"),a=n("b622"),r=n("2d00"),c=a("species");e.exports=function(e){return r>=51||!o((function(){var t=[],n=t.constructor={};return n[c]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},3049:function(e,t,n){},"3f6c":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n("b32d"),a="http://cloud.dowaysoft.com/Gateway/CenterService/api/v1/tenant";function r(e){return Object(o["a"])({url:a+"/loadById",method:"get",params:e})}},"4de4":function(e,t,n){"use strict";var o=n("23e7"),a=n("b727").filter,r=n("1dde"),c=n("ae40"),i=r("filter"),s=c("filter");o({target:"Array",proto:!0,forced:!i||!s},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},"50ac":function(e,t,n){"use strict";n("b550"),n("d79d")},"5ed4":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return i})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"m",(function(){return f})),n.d(t,"l",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"j",(function(){return p})),n.d(t,"k",(function(){return h})),n.d(t,"b",(function(){return v}));var o=n("b32d"),a="http://cloud.dowaysoft.com/Gateway/EblService/api/v1/statement";function r(e){return Object(o["a"])({url:a+"/loadById",method:"get",params:e})}function c(e){return Object(o["a"])({url:a+"/loadByIdReceived",method:"get",params:e})}function i(){return Object(o["a"])({url:a+"/queryAll",method:"get"})}function s(e){return Object(o["a"])({url:a+"/queryAllByCustId",method:"get",params:e})}function d(){return Object(o["a"])({url:a+"/queryAllReceived",method:"get"})}function u(e){return Object(o["a"])({url:a+"/generateInvoice",method:"post",data:e})}function l(e){return Object(o["a"])({url:a+"/add",method:"post",data:e})}function f(e){return Object(o["a"])({url:a+"/update",method:"post",data:e})}function b(e){return Object(o["a"])({url:a+"/sendStatement",method:"post",data:e})}function m(e){return Object(o["a"])({url:a+"/handleReceivedStatement",method:"post",data:e})}function p(e){return Object(o["a"])({url:a+"/searchByExp",method:"post",data:e})}function h(e){return Object(o["a"])({url:a+"/searchReceivedByExp",method:"post",data:e})}function v(){return Object(o["a"])({url:a+"/autoCreateStatement",method:"get"})}},"74d2":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return i}));var o=n("b32d"),a="http://cloud.dowaysoft.com/Gateway/BaseService/api/v1/customer";function r(e){return Object(o["a"])({url:a+"/loadByName",method:"get",params:e})}function c(e){return Object(o["a"])({url:a+"/queryAllContacts",method:"get",params:e})}function i(){return Object(o["a"])({url:a+"/query",method:"get"})}},"7db0":function(e,t,n){"use strict";var o=n("23e7"),a=n("b727").find,r=n("44d2"),c=n("ae40"),i="find",s=!0,d=c(i);i in[]&&Array(1)[i]((function(){s=!1})),o({target:"Array",proto:!0,forced:s||!d},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),r(i)},8190:function(e,t,n){"use strict";n("90cc")},8418:function(e,t,n){"use strict";var o=n("c04e"),a=n("9bf2"),r=n("5c6c");e.exports=function(e,t,n){var c=o(t);c in e?a.f(e,c,r(0,n)):e[c]=n}},9096:function(e,t,n){"use strict";var o=n("7a23"),a=Object(o["withScopeId"])("data-v-6e02970b");Object(o["pushScopeId"])("data-v-6e02970b");var r={key:0},c={key:1,class:"editable_row_operation"},i={key:0},s={key:1},d=Object(o["createVNode"])("a",null,"删除",-1),u={key:2},l=Object(o["createVNode"])("span",null,"只读状态",-1);Object(o["popScopeId"])();var f=a((function(e,t,n,f,b,m){var p=Object(o["resolveComponent"])("a-input"),h=Object(o["resolveComponent"])("a-popconfirm"),v=Object(o["resolveComponent"])("a-table");return Object(o["openBlock"])(),Object(o["createBlock"])(v,{columns:e.columns,"data-source":e.sourceData,bordered:"","row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},Object(o["createSlots"])({operation:a((function(t){var n=t.record;return[""!==e.destPath?(Object(o["openBlock"])(),Object(o["createBlock"])("div",r,[Object(o["createVNode"])("a",{onClick:function(t){return e.goDtl(n.id)}},"查看详情",8,["onClick"])])):Object(o["createCommentVNode"])("",!0),""===e.destPath&&e.editableCols.length>0?(Object(o["openBlock"])(),Object(o["createBlock"])("div",c,[n.editable?(Object(o["openBlock"])(),Object(o["createBlock"])("span",i,[Object(o["createVNode"])("a",{onClick:function(t){return e.save(n.key)}},"保存",8,["onClick"]),Object(o["createVNode"])("a",{onClick:function(t){return e.cancel(n.key)}},"放弃",8,["onClick"])])):(Object(o["openBlock"])(),Object(o["createBlock"])("span",s,[Object(o["createVNode"])("a",Object(o["mergeProps"])(""!==e.editingKey?{disabled:"disabled"}:{},{onClick:function(t){return e.edit(n.key)}})," 编辑 ",16,["onClick"]),Object(o["createVNode"])(h,Object(o["mergeProps"])(""!==e.editingKey?{disabled:"disabled"}:{},{title:"确定要删除吗？",onConfirm:function(t){return e.onDelete(n.key)}}),{default:a((function(){return[d]})),_:1},16,["onConfirm"])]))])):Object(o["createCommentVNode"])("",!0),""===e.destPath&&0===e.editableCols.length?(Object(o["openBlock"])(),Object(o["createBlock"])("div",u,[l])):Object(o["createCommentVNode"])("",!0)]})),_:2},[Object(o["renderList"])(e.editableCols,(function(t){return{name:t,fn:a((function(n){var a=n.text,r=n.record;return[Object(o["createVNode"])("div",null,[r.editable?(Object(o["openBlock"])(),Object(o["createBlock"])(p,{key:0,style:{width:"100%"},value:a,onChange:function(n){return e.handleChange(n.target.value,r.key,t)}},null,8,["value","onChange"])):(Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],{key:1},[Object(o["createTextVNode"])(Object(o["toDisplayString"])(a),1)],64))])]}))}}))]),1032,["columns","data-source","row-selection"])})),b=(n("4de4"),n("a71a"),n("b558")),m=(n("b550"),n("03ca"),n("e1f5"),n("0464")),p=n("f933"),h=n("f54f"),v=n("4d91"),g=n("daa3"),O=n("b488"),j=n("b92b"),y=n("2db5"),w=n.n(y),V=n("5efb"),k=n("e5cd"),I=n("02ea"),C=n("4df5");function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x=Object(h["a"])(),T=Object(j["a"])(),B={name:"APopconfirm",props:D(D({},x),{},{prefixCls:v["a"].string,transitionName:v["a"].string.def("zoom-big"),content:v["a"].any,title:v["a"].any,trigger:x.trigger.def("click"),okType:T.type.def("primary"),disabled:v["a"].bool.def(!1),okText:v["a"].any,cancelText:v["a"].any,icon:v["a"].any,okButtonProps:v["a"].object,cancelButtonProps:v["a"].object,onConfirm:v["a"].func,onCancel:v["a"].func,onVisibleChange:v["a"].func,"onUpdate:visible":v["a"].func}),mixins:[O["a"]],watch:{visible:function(e){this.sVisible=e}},setup:function(){return{configProvider:Object(o["inject"])("configProvider",C["a"])}},data:function(){var e=Object(g["h"])(this),t={sVisible:!1};return"visible"in e&&(t.sVisible=e.visible),"defaultVisible"in e&&(t.sVisible=e.defaultVisible),t},methods:{onConfirmHandle:function(e){this.setVisible(!1,e),this.$emit("confirm",e)},onCancelHandle:function(e){this.setVisible(!1,e),this.$emit("cancel",e)},onVisibleChangeHandle:function(e){var t=this.$props.disabled;t||this.setVisible(e)},setVisible:function(e,t){Object(g["m"])(this,"visible")||this.setState({sVisible:e}),this.$emit("update:visible",e),this.$emit("visibleChange",e,t)},getPopupDomNode:function(){return this.$refs.tooltip.getPopupDomNode()},renderOverlay:function(e,t){var n=this,a=this.okType,r=this.okButtonProps,c=this.cancelButtonProps,i=Object(g["e"])(this,"icon")||Object(o["createVNode"])(w.a,null,null),s=Object(g["p"])(D({size:"small",onClick:this.onCancelHandle},c)),d=Object(g["p"])(D({type:a,size:"small",onClick:this.onConfirmHandle},r));return Object(o["createVNode"])("div",{class:"".concat(e,"-inner-content")},[Object(o["createVNode"])("div",{class:"".concat(e,"-message")},[i,Object(o["createVNode"])("div",{class:"".concat(e,"-message-title")},[Object(g["e"])(this,"title")])]),Object(o["createVNode"])("div",{class:"".concat(e,"-buttons")},[Object(o["createVNode"])(V["a"],s,{default:function(){return[Object(g["e"])(n,"cancelText")||t.cancelText]}}),Object(o["createVNode"])(V["a"],d,{default:function(){return[Object(g["e"])(n,"okText")||t.okText]}})])])}},render:function(){var e,t=this,n=Object(g["h"])(this),a=n.prefixCls,r=this.configProvider.getPrefixCls,c=r("popover",a),i=Object(m["a"])(n,["title","content","cancelText","okText","onUpdate:visible"]),s=Object(o["createVNode"])(k["a"],{componentName:"Popconfirm",defaultLocale:I["a"].Popconfirm,children:function(e){return t.renderOverlay(c,e)}},null),d=D(D({},i),{},{title:s,prefixCls:c,visible:this.sVisible,ref:"tooltip",onVisibleChange:this.onVisibleChangeHandle});return Object(o["createVNode"])(p["a"],d,{default:function(){return[null===(e=t.$slots)||void 0===e?void 0:e.default()]}})},install:function(e){e.component(B.name,B)}},R=B,P=Object(o["defineComponent"])({props:{columns:{type:Array,default:function(){return[]}},sourceData:{type:Array,default:function(){return[]}},editableCols:{type:Array,default:function(){return[]}},destPath:{type:String,default:function(){return""}},type:{type:String,default:function(){return""}},selectedKeys:{type:String,default:function(){return""}}},components:{"a-popconfirm":R,"a-input":b["a"]},data:function(){return{editingKey:"",selectedRowKeys:[]}},computed:{hasSelected:function(){return this.selectedRowKeys.length>0}},methods:{goDtl:function(e){this.$router.push({path:this.destPath,query:{id:e,type:this.type}})},onSelectChange:function(e,t){this.$emit("selected",t),this.selectedRowKeys=this.selectedKeys},edit:function(e){this.editingKey=e;var t=this.sourceData.filter((function(t){return e===t.key}))[0];t&&(t.editable=!0),this.$emit("rowEdit",t)},save:function(e){this.editingKey="";var t=this.sourceData.filter((function(t){return e===t.key}))[0];t&&delete t.editable},cancel:function(e){this.editingKey&&(this.editingKey=""),this.$emit("cancelEdit",e);var t=this.sourceData.filter((function(t){return e===t.key}))[0];t&&delete t.editable},handleChange:function(e,t,n){var o=this.sourceData.filter((function(e){return t===e.key}))[0];o&&(o[n]=e),this.$emit("rowChange",o)},onDelete:function(e){this.editingKey&&(this.editingKey=""),this.$emit("rowDelete",e)}}});n("9f2a");P.render=f,P.__scopeId="data-v-6e02970b";t["a"]=P},"90cc":function(e,t,n){},"9a63":function(e,t,n){"use strict";var o=n("290c");o["a"].install=function(e){e.component(o["a"].name,o["a"])},t["a"]=o["a"]},"9f2a":function(e,t,n){"use strict";n("1467")},a13b:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"g",(function(){return s})),n.d(t,"j",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"k",(function(){return b})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"l",(function(){return h}));var o=n("b32d"),a="http://cloud.dowaysoft.com/Gateway/EblService/api/v1/delivery";function r(e){return Object(o["a"])({url:a+"/loadById",method:"get",params:e})}function c(e){return Object(o["a"])({url:a+"/loadByIdReceived",method:"get",params:e})}function i(e){return Object(o["a"])({url:a+"/generateStatement",method:"post",data:e})}function s(){return Object(o["a"])({url:a+"/queryAll",method:"get"})}function d(){return Object(o["a"])({url:a+"/searchReceivedDelivery",method:"get"})}function u(e){return Object(o["a"])({url:a+"/adds",method:"post",data:e})}function l(e){return Object(o["a"])({url:a+"/handleReceiveDeliveryOrder",method:"post",data:e})}function f(e){return Object(o["a"])({url:a+"/deliveryImport",method:"post",data:e})}function b(e){return Object(o["a"])({url:a+"/sendDeliveryOrder",method:"post",data:e})}function m(e){return Object(o["a"])({url:a+"/searchByExp",method:"post",data:e})}function p(e){return Object(o["a"])({url:a+"/searchReceivedByExp",method:"post",data:e})}function h(e){return Object(o["a"])({url:a+"/update",method:"post",data:e})}},a434:function(e,t,n){"use strict";var o=n("23e7"),a=n("23cb"),r=n("a691"),c=n("50c4"),i=n("7b0b"),s=n("65f0"),d=n("8418"),u=n("1dde"),l=n("ae40"),f=u("splice"),b=l("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,p=Math.min,h=9007199254740991,v="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!f||!b},{splice:function(e,t){var n,o,u,l,f,b,g=i(this),O=c(g.length),j=a(e,O),y=arguments.length;if(0===y?n=o=0:1===y?(n=0,o=O-j):(n=y-2,o=p(m(r(t),0),O-j)),O+n-o>h)throw TypeError(v);for(u=s(g,o),l=0;l<o;l++)f=j+l,f in g&&d(u,l,g[f]);if(u.length=o,n<o){for(l=j;l<O-o;l++)f=l+o,b=l+n,f in g?g[b]=g[f]:delete g[b];for(l=O;l>O-o+n;l--)delete g[l-1]}else if(n>o)for(l=O-o;l>j;l--)f=l+o-1,b=l+n-1,f in g?g[b]=g[f]:delete g[b];for(l=0;l<n;l++)g[l+j]=arguments[l+2];return g.length=O-o+n,u}})},b0c0:function(e,t,n){var o=n("83ab"),a=n("9bf2").f,r=Function.prototype,c=r.toString,i=/^\s*function ([^ (]*)/,s="name";o&&!(s in r)&&a(r,s,{configurable:!0,get:function(){try{return c.call(this).match(i)[1]}catch(e){return""}}})},e32c:function(e,t,n){"use strict";var o=n("da05");o["b"].install=function(e){e.component(o["b"].name,o["b"])},t["a"]=o["b"]},e5db:function(e,t,n){"use strict";n("3049")},ea45:function(e,t,n){"use strict";n.r(t);n("b0c0");var o=n("7a23"),a=Object(o["withScopeId"])("data-v-637f8f36");Object(o["pushScopeId"])("data-v-637f8f36");var r={class:"header"},c=Object(o["createTextVNode"])("发送"),i=Object(o["createTextVNode"])("作废"),s=Object(o["createTextVNode"])("确认"),d=Object(o["createTextVNode"])("驳回"),u={class:"form"},l=Object(o["createTextVNode"])("基本信息"),f=Object(o["createVNode"])("br",null,null,-1),b=Object(o["createVNode"])("br",null,null,-1),m=Object(o["createVNode"])("br",null,null,-1),p=Object(o["createVNode"])("br",null,null,-1),h=Object(o["createVNode"])("br",null,null,-1),v={class:"table"},g=Object(o["createTextVNode"])("对账详情"),O={style:{height:"475px",overflow:"auto"}};Object(o["popScopeId"])();var j=a((function(e,t,n,j,y,w){var V=Object(o["resolveComponent"])("a-button"),k=Object(o["resolveComponent"])("a-row"),I=Object(o["resolveComponent"])("a-input"),C=Object(o["resolveComponent"])("a-form-item"),S=Object(o["resolveComponent"])("a-select-option"),D=Object(o["resolveComponent"])("a-select"),N=Object(o["resolveComponent"])("a-range-picker"),x=Object(o["resolveComponent"])("a-form"),T=Object(o["resolveComponent"])("a-spin"),B=Object(o["resolveComponent"])("a-col"),R=Object(o["resolveComponent"])("BaseTableEditable"),P=Object(o["resolveComponent"])("a-table"),_=Object(o["resolveComponent"])("a-modal"),L=Object(o["resolveComponent"])("a-textarea");return Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],null,[Object(o["createVNode"])("div",r,[Object(o["withDirectives"])(Object(o["createVNode"])(V,{loading:e.optLoading,style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:e.send},{default:a((function(){return[c]})),_:1},8,["loading","onClick"]),[[o["vShow"],("send"===e.type||void 0!==e.id)&&"草稿"===e.statementInfo.status]]),Object(o["withDirectives"])(Object(o["createVNode"])(V,{loading:e.optLoading,style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:e.invalidStatement},{default:a((function(){return[i]})),_:1},8,["loading","onClick"]),[[o["vShow"],"send"===e.type&&void 0!==e.id&&("草稿"===e.statementInfo.status||"已驳回"===e.statementInfo.status)]]),Object(o["withDirectives"])(Object(o["createVNode"])(V,{loading:e.optLoading,style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[1]||(t[1]=function(t){return e.handleReceivedStatement("adopt")})},{default:a((function(){return[s]})),_:1},8,["loading"]),[[o["vShow"],"receive"===e.type&&void 0!==e.id&&"untreated"===e.delivery.status]]),Object(o["withDirectives"])(Object(o["createVNode"])(V,{loading:e.optLoading,style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[2]||(t[2]=function(t){return e.rejectReasonVisible=!0})},{default:a((function(){return[d]})),_:1},8,["loading"]),[[o["vShow"],"receive"===e.type&&void 0!==e.id&&"untreated"===e.delivery.status]])]),Object(o["createVNode"])(T,{spinning:e.loading},{default:a((function(){return[Object(o["createVNode"])("div",u,[Object(o["createVNode"])(k,{class:"title"},{default:a((function(){return[l]})),_:1}),Object(o["createVNode"])(x,{ref:"statementForm",model:e.statementInfo,rules:e.rules,layout:"inline","label-col":{offset:1,span:5},"wrapper-col":{offset:1,span:17}},{default:a((function(){return[f,Object(o["createVNode"])(C,{label:"对账单号",name:"code","has-feedback":"",style:{width:"31%"}},{default:a((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.statementInfo.code,"onUpdate:value":t[3]||(t[3]=function(t){return e.statementInfo.code=t}),placeholder:"请输入对账单号"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",{class:"spanText"},Object(o["toDisplayString"])(e.statementInfo.code),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(C,{label:"客户名称",name:"custName","has-feedback":"",style:{width:"31%"}},{default:a((function(){return["edit"===e.sysStatus?(Object(o["openBlock"])(),Object(o["createBlock"])(D,{key:0,"show-search":"",value:e.statementInfo.customerId,"onUpdate:value":t[4]||(t[4]=function(t){return e.statementInfo.customerId=t}),placeholder:"请选择客户名称",onFocus:e.focusHandler,style:{width:"100%"},"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",onSearch:e.handleCustomerSearch,onSelect:e.handleCustomerSelect},{default:a((function(){return[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.customers,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])(S,{key:e.id},{default:a((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.name),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])):Object(o["createCommentVNode"])("",!0),Object(o["withDirectives"])(Object(o["createVNode"])("span",{class:"spanText"},Object(o["toDisplayString"])(e.statementInfo.custName),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(C,{label:"时间范围",name:"dateRange","has-feedback":"",style:{width:"31%"}},{default:a((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(N,{style:{width:"100%"},value:e.dateRange,"onUpdate:value":t[5]||(t[5]=function(t){return e.dateRange=t}),onChange:t[6]||(t[6]=function(t){return e.selectDate()})},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",{class:"spanText"},Object(o["toDisplayString"])(e.dateFormat(e.statementInfo.startTime))+"——"+Object(o["toDisplayString"])(e.dateFormat(e.statementInfo.endTime)),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),b,m,Object(o["createVNode"])(C,{label:"对账方",name:"statementParty","has-feedback":"",style:{width:"31%"}},{default:a((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.statementInfo.statementParty,"onUpdate:value":t[7]||(t[7]=function(t){return e.statementInfo.statementParty=t}),placeholder:"请输入对账方名称"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",{class:"spanText"},Object(o["toDisplayString"])(e.statementInfo.statementParty),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(C,{label:"对账金额",name:"amount","has-feedback":"",style:{width:"31%"}},{default:a((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.statementInfo.amount,"onUpdate:value":t[8]||(t[8]=function(t){return e.statementInfo.amount=t}),placeholder:"请输入对账金额",disabled:""},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",{class:"spanText"},Object(o["toDisplayString"])(e.statementInfo.amount),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),p]})),_:1},8,["model","rules"]),h])]})),_:1},8,["spinning"]),Object(o["createVNode"])("div",v,[Object(o["createVNode"])(k,{class:"title"},{default:a((function(){return[Object(o["createVNode"])(B,{span:12,style:{"font-size":"24px"}},{default:a((function(){return[g]})),_:1}),Object(o["createVNode"])(B,{span:12,style:{"text-align":"right"}})]})),_:1}),Object(o["createVNode"])(R,{columns:e.columns,sourceData:e.deliveryInfo,onRowDelete:e.rowDeleteHandler,editableCols:[]},null,8,["columns","sourceData","onRowDelete"])]),Object(o["createVNode"])(_,{visible:e.delShowVisible,"onUpdate:visible":t[9]||(t[9]=function(t){return e.delShowVisible=t}),title:"请选择相应的送货单",centered:"",width:"1080px",closable:!1,"mask-closable":!1,onOk:e.selectDel,okText:"确定",cancelText:"取消"},{default:a((function(){return[Object(o["createVNode"])("div",O,[Object(o["createVNode"])(P,{columns:e.columns,"data-source":e.delDtl,pagination:!1,"row-selection":e.rowSelection},null,8,["columns","data-source","row-selection"])])]})),_:1},8,["visible","onOk"]),Object(o["createVNode"])(_,{visible:e.rejectReasonVisible,"onUpdate:visible":t[11]||(t[11]=function(t){return e.rejectReasonVisible=t}),centered:"",closable:!1,"mask-closable":!1,onOk:t[12]||(t[12]=function(t){return e.handleReceivedStatement("reject")}),okText:"确定",cancelText:"取消"},{default:a((function(){return[Object(o["createVNode"])(L,{value:e.reason,"onUpdate:value":t[10]||(t[10]=function(t){return e.reason=t}),placeholder:"请输入驳回原因",rows:8},null,8,["value"])]})),_:1},8,["visible"])],64)})),y=(n("7db0"),n("4160"),n("a434"),n("d3b7"),n("159b"),n("368b"),n("56cd")),w=(n("04f3"),n("ed3b")),V=(n("1815"),n("e32c")),k=(n("50ac"),n("9a63")),I=(n("e1f5"),n("5efb")),C=n("9096"),S=n("5f70"),D=n.n(S),N=n("5ed4"),x=n("a13b"),T=n("74d2"),B=n("3f6c"),R=Object(o["defineComponent"])({components:{"a-button":I["a"],"a-row":k["a"],"a-col":V["a"],"a-modal":w["a"],BaseTableEditable:C["a"]},setup:function(){var e=Object(o["ref"])("view"),t=Object(o["ref"])(!1),n=Object(o["ref"])(!1),a=Object(o["reactive"])([{title:"序号",dataIndex:"key",key:"key",width:70},{title:"装运单号",dataIndex:"code",key:"code",slots:{customRender:"code"}},{title:"订单日期",dataIndex:"orderDate",key:"orderDate",ellipsis:!0,slots:{customRender:"orderDate"}},{title:"送货日期",dataIndex:"deliveryDate",key:"deliveryDate",ellipsis:!0,slots:{customRender:"deliveryDate"}},{title:"总重量",dataIndex:"totalWeight",key:"totalWeight",ellipsis:!0,slots:{customRender:"totalWeight"}},{title:"总体积",dataIndex:"totalVol",key:"totalVol",ellipsis:!0,slots:{customRender:"totalVol"}},{title:"路线",dataIndex:"route",key:"route",ellipsis:!0,slots:{customRender:"route"}},{title:"运输方式",dataIndex:"shippingType",key:"shippingType",ellipsis:!0,slots:{customRender:"shippingType"}},{title:"客户名称",dataIndex:"shipTo",key:"shipTo",ellipsis:!0,slots:{customRender:"shipTo"}},{title:"联系人",dataIndex:"contacts",key:"contacts",ellipsis:!0,slots:{customRender:"contacts"}},{title:"联系方式",dataIndex:"tel",key:"tel",ellipsis:!0,slots:{customRender:"tel"}},{title:"收货地址",dataIndex:"address",key:"address",ellipsis:!0,slots:{customRender:"address"}},{title:"操作",dataIndex:"operation",key:"operation",slots:{customRender:"operation"}}]),r=Object(o["reactive"])({id:"",code:"",custName:void 0,customerId:void 0,startTime:D()(),endTime:D()(),statementParty:"",amount:0,received:0,unreceived:0,authorizationCode:"",businessLicense:"",senderBusinessLicense:"",status:"draft",rowVersion:"",deliveries:[]}),c=Object(o["reactive"])([]),i=function(e,t,n){return null===t?Promise.reject(e.message):Promise.resolve()},s=Object(o["reactive"])({code:[{required:!0,message:"对账单号不能为空",trigger:"blur"}],custName:[{required:!0,message:"客户名称不能为空",trigger:"blur"}],statementParty:[{required:!0,message:"对账方名称不能为空",trigger:"blur"}],dateRange:[{validator:i,message:"请选择时间范围",trigger:"blur"}],amount:[{required:!0,message:"对账金额不能为空",trigger:"blur"},{pattern:/^0{1}(\.([1-9][0-9]?|[0-9][1-9])){1}$|^[1-9]+(\.\d{1,2})?$/,required:!0,message:"请输入正确的对账金额",trigger:"blur"}]}),d=Object(o["ref"])(!1),u=Object(o["reactive"])([]),l=function(){d.value=!0,Object(x["g"])().then((function(e){e.content.forEach((function(e){u.push({key:String(u.length+1),id:e.id,code:e.code,orderDate:e.orderDate,deliveryDate:e.deliveryDate,totalWeight:e.totalWeight,totalVol:e.totalVol,route:e.route,shippingType:e.shippingType,shipTo:e.shipTo,contacts:e.contacts,tel:e.tel,address:e.address,rowVersion:e.rowVersion,amount:e.amount})}))})).catch((function(e){y["a"].error({message:"错误",description:e}),console.debug(e)}))},f=Object(o["reactive"])([]),b=[],m=Object(o["reactive"])({onChange:function(e,t){void 0!==t&&(b=t)}}),p=function(){d.value=!1,f=b,f.forEach((function(e){c.push({key:String(c.length+1),id:e.id,code:e.code,orderDate:e.orderDate,deliveryDate:e.deliveryDate,totalWeight:e.totalWeight,totalVol:e.totalVol,route:e.route,shippingType:e.shippingType,shipTo:e.shipTo,contacts:e.contacts,tel:e.tel,address:e.address,rowVersion:e.rowVersion,amount:e.amount}),r.amount+=e.amount}))},h=Object(o["ref"])([r.startTime,r.endTime]),v=Object(o["ref"])(!1),g=Object(o["ref"])(""),O=function(){""===r.businessLicense?y["a"].error({message:"错误",description:"未填写客户信用代码，无法识别当前客户，请完善客户信息，并重新选取客户"}):""===r.authorizationCode?y["a"].error({message:"错误",description:"当前所选客户还不是您的合作伙伴"}):w["a"].confirm({title:"请确认",content:"确定要发送当前送货单吗？",cancelText:"取消",okText:"确认",onOk:function(){t.value=!0,Object(N["l"])([r.id]).then((function(e){200===e.code&&y["a"].success({message:"成功",description:"发送成功"})})).catch((function(e){y["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){t.value=!1}))}})},j=function(e){c.forEach((function(t,n,o){t.key===e&&o.splice(n,1)}))},V=function(){r.status="invalid",t.value=!0,Object(N["m"])(r).then((function(e){200===e.code&&y["a"].success({message:"成功",description:"操作成功"})})).catch((function(e){y["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){t.value=!1}))};return{sysStatus:e,optLoading:t,columns:a,statementInfo:r,deliveryInfo:c,delShowVisible:d,delDtl:u,showDelModal:l,chooseInfo:f,rowSelection:m,selectDel:p,dateRange:h,rejectReasonVisible:v,reason:g,send:O,rowDeleteHandler:j,rules:s,invalidStatement:V,loading:n}},data:function(){return{type:this.$route.query.type,id:this.$route.query.id,customers:[]}},created:function(){"string"===typeof this.id&&"string"===typeof this.type?(this.getData(this.id,this.type),this.sysStatus="view"):(this.loadTenant(),this.sysStatus="edit")},methods:{getData:function(e,t){var n=this;"send"===t?(n.loading=!0,Object(N["d"])({id:e}).then((function(e){n.statementInfo.id=e.content.id,n.statementInfo.code=e.content.code,n.statementInfo.custName=e.content.custName,n.statementInfo.customerId=e.content.customerId,n.statementInfo.startTime=e.content.startTime,n.statementInfo.endTime=e.content.endTime,n.statementInfo.statementParty=e.content.statementParty,n.statementInfo.amount=e.content.amount,n.statementInfo.authorizationCode=e.content.authorizationCode,n.statementInfo.businessLicense=e.content.businessLicense,n.statementInfo.senderBusinessLicense=e.content.senderBusinessLicense,n.statementInfo.status=n.textFormat(e.content.status),n.statementInfo.rowVersion=e.content.rowVersion,e.content.deliveries.forEach((function(e){n.deliveryInfo.push({key:String(n.statementInfo.deliveries.length+1),id:e.id,code:e.code,orderDate:e.orderDate,deliveryDate:e.deliveryDate,totalWeight:e.totalWeight,totalVol:e.totalVol,route:e.route,shippingType:e.shippingType,shipTo:e.shipTo,contacts:e.contacts,tel:e.tel,address:e.address,rowVersion:e.rowVersion,amount:e.amount})}))})).catch((function(e){y["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){n.loading=!1}))):(n.loading=!0,Object(N["f"])({id:e}).then((function(e){n.statementInfo.id=e.content.id,n.statementInfo.code=e.content.code,n.statementInfo.custName=e.content.custName,n.statementInfo.customerId=e.content.customerId,n.statementInfo.startTime=e.content.startTime,n.statementInfo.endTime=e.content.endTime,n.statementInfo.statementParty=e.content.statementParty,n.statementInfo.amount=e.content.amount,n.statementInfo.authorizationCode=e.content.authorizationCode,n.statementInfo.businessLicense=e.content.businessLicense,n.statementInfo.senderBusinessLicense=e.content.senderBusinessLicense,n.statementInfo.status=n.textFormat(e.content.status),n.statementInfo.rowVersion=e.content.rowVersion,e.content.deliveryReceiveds.forEach((function(e){n.deliveryInfo.push({key:String(n.deliveryInfo.length+1),id:e.id,code:e.code,orderDate:e.orderDate,deliveryDate:e.deliveryDate,totalWeight:e.totalWeight,totalVol:e.totalVol,route:e.route,shippingType:e.shippingType,shipTo:e.shipTo,contacts:e.contacts,tel:e.tel,address:e.address,rowVersion:e.rowVersion,amount:e.amount})}))})).catch((function(e){y["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){n.loading=!1})))},loadTenant:function(){var e=this;e.loading=!0,Object(B["a"])({id:localStorage.getItem("doway_cloud_tenant_id")}).then((function(t){200===t.code&&(e.statementInfo.senderBusinessLicense=t.content.creditCode)})).catch((function(e){y["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){e.loading=!1}))},focusHandler:function(){var e=this;Object(T["b"])().then((function(t){e.customers=t.content}))},handleCustomerSelect:function(e){var t=this.customers.find((function(t){return t.id===e}));this.statementInfo.custName=t.name,this.statementInfo.authorizationCode=t.authorizationCode,this.statementInfo.businessLicense=t.businessLicense},handleCustomerSearch:function(e){var t=this;t.customers=[],Object(T["a"])({name:e}).then((function(e){t.customers=e.content})).catch((function(e){y["a"].error({message:"错误",description:e}),console.debug(e)}))},cancelEdit:function(){"string"===typeof this.id?this.sysStatus="view":this.$router.push({path:"/statementRecord"})},saveHandler:function(){var e=this;e.statementInfo.deliveries=e.deliveryInfo;var t=e.$refs.statementForm;t.validate().then((function(){e.loading=!0,void 0!==e.id?Object(N["m"])(e.statementInfo).then((function(t){e.sysStatus="view","200"===t.code&&y["a"].success({message:"成功",description:"保存成功"})})).catch((function(e){y["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){e.loading=!1})):Object(N["a"])(e.statementInfo).then((function(t){e.sysStatus="view","200"===t.code&&(e.id=t.content,y["a"].success({message:"成功",description:"保存成功"}))})).catch((function(e){y["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){e.loading=!1}))})).catch((function(e){console.debug(e)}))},handleReceivedStatement:function(e){var t=this,n={ids:[t.statementInfo.id],result:e,reason:t.reason};t.optLoading=!0,Object(N["e"])(n).then((function(e){t.getData(String(t.id),String(t.type)),t.rejectReasonVisible=!1,200===e.code&&y["a"].success({message:"成功",description:"已处理"})})).catch((function(e){y["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){t.optLoading=!1}))},textFormat:function(e){switch(e){case"draft":return"草稿";case"published":return"已发布";case"confirmed":return"已确认";case"rejected":return"已驳回";case"untreated":return"未处理";case"invalid":return"已作废";default:return e}},dateFormat:function(e){return D()(e).format("YYYY-MM-DD")},selectDate:function(){this.statementInfo.startTime=this.dateRange[0],this.statementInfo.endTime=this.dateRange[1]}}});n("8190"),n("e5db");R.render=j,R.__scopeId="data-v-637f8f36";t["default"]=R}}]);