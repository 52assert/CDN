(window["webpackJsonp_cloud-ebl-app"]=window["webpackJsonp_cloud-ebl-app"]||[]).push([["views-delivery-RecordDtlPage-vue"],{"01c8":function(e,t,n){},"03ca":function(e,t,n){},1467:function(e,t,n){},"1ce7":function(e,t,n){"use strict";n("bbb4")},"1dde":function(e,t,n){var o=n("d039"),r=n("b622"),i=n("2d00"),c=r("species");e.exports=function(e){return i>=51||!o((function(){var t=[],n=t.constructor={};return n[c]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"3e9c":function(e,t,n){"use strict";n("01c8")},"3f6c":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n("b32d"),r="http://cloud.dowaysoft.com/Gateway/CenterService/api/v1/tenant";function i(e){return Object(o["a"])({url:r+"/loadById",method:"get",params:e})}},"4de4":function(e,t,n){"use strict";var o=n("23e7"),r=n("b727").filter,i=n("1dde"),c=n("ae40"),a=i("filter"),l=c("filter");o({target:"Array",proto:!0,forced:!a||!l},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"74d2":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return a}));var o=n("b32d"),r="http://cloud.dowaysoft.com/Gateway/BaseService/api/v1/customer";function i(e){return Object(o["a"])({url:r+"/loadByName",method:"get",params:e})}function c(e){return Object(o["a"])({url:r+"/queryAllContacts",method:"get",params:e})}function a(){return Object(o["a"])({url:r+"/query",method:"get"})}},"7c49":function(e,t,n){"use strict";n.r(t);n("b0c0");var o=n("7a23"),r=Object(o["withScopeId"])("data-v-2af940a2");Object(o["pushScopeId"])("data-v-2af940a2");var i={class:"header"},c=Object(o["createTextVNode"])("发送"),a=Object(o["createTextVNode"])("作废"),l=Object(o["createTextVNode"])("保存为草稿"),s=Object(o["createTextVNode"])("确认"),d=Object(o["createTextVNode"])("驳回"),u={style:{float:"right","text-align":"center"}},b=Object(o["createVNode"])("a",{href:"http://cloud.dowaycn.com/Gateway/EblService/api/v1/delivery/deliveryDown"},"下载模板",-1),f=Object(o["createTextVNode"])("上传文件"),v={class:"info"},p={class:"box"},h=Object(o["createVNode"])("span",{class:"title"},"基本信息",-1),y=Object(o["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1),m={key:1},O={key:1},j=Object(o["createVNode"])("br",null,null,-1),g=Object(o["createVNode"])("br",null,null,-1),w=Object(o["createVNode"])("br",null,null,-1),k=Object(o["createVNode"])("br",null,null,-1),V={class:"box"},C=Object(o["createVNode"])("span",{class:"title"},"送货信息",-1),S=Object(o["createTextVNode"])(" 添加明细 "),D=Object(o["createVNode"])("hr",{style:{border:"0",background:"#dadada",height:"1px"}},null,-1);Object(o["popScopeId"])();var N=r((function(e,t,n,N,x,T){var B=Object(o["resolveComponent"])("a-button"),_=Object(o["resolveComponent"])("a-upload"),I=Object(o["resolveComponent"])("a-input"),P=Object(o["resolveComponent"])("a-form-item"),R=Object(o["resolveComponent"])("a-date-picker"),q=Object(o["resolveComponent"])("a-select-option"),L=Object(o["resolveComponent"])("a-select"),E=Object(o["resolveComponent"])("a-form"),F=Object(o["resolveComponent"])("BaseTableEditable"),U=Object(o["resolveComponent"])("a-spin"),M=Object(o["resolveComponent"])("a-textarea"),K=Object(o["resolveComponent"])("a-modal");return Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],null,[Object(o["createVNode"])("div",i,[Object(o["withDirectives"])(Object(o["createVNode"])(B,{loading:e.optLoading,style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:e.send},{default:r((function(){return[c]})),_:1},8,["loading","onClick"]),[[o["vShow"],"send"===e.type&&void 0!==e.id&&"草稿"===e.delivery.status]]),Object(o["withDirectives"])(Object(o["createVNode"])(B,{loading:e.optLoading,style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:e.invalidDelivery},{default:r((function(){return[a]})),_:1},8,["loading","onClick"]),[[o["vShow"],"send"===e.type&&void 0!==e.id&&("草稿"===e.delivery.status||"已驳回"===e.delivery.status)]]),Object(o["withDirectives"])(Object(o["createVNode"])(B,{style:{color:"#5259e5",border:"1px solid #5259e5"},onClick:e.saveAsDraft},{default:r((function(){return[l]})),_:1},8,["onClick"]),[[o["vShow"],void 0===e.id]]),Object(o["withDirectives"])(Object(o["createVNode"])(B,{loading:e.optLoading,style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[1]||(t[1]=function(t){return e.handleReceivedDeliveryOrder("adopt")})},{default:r((function(){return[s]})),_:1},8,["loading"]),[[o["vShow"],"receive"===e.type&&void 0!==e.id&&"untreated"===e.delivery.status]]),Object(o["withDirectives"])(Object(o["createVNode"])(B,{loading:e.optLoading,style:{background:"#5259e5",border:"0px",color:"#fff",margin:"0px 10px"},onClick:t[2]||(t[2]=function(t){return e.rejectReasonVisible=!0})},{default:r((function(){return[d]})),_:1},8,["loading"]),[[o["vShow"],"receive"===e.type&&void 0!==e.id&&"untreated"===e.statementInfo.status]]),Object(o["createVNode"])("div",u,[Object(o["withDirectives"])(Object(o["createVNode"])(B,{style:{"margin-right":"10px"}},{default:r((function(){return[b]})),_:1},512),[[o["vShow"],void 0===e.id]]),Object(o["withDirectives"])(Object(o["createVNode"])(_,{ref:"upload",action:"",multiple:!0,"file-list":e.fileList,"auto-upload":!1,limit:1,customRequest:e.importWordConfirm},{default:r((function(){return[Object(o["createVNode"])(B,{style:{color:"#5259e5",border:"1px solid #5259e5"}},{default:r((function(){return[f]})),_:1})]})),_:1},8,["file-list","customRequest"]),[[o["vShow"],void 0===e.id]])])]),Object(o["createVNode"])(U,{spinning:e.loading},{default:r((function(){return[Object(o["createVNode"])("div",v,[Object(o["createVNode"])("div",p,[h,Object(o["withDirectives"])(Object(o["createVNode"])("span",{style:{float:"right","font-size":"16px","font-family":"PingFang SC"}},"确认时间:"+Object(o["toDisplayString"])(e.delivery.confirmTime),513),[[o["vShow"],null!=e.delivery.confirmTime&&""!=e.delivery.confirmTime||void 0!=e.delivery.confirmTime]]),y,Object(o["createVNode"])(E,{ref:"deliveryForm",model:e.delivery,rules:e.rules,layout:"inline","label-col":{offset:1,span:5},"wrapper-col":{offset:1,span:17}},{default:r((function(){return[Object(o["createVNode"])(P,{label:"送货单号",name:"code","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.delivery.code,"onUpdate:value":t[3]||(t[3]=function(t){return e.delivery.code=t}),placeholder:"请输入送货单号"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.code),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(P,{label:"订单日期",name:"orderDate","has-feedback":"",style:{width:"31%"}},{default:r((function(){return["edit"===e.sysStatus?(Object(o["openBlock"])(),Object(o["createBlock"])(R,{key:0,placeholder:"请选择日期",value:e.delivery.orderDate,"onUpdate:value":t[4]||(t[4]=function(t){return e.delivery.orderDate=t}),style:{width:"100%"}},null,8,["value"])):Object(o["createCommentVNode"])("",!0),"view"===e.sysStatus?(Object(o["openBlock"])(),Object(o["createBlock"])("span",m,Object(o["toDisplayString"])(e.dateFormat(e.delivery.orderDate)),1)):Object(o["createCommentVNode"])("",!0)]})),_:1}),Object(o["createVNode"])(P,{label:"送货日期",name:"deliveryDate","has-feedback":"",style:{width:"31%"}},{default:r((function(){return["edit"===e.sysStatus?(Object(o["openBlock"])(),Object(o["createBlock"])(R,{key:0,placeholder:"请选择日期",value:e.delivery.deliveryDate,"onUpdate:value":t[5]||(t[5]=function(t){return e.delivery.deliveryDate=t}),style:{width:"100%"}},null,8,["value"])):Object(o["createCommentVNode"])("",!0),"view"===e.sysStatus?(Object(o["openBlock"])(),Object(o["createBlock"])("span",O,Object(o["toDisplayString"])(e.dateFormat(e.delivery.deliveryDate)),1)):Object(o["createCommentVNode"])("",!0)]})),_:1}),Object(o["createVNode"])(P,{label:"总重量",name:"totalWeight","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.delivery.totalWeight,"onUpdate:value":t[6]||(t[6]=function(t){return e.delivery.totalWeight=t}),placeholder:"请输入总重量"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.totalWeight),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(P,{label:"总体积",name:"totalVol","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.delivery.totalVol,"onUpdate:value":t[7]||(t[7]=function(t){return e.delivery.totalVol=t}),placeholder:"请输入总体积"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.totalVol),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(P,{label:"运输方式",name:"shippingType","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.delivery.shippingType,"onUpdate:value":t[8]||(t[8]=function(t){return e.delivery.shippingType=t}),placeholder:"请输入运输方式"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.shippingType),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),j,g,Object(o["createVNode"])(P,{label:"收货方",name:"shipTo","has-feedback":"",style:{width:"31%"}},{default:r((function(){return["edit"===e.sysStatus?(Object(o["openBlock"])(),Object(o["createBlock"])(L,{key:0,"show-search":"",value:e.delivery.shipTo,"onUpdate:value":t[9]||(t[9]=function(t){return e.delivery.shipTo=t}),placeholder:"请选择收货方",onFocus:e.focusHandler,style:{width:"100%"},"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",onSearch:e.handleCustomerSearch,onSelect:e.handleCustomerSelect},{default:r((function(){return[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.customers,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])(q,{key:e.id},{default:r((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.name),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])):Object(o["createCommentVNode"])("",!0),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.shipTo),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(P,{label:"收货联系人",name:"contacts",required:"","has-feedback":"",style:{width:"31%"}},{default:r((function(){return["edit"===e.sysStatus?(Object(o["openBlock"])(),Object(o["createBlock"])(L,{key:0,"show-search":"",value:e.delivery.contacts,"onUpdate:value":t[10]||(t[10]=function(t){return e.delivery.contacts=t}),placeholder:"请选择收货联系人",onFocus:e.focusDeliCont,style:{width:"100%"},"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":"无匹配项",onSearch:e.handleSearch,onSelect:e.handleSelect},{default:r((function(){return[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.customerContacts,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])(q,{key:e.id},{default:r((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.contacts),1)]})),_:2},1024)})),128))]})),_:1},8,["value","onFocus","onSearch","onSelect"])):Object(o["createCommentVNode"])("",!0),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.contacts),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(P,{label:"联系方式",name:"tel","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.delivery.tel,"onUpdate:value":t[11]||(t[11]=function(t){return e.delivery.tel=t}),placeholder:"请输入联系方式"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.tel),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(P,{label:"收货地址",name:"address","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.delivery.address,"onUpdate:value":t[12]||(t[12]=function(t){return e.delivery.address=t}),placeholder:"请输入收货地址"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.address),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),w,k,Object(o["createVNode"])(P,{label:"送货方",name:"shipper","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.delivery.shipper,"onUpdate:value":t[13]||(t[13]=function(t){return e.delivery.shipper=t}),placeholder:"请输入送货方名称"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.shipper),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(P,{label:"送货联系人",name:"shipperTel","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.delivery.shipperTel,"onUpdate:value":t[14]||(t[14]=function(t){return e.delivery.shipperTel=t}),placeholder:"请输入送货联系人"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.shipperTel),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(P,{label:"路线",name:"route","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.delivery.route,"onUpdate:value":t[15]||(t[15]=function(t){return e.delivery.route=t}),placeholder:"请输入路线"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.route),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1}),Object(o["createVNode"])(P,{label:"送货金额",name:"amount","has-feedback":"",style:{width:"31%"}},{default:r((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])(I,{value:e.delivery.amount,"onUpdate:value":t[16]||(t[16]=function(t){return e.delivery.amount=t}),placeholder:"请输入送货金额"},null,8,["value"]),[[o["vShow"],"edit"===e.sysStatus]]),Object(o["withDirectives"])(Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(e.delivery.amount),513),[[o["vShow"],"view"===e.sysStatus]])]})),_:1})]})),_:1},8,["model","rules"])]),Object(o["createVNode"])("div",V,[C,Object(o["withDirectives"])(Object(o["createVNode"])(B,{style:{float:"right",color:"#5259e5",border:"1px solid #5259e5"},onClick:e.addDeliveryDtl},{default:r((function(){return[S]})),_:1},8,["onClick"]),[[o["vShow"],void 0===e.id]]),D,Object(o["createVNode"])(F,{columns:e.columns,sourceData:e.deliveryMats,editableCols:void 0===e.id&&"edit"===e.sysStatus?e.editableCols:[],onRowEdit:e.rowEditHandler,onCancelEdit:e.cancelEditHandler,onRowDelete:e.rowDeleteHandler},null,8,["columns","sourceData","editableCols","onRowEdit","onCancelEdit","onRowDelete"])])])]})),_:1},8,["spinning"]),Object(o["createVNode"])(K,{visible:e.rejectReasonVisible,"onUpdate:visible":t[18]||(t[18]=function(t){return e.rejectReasonVisible=t}),centered:"",closable:!1,"mask-closable":!1,onOk:t[19]||(t[19]=function(t){return e.handleReceivedDeliveryOrder("reject")}),okText:"确定",cancelText:"取消"},{default:r((function(){return[Object(o["createVNode"])(M,{value:e.reason,"onUpdate:value":t[17]||(t[17]=function(t){return e.reason=t}),placeholder:"请输入驳回原因",rows:8},null,8,["value"])]})),_:1},8,["visible"])],64)})),x=(n("7db0"),n("4160"),n("a434"),n("d3b7"),n("159b"),n("368b"),n("56cd")),T=(n("7a59"),n("39ab")),B=(n("519e"),n("0bb7")),_=(n("04f3"),n("ed3b")),I=(n("e1f5"),n("5efb")),P=n("c1df"),R=n.n(P),q=n("a13b"),L=n("74d2"),E=n("9096"),F=n("3f6c"),U=Object(o["defineComponent"])({components:{"a-button":I["a"],"a-modal":_["a"],"a-date-picker":B["a"],"a-upload":T["a"],BaseTableEditable:E["a"]},setup:function(){var e=Object(o["ref"])("view"),t=Object(o["ref"])(!1),n=Object(o["ref"])(!1),r=Object(o["reactive"])([{title:"序号",dataIndex:"key",key:"key",slots:{customRender:"key"},width:70},{title:"物料编码",dataIndex:"code",key:"code",slots:{customRender:"code"}},{title:"规格型号",dataIndex:"name",key:"name",slots:{customRender:"name"}},{title:"送货数量",dataIndex:"qty",key:"qty",ellipsis:!0,slots:{customRender:"qty"}},{title:"送货金额",dataIndex:"amount",key:"amount",ellipsis:!0,slots:{customRender:"amount"}},{title:"销售单号",dataIndex:"salesCode",key:"salesCode",ellipsis:!0,slots:{customRender:"salesCode"}},{title:"行体积",dataIndex:"vol",key:"vol",ellipsis:!0,slots:{customRender:"vol"}},{title:"操作",dataIndex:"operation",key:"operation",slots:{customRender:"operation"}}]),i=Object(o["reactive"])({id:"",code:"",shipTo:void 0,customerId:"",shipper:"",orderDate:R()(),contacts:void 0,deliveryDate:R()(),tel:"",route:"",totalWeight:"",address:"",shippingType:"",shipperTel:"",totalVol:"",status:"draft",amount:"",authorizationCode:"",businessLicense:"",senderBusinessLicense:"",rowVersion:"",confirmTime:void 0,deliveryMats:[]}),c=function(e,t,n){return null===t?Promise.reject(e.message):Promise.resolve()},a=Object(o["reactive"])({code:[{required:!0,message:"送货单号不能为空",trigger:"blur"}],shipTo:[{required:!0,message:"客户名称不能为空",trigger:"blur"}],shipper:[{required:!0,message:"送货方不能为空",trigger:"blur"}],contacts:[{required:!0,message:"客户联系人不能为空",trigger:"blur"}],amount:[{required:!0,message:"送货金额不能为空",trigger:"blur"}],address:[{required:!0,message:"收货地址不能为空",trigger:"blur"}],tel:[{required:!0,message:"联系方式不能为空",trigger:"blur"}],shipperTel:[{required:!0,message:"送货联系人不能为空",trigger:"blur"}],deliveryDate:[{validator:c,message:"送货日期不能为空",trigger:"blur"},{validator:c,message:"送货日期不能为空",trigger:"change"}]}),l=Object(o["reactive"])([]),s=["code","name","qty","amount","salesCode","vol"],d=Object(o["ref"])([]),u=function(){l.push({key:String(l.length+1),id:"",code:"",name:"",qty:"",amount:"",salesCode:"",purCode:"",vol:"",deliveryId:"",editable:!0})},b=Object(o["reactive"])({key:"",id:"",code:"",name:"",qty:"",amount:"",salesCode:"",purCode:"",vol:"",deliveryId:""}),f=function(e){b.code=e.code,b.name=e.name,b.qty=e.qty,b.salesCode=e.salesCode},v=function(e){l.forEach((function(t,n,o){t.key===e&&(o[n].code=b.code,o[n].name=b.name,o[n].salesCode=b.salesCode)}))},p=function(e){l.forEach((function(t,n,o){t.key===e&&o.splice(n,1)}))},h=Object(o["ref"])(!1),y=Object(o["ref"])(""),m=function(){""===i.businessLicense?x["a"].error({message:"错误",description:"未填写客户信用代码，无法识别当前客户，请完善客户信息，并重新选取客户"}):""===i.authorizationCode?x["a"].error({message:"错误",description:"当前所选客户还不是您的合作伙伴"}):_["a"].confirm({title:"请确认",content:"确定要发送当前送货单吗？",cancelText:"取消",okText:"确认",onOk:function(){t.value=!0,Object(q["k"])([i.id]).then((function(e){200===e.code&&x["a"].success({message:"成功",description:"发送成功"})})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){t.value=!1}))}})},O=function(){i.status="invalid",t.value=!0,Object(q["l"])(i).then((function(e){200===e.code&&x["a"].success({message:"成功",description:"操作成功"})})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){t.value=!1}))};return{sysStatus:e,optLoading:t,loading:n,columns:r,delivery:i,deliveryMats:l,editableCols:s,fileList:d,addDeliveryDtl:u,rowEditHandler:f,cancelEditHandler:v,rowDeleteHandler:p,rejectReasonVisible:h,send:m,reason:y,rules:a,invalidDelivery:O}},data:function(){return{id:this.$route.query.id,type:this.$route.query.type,customers:[],customerContacts:[],customerId:""}},created:function(){"string"===typeof this.id&&"string"===typeof this.type?(this.getData(this.id,this.type),this.sysStatus="view"):(this.loadTenant(),this.sysStatus="edit")},methods:{getData:function(e,t){var n=this;"send"===t?(n.loading=!0,Object(q["d"])({id:e}).then((function(e){n.delivery.id=e.content.id,n.delivery.code=e.content.code,n.delivery.shipTo=e.content.shipTo,n.delivery.customerId=e.content.customerId,n.delivery.shipper=e.content.shipper,n.delivery.shipperTel=e.content.shipperTel,n.delivery.orderDate=e.content.orderDate,n.delivery.contacts=e.content.contacts,n.delivery.deliveryDate=e.content.deliveryDate,n.delivery.tel=e.content.tel,n.delivery.route=e.content.route,n.delivery.totalWeight=e.content.totalWeight,n.delivery.address=e.content.address,n.delivery.shippingType=e.content.shippingType,n.delivery.totalVol=e.content.totalVol,n.delivery.amount=e.content.amount,n.delivery.status=n.textFormat(e.content.status),n.delivery.authorizationCode=e.content.authorizationCode,n.delivery.businessLicense=e.content.businessLicense,n.delivery.senderBusinessLicense=e.content.senderBusinessLicense,n.delivery.rowVersion=e.content.rowVersion,n.delivery.confirmTime=e.content.confirmTime,e.content.deliveryMats.forEach((function(e){n.deliveryMats.push({key:String(n.deliveryMats.length+1),id:e.code,code:e.code,name:e.name,qty:e.qty,amount:e.amount,salesCode:e.salesCode,purCode:e.purCode,vol:e.purCode,deliveryId:e.deliveryId})}))})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){n.loading=!1}))):(n.loading=!0,Object(q["f"])({id:e}).then((function(e){n.delivery.id=e.content.id,n.delivery.code=e.content.code,n.delivery.shipTo=e.content.shipTo,n.delivery.customerId=e.content.customerId,n.delivery.shipper=e.content.shipper,n.delivery.orderDate=e.content.orderDate,n.delivery.contacts=e.content.contacts,n.delivery.deliveryDate=e.content.deliveryDate,n.delivery.tel=e.content.tel,n.delivery.route=e.content.route,n.delivery.totalWeight=e.content.totalWeight,n.delivery.address=e.content.address,n.delivery.shippingType=e.content.shippingType,n.delivery.totalVol=e.content.totalVol,n.delivery.amount=e.content.amount,n.delivery.status=n.textFormat(e.content.status),n.delivery.authorizationCode=e.content.authorizationCode,n.delivery.businessLicense=e.content.businessLicense,n.delivery.senderBusinessLicense=e.content.senderBusinessLicense,n.delivery.rowVersion=e.content.rowVersion,n.delivery.confirmTime=e.content.confirmTime,e.content.deliveryMats.forEach((function(e){n.deliveryMats.push({key:String(n.deliveryMats.length+1),id:e.code,code:e.code,name:e.name,qty:e.qty,amount:e.amount,salesCode:e.salesCode,purCode:e.purCode,vol:e.purCode,deliveryId:e.deliveryId})}))})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){n.loading=!1})))},loadTenant:function(){var e=this;e.loading=!0,Object(F["a"])({id:localStorage.getItem("doway_cloud_tenant_id")}).then((function(t){200===t.code&&(e.delivery.senderBusinessLicense=t.content.creditCode,e.delivery.shipper=t.content.name,e.delivery.shipperTel=t.content.director)})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){e.loading=!1}))},focusHandler:function(){var e=this;Object(L["b"])().then((function(t){e.customers=t.content})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)}))},focusDeliCont:function(){var e=this;e.customerId?Object(L["c"])({customerId:e.customerId}).then((function(t){e.customerContacts=t.content})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)})):x["a"].warning({message:"警告",description:"当前客户信息缺失，请先选择客户"})},handleCustomerSelect:function(e){this.customerId=e;var t=this.customers.find((function(t){return t.id===e}));this.delivery.shipTo=t.name,this.delivery.customerId=t.id,this.delivery.address=t.address,this.delivery.businessLicense=t.businessLicense,t.authorizationCode||x["a"].warning({message:"警告",description:"未检测到与所选客户的交易关系，请到客户信息页检查"}),this.delivery.authorizationCode=t.authorizationCode},handleCustomerSearch:function(e){var t=this;t.customers=[],Object(L["a"])({name:e}).then((function(e){t.customers=e.content})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)}))},handleSelect:function(e){var t=this.customerContacts.find((function(t){return t.id=e}));this.delivery.contacts=t.contacts,this.delivery.tel=null===t.mobile?t.mobile:t.tel},handleSearch:function(e){var t=this;t.customerContacts=[],Object(L["c"])({customerId:t.customerId}).then((function(e){t.customerContacts=e.content})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)}))},saveAsDraft:function(){var e=this,t=e.$refs.deliveryForm;t.validate().then((function(){e.delivery.deliveryMats=e.deliveryMats;var n=[];n.push(e.delivery),e.loading=!0,Object(q["a"])(n).then((function(n){200===n.code&&(t.resetFields(),e.deliveryMats.splice(0),e.loadTenant(),x["a"].success({message:"成功",description:"录入送货单成功"}))})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){e.loading=!1}))})).catch((function(e){console.debug(e)}))},textFormat:function(e){switch(e){case"draft":return"草稿";case"published":return"已发布";case"confirmed":return"已确认";case"rejected":return"已驳回";case"untreated":return"未处理";case"invalid":return"已作废";default:return e}},dateFormat:function(e){return R()(e).format("YYYY-MM-DD")},handleReceivedDeliveryOrder:function(e){var t=this,n={ids:[t.delivery.id],result:e,reason:t.reason};t.optLoading=!0,Object(q["e"])(n).then((function(e){t.getData(String(t.id),String(t.type)),t.rejectReasonVisible=!1,200===e.code&&x["a"].success({message:"成功",description:"确认成功"})})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){t.optLoading=!1}))},importWordConfirm:function(e){var t=e.file,n=new FormData;n.append("file",t),Object(q["b"])(n).then((function(e){x["a"].success({message:"成功",description:e.msg})})).catch((function(e){x["a"].error({message:"错误",description:e}),console.debug(e)}))}}});n("1ce7"),n("3e9c");U.render=N,U.__scopeId="data-v-2af940a2";t["default"]=U},8418:function(e,t,n){"use strict";var o=n("c04e"),r=n("9bf2"),i=n("5c6c");e.exports=function(e,t,n){var c=o(t);c in e?r.f(e,c,i(0,n)):e[c]=n}},9096:function(e,t,n){"use strict";var o=n("7a23"),r=Object(o["withScopeId"])("data-v-6e02970b");Object(o["pushScopeId"])("data-v-6e02970b");var i={key:0},c={key:1,class:"editable_row_operation"},a={key:0},l={key:1},s=Object(o["createVNode"])("a",null,"删除",-1),d={key:2},u=Object(o["createVNode"])("span",null,"只读状态",-1);Object(o["popScopeId"])();var b=r((function(e,t,n,b,f,v){var p=Object(o["resolveComponent"])("a-input"),h=Object(o["resolveComponent"])("a-popconfirm"),y=Object(o["resolveComponent"])("a-table");return Object(o["openBlock"])(),Object(o["createBlock"])(y,{columns:e.columns,"data-source":e.sourceData,bordered:"","row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},Object(o["createSlots"])({operation:r((function(t){var n=t.record;return[""!==e.destPath?(Object(o["openBlock"])(),Object(o["createBlock"])("div",i,[Object(o["createVNode"])("a",{onClick:function(t){return e.goDtl(n.id)}},"查看详情",8,["onClick"])])):Object(o["createCommentVNode"])("",!0),""===e.destPath&&e.editableCols.length>0?(Object(o["openBlock"])(),Object(o["createBlock"])("div",c,[n.editable?(Object(o["openBlock"])(),Object(o["createBlock"])("span",a,[Object(o["createVNode"])("a",{onClick:function(t){return e.save(n.key)}},"保存",8,["onClick"]),Object(o["createVNode"])("a",{onClick:function(t){return e.cancel(n.key)}},"放弃",8,["onClick"])])):(Object(o["openBlock"])(),Object(o["createBlock"])("span",l,[Object(o["createVNode"])("a",Object(o["mergeProps"])(""!==e.editingKey?{disabled:"disabled"}:{},{onClick:function(t){return e.edit(n.key)}})," 编辑 ",16,["onClick"]),Object(o["createVNode"])(h,Object(o["mergeProps"])(""!==e.editingKey?{disabled:"disabled"}:{},{title:"确定要删除吗？",onConfirm:function(t){return e.onDelete(n.key)}}),{default:r((function(){return[s]})),_:1},16,["onConfirm"])]))])):Object(o["createCommentVNode"])("",!0),""===e.destPath&&0===e.editableCols.length?(Object(o["openBlock"])(),Object(o["createBlock"])("div",d,[u])):Object(o["createCommentVNode"])("",!0)]})),_:2},[Object(o["renderList"])(e.editableCols,(function(t){return{name:t,fn:r((function(n){var r=n.text,i=n.record;return[Object(o["createVNode"])("div",null,[i.editable?(Object(o["openBlock"])(),Object(o["createBlock"])(p,{key:0,style:{width:"100%"},value:r,onChange:function(n){return e.handleChange(n.target.value,i.key,t)}},null,8,["value","onChange"])):(Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],{key:1},[Object(o["createTextVNode"])(Object(o["toDisplayString"])(r),1)],64))])]}))}}))]),1032,["columns","data-source","row-selection"])})),f=(n("4de4"),n("a71a"),n("b558")),v=(n("b550"),n("03ca"),n("e1f5"),n("0464")),p=n("f933"),h=n("f54f"),y=n("4d91"),m=n("daa3"),O=n("b488"),j=n("b92b"),g=n("2db5"),w=n.n(g),k=n("5efb"),V=n("e5cd"),C=n("02ea"),S=n("4df5");function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=Object(h["a"])(),B=Object(j["a"])(),_={name:"APopconfirm",props:N(N({},T),{},{prefixCls:y["a"].string,transitionName:y["a"].string.def("zoom-big"),content:y["a"].any,title:y["a"].any,trigger:T.trigger.def("click"),okType:B.type.def("primary"),disabled:y["a"].bool.def(!1),okText:y["a"].any,cancelText:y["a"].any,icon:y["a"].any,okButtonProps:y["a"].object,cancelButtonProps:y["a"].object,onConfirm:y["a"].func,onCancel:y["a"].func,onVisibleChange:y["a"].func,"onUpdate:visible":y["a"].func}),mixins:[O["a"]],watch:{visible:function(e){this.sVisible=e}},setup:function(){return{configProvider:Object(o["inject"])("configProvider",S["a"])}},data:function(){var e=Object(m["h"])(this),t={sVisible:!1};return"visible"in e&&(t.sVisible=e.visible),"defaultVisible"in e&&(t.sVisible=e.defaultVisible),t},methods:{onConfirmHandle:function(e){this.setVisible(!1,e),this.$emit("confirm",e)},onCancelHandle:function(e){this.setVisible(!1,e),this.$emit("cancel",e)},onVisibleChangeHandle:function(e){var t=this.$props.disabled;t||this.setVisible(e)},setVisible:function(e,t){Object(m["m"])(this,"visible")||this.setState({sVisible:e}),this.$emit("update:visible",e),this.$emit("visibleChange",e,t)},getPopupDomNode:function(){return this.$refs.tooltip.getPopupDomNode()},renderOverlay:function(e,t){var n=this,r=this.okType,i=this.okButtonProps,c=this.cancelButtonProps,a=Object(m["e"])(this,"icon")||Object(o["createVNode"])(w.a,null,null),l=Object(m["p"])(N({size:"small",onClick:this.onCancelHandle},c)),s=Object(m["p"])(N({type:r,size:"small",onClick:this.onConfirmHandle},i));return Object(o["createVNode"])("div",{class:"".concat(e,"-inner-content")},[Object(o["createVNode"])("div",{class:"".concat(e,"-message")},[a,Object(o["createVNode"])("div",{class:"".concat(e,"-message-title")},[Object(m["e"])(this,"title")])]),Object(o["createVNode"])("div",{class:"".concat(e,"-buttons")},[Object(o["createVNode"])(k["a"],l,{default:function(){return[Object(m["e"])(n,"cancelText")||t.cancelText]}}),Object(o["createVNode"])(k["a"],s,{default:function(){return[Object(m["e"])(n,"okText")||t.okText]}})])])}},render:function(){var e,t=this,n=Object(m["h"])(this),r=n.prefixCls,i=this.configProvider.getPrefixCls,c=i("popover",r),a=Object(v["a"])(n,["title","content","cancelText","okText","onUpdate:visible"]),l=Object(o["createVNode"])(V["a"],{componentName:"Popconfirm",defaultLocale:C["a"].Popconfirm,children:function(e){return t.renderOverlay(c,e)}},null),s=N(N({},a),{},{title:l,prefixCls:c,visible:this.sVisible,ref:"tooltip",onVisibleChange:this.onVisibleChangeHandle});return Object(o["createVNode"])(p["a"],s,{default:function(){return[null===(e=t.$slots)||void 0===e?void 0:e.default()]}})},install:function(e){e.component(_.name,_)}},I=_,P=Object(o["defineComponent"])({props:{columns:{type:Array,default:function(){return[]}},sourceData:{type:Array,default:function(){return[]}},editableCols:{type:Array,default:function(){return[]}},destPath:{type:String,default:function(){return""}},type:{type:String,default:function(){return""}},selectedKeys:{type:String,default:function(){return""}}},components:{"a-popconfirm":I,"a-input":f["a"]},data:function(){return{editingKey:"",selectedRowKeys:[]}},computed:{hasSelected:function(){return this.selectedRowKeys.length>0}},methods:{goDtl:function(e){this.$router.push({path:this.destPath,query:{id:e,type:this.type}})},onSelectChange:function(e,t){this.$emit("selected",t),this.selectedRowKeys=this.selectedKeys},edit:function(e){this.editingKey=e;var t=this.sourceData.filter((function(t){return e===t.key}))[0];t&&(t.editable=!0),this.$emit("rowEdit",t)},save:function(e){this.editingKey="";var t=this.sourceData.filter((function(t){return e===t.key}))[0];t&&delete t.editable},cancel:function(e){this.editingKey&&(this.editingKey=""),this.$emit("cancelEdit",e);var t=this.sourceData.filter((function(t){return e===t.key}))[0];t&&delete t.editable},handleChange:function(e,t,n){var o=this.sourceData.filter((function(e){return t===e.key}))[0];o&&(o[n]=e),this.$emit("rowChange",o)},onDelete:function(e){this.editingKey&&(this.editingKey=""),this.$emit("rowDelete",e)}}});n("9f2a");P.render=b,P.__scopeId="data-v-6e02970b";t["a"]=P},"9f2a":function(e,t,n){"use strict";n("1467")},a13b:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"g",(function(){return l})),n.d(t,"j",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return b})),n.d(t,"k",(function(){return f})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return p})),n.d(t,"l",(function(){return h}));var o=n("b32d"),r="http://cloud.dowaysoft.com/Gateway/EblService/api/v1/delivery";function i(e){return Object(o["a"])({url:r+"/loadById",method:"get",params:e})}function c(e){return Object(o["a"])({url:r+"/loadByIdReceived",method:"get",params:e})}function a(e){return Object(o["a"])({url:r+"/generateStatement",method:"post",data:e})}function l(){return Object(o["a"])({url:r+"/queryAll",method:"get"})}function s(){return Object(o["a"])({url:r+"/searchReceivedDelivery",method:"get"})}function d(e){return Object(o["a"])({url:r+"/adds",method:"post",data:e})}function u(e){return Object(o["a"])({url:r+"/handleReceiveDeliveryOrder",method:"post",data:e})}function b(e){return Object(o["a"])({url:r+"/deliveryImport",method:"post",data:e})}function f(e){return Object(o["a"])({url:r+"/sendDeliveryOrder",method:"post",data:e})}function v(e){return Object(o["a"])({url:r+"/searchByExp",method:"post",data:e})}function p(e){return Object(o["a"])({url:r+"/searchReceivedByExp",method:"post",data:e})}function h(e){return Object(o["a"])({url:r+"/update",method:"post",data:e})}},a434:function(e,t,n){"use strict";var o=n("23e7"),r=n("23cb"),i=n("a691"),c=n("50c4"),a=n("7b0b"),l=n("65f0"),s=n("8418"),d=n("1dde"),u=n("ae40"),b=d("splice"),f=u("splice",{ACCESSORS:!0,0:0,1:2}),v=Math.max,p=Math.min,h=9007199254740991,y="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!b||!f},{splice:function(e,t){var n,o,d,u,b,f,m=a(this),O=c(m.length),j=r(e,O),g=arguments.length;if(0===g?n=o=0:1===g?(n=0,o=O-j):(n=g-2,o=p(v(i(t),0),O-j)),O+n-o>h)throw TypeError(y);for(d=l(m,o),u=0;u<o;u++)b=j+u,b in m&&s(d,u,m[b]);if(d.length=o,n<o){for(u=j;u<O-o;u++)b=u+o,f=u+n,b in m?m[f]=m[b]:delete m[f];for(u=O;u>O-o+n;u--)delete m[u-1]}else if(n>o)for(u=O-o;u>j;u--)b=u+o-1,f=u+n-1,b in m?m[f]=m[b]:delete m[f];for(u=0;u<n;u++)m[u+j]=arguments[u+2];return m.length=O-o+n,d}})},bbb4:function(e,t,n){}}]);