(window["webpackJsonp_cloud-ebl-app"]=window["webpackJsonp_cloud-ebl-app"]||[]).push([["views-statement-RecordPage-vue"],{1815:function(e,t,n){"use strict";n("b550"),n("d79d")},"1e76":function(e,t,n){"use strict";n("4c4d")},"4c4d":function(e,t,n){},"50ac":function(e,t,n){"use strict";n("b550"),n("d79d")},"5ed4":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"h",(function(){return i})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"m",(function(){return h})),n.d(t,"l",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"j",(function(){return b})),n.d(t,"k",(function(){return m})),n.d(t,"b",(function(){return j}));var c=n("b32d"),a="http://cloud.dowaycn.com/Gateway/EblService/api/v1/statement";function r(e){return Object(c["a"])({url:a+"/loadById",method:"get",params:e})}function o(e){return Object(c["a"])({url:a+"/loadByIdReceived",method:"get",params:e})}function i(){return Object(c["a"])({url:a+"/queryAll",method:"get"})}function s(e){return Object(c["a"])({url:a+"/queryAllByCustId",method:"get",params:e})}function u(){return Object(c["a"])({url:a+"/queryAllReceived",method:"get"})}function d(e){return Object(c["a"])({url:a+"/generateInvoice",method:"post",data:e})}function l(e){return Object(c["a"])({url:a+"/add",method:"post",data:e})}function h(e){return Object(c["a"])({url:a+"/update",method:"post",data:e})}function p(e){return Object(c["a"])({url:a+"/sendStatement",method:"post",data:e})}function f(e){return Object(c["a"])({url:a+"/handleReceivedStatement",method:"post",data:e})}function b(e){return Object(c["a"])({url:a+"/searchByExp",method:"post",data:e})}function m(e){return Object(c["a"])({url:a+"/searchReceivedByExp",method:"post",data:e})}function j(){return Object(c["a"])({url:a+"/autoCreateStatement",method:"get"})}},"9a63":function(e,t,n){"use strict";var c=n("290c");c["a"].install=function(e){e.component(c["a"].name,c["a"])},t["a"]=c["a"]},afb4:function(e,t,n){"use strict";n.r(t);var c=n("7a23"),a=Object(c["createTextVNode"])(" 发送 "),r=Object(c["createTextVNode"])(" 生成发票 "),o=Object(c["createTextVNode"])(" 对账单号 "),i=Object(c["createTextVNode"])(" 客户名称 "),s=Object(c["createTextVNode"])(" 确认 "),u=Object(c["createTextVNode"])(" 驳回 "),d=Object(c["createTextVNode"])(" 对账单号 "),l=Object(c["createTextVNode"])(" 客户名称 ");function h(e,t,n,h,p,f){var b=Object(c["resolveComponent"])("a-button"),m=Object(c["resolveComponent"])("a-col"),j=Object(c["resolveComponent"])("a-select-option"),O=Object(c["resolveComponent"])("a-select"),v=Object(c["resolveComponent"])("a-input-search"),y=Object(c["resolveComponent"])("a-input-group"),g=Object(c["resolveComponent"])("a-row"),x=Object(c["resolveComponent"])("BaseTableEditable"),C=Object(c["resolveComponent"])("a-spin"),w=Object(c["resolveComponent"])("a-tab-pane"),N=Object(c["resolveComponent"])("a-tabs"),V=Object(c["resolveComponent"])("a-textarea"),k=Object(c["resolveComponent"])("a-modal");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])(N,{activeKey:e.currentKey,"onUpdate:activeKey":t[7]||(t[7]=function(t){return e.currentKey=t})},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(w,{key:"send",tab:"我发送的"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(g,{class:"header"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(m,{span:10},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(b,{disabled:0===e.ids.length,loading:e.optLoading,type:"primary",style:{margin:"0px 10px 10px 10px"},onClick:e.send},{default:Object(c["withCtx"])((function(){return[a]})),_:1},8,["disabled","loading","onClick"]),Object(c["createVNode"])(b,{disabled:0===e.ids.length,loading:e.generateLoading,type:"primary",onClick:e.generateInvoice,style:{margin:"0px 10px 10px 10px"}},{default:Object(c["withCtx"])((function(){return[r]})),_:1},8,["disabled","loading","onClick"])]})),_:1}),Object(c["createVNode"])(m,{span:14},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(y,{compact:""},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(O,{value:e.searchType,"onUpdate:value":t[1]||(t[1]=function(t){return e.searchType=t}),placeholder:"选择搜索条件",style:{width:"100px"},onChange:e.handleSelectChange},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(j,{value:"code"},{default:Object(c["withCtx"])((function(){return[o]})),_:1}),Object(c["createVNode"])(j,{value:"custName"},{default:Object(c["withCtx"])((function(){return[i]})),_:1})]})),_:1},8,["value","onChange"]),Object(c["createVNode"])(v,{value:e.searchExp,"onUpdate:value":t[2]||(t[2]=function(t){return e.searchExp=t}),style:{width:"80%"},placeholder:"请输入搜索内容","enter-button":"",onSearch:e.onSearch},null,8,["value","onSearch"])]})),_:1})]})),_:1})]})),_:1}),Object(c["createVNode"])(C,{spinning:e.listLoading},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(x,{columns:e.columns,sourceData:e.sourceData,selectedKeys:e.selectedKeys,destPath:"/statementRecordDtl",type:"send",onSelected:e.setIds},null,8,["columns","sourceData","selectedKeys","onSelected"])]})),_:1},8,["spinning"])]})),_:1}),Object(c["createVNode"])(w,{key:"receive",tab:"我接收的"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(g,{class:"header"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(m,{span:10},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(b,{disabled:0===e.ids.length,loading:e.optLoading,type:"primary",style:{margin:"0px 10px 10px 10px"},onClick:t[3]||(t[3]=function(t){return e.handleReceivedStatement("adopt")})},{default:Object(c["withCtx"])((function(){return[s]})),_:1},8,["disabled","loading"]),Object(c["createVNode"])(b,{disabled:0===e.ids.length,loading:e.optLoading,type:"primary",style:{",argin":"0px 10px 10px 10px"},onClick:t[4]||(t[4]=function(t){return e.rejectReasonModal=!0})},{default:Object(c["withCtx"])((function(){return[u]})),_:1},8,["disabled","loading"])]})),_:1}),Object(c["createVNode"])(m,{span:14},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(y,{compact:""},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(O,{value:e.searchType,"onUpdate:value":t[5]||(t[5]=function(t){return e.searchType=t}),placeholder:"选择搜索条件",style:{width:"100px"},onChange:e.handleSelectChange},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(j,{value:"code"},{default:Object(c["withCtx"])((function(){return[d]})),_:1}),Object(c["createVNode"])(j,{value:"custName"},{default:Object(c["withCtx"])((function(){return[l]})),_:1})]})),_:1},8,["value","onChange"]),Object(c["createVNode"])(v,{value:e.searchExp,"onUpdate:value":t[6]||(t[6]=function(t){return e.searchExp=t}),style:{width:"80%"},placeholder:"请输入搜索内容","enter-button":"",onSearch:e.onSearch},null,8,["value","onSearch"])]})),_:1})]})),_:1})]})),_:1}),Object(c["createVNode"])(C,{spinning:e.listLoading},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(x,{columns:e.columns,sourceData:e.receivedSourceData,selectedKeys:e.selectedKeys,destPath:"/statementRecordDtl",type:"receive",onSelected:e.setIds},null,8,["columns","sourceData","selectedKeys","onSelected"])]})),_:1},8,["spinning"])]})),_:1})]})),_:1},8,["activeKey"]),Object(c["createVNode"])(k,{visible:e.rejectReasonModal,"onUpdate:visible":t[9]||(t[9]=function(t){return e.rejectReasonModal=t}),centered:"",closable:!1,"mask-closable":!1,onOk:t[10]||(t[10]=function(t){return e.handleReceivedInvoice("reject")}),okText:"确定",cancelText:"取消"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(V,{value:e.reason,"onUpdate:value":t[8]||(t[8]=function(t){return e.reason=t}),placeholder:"请输入驳回原因",rows:8},null,8,["value"])]})),_:1},8,["visible"])],64)}n("4160"),n("a434"),n("d3b7"),n("159b"),n("368b");var p=n("56cd"),f=(n("04f3"),n("ed3b")),b=(n("1815"),n("e32c")),m=(n("50ac"),n("9a63")),j=(n("e1f5"),n("5efb")),O=n("9096"),v=n("5ed4"),y=n("5f70"),g=n.n(y),x=Object(c["defineComponent"])({components:{BaseTableEditable:O["a"],"a-button":j["a"],"a-row":m["a"],"a-col":b["a"],"a-modal":f["a"]},setup:function(){var e=Object(c["ref"])(!1),t=Object(c["ref"])(!1),n=Object(c["ref"])(!1),a=Object(c["reactive"])([]),r=Object(c["reactive"])([{title:"序号",dataIndex:"key",key:"key",width:70},{title:"对账单号",dataIndex:"code",key:"code"},{title:"客户名称",dataIndex:"custName",key:"custName",ellipsis:!0},{title:"时间范围",dataIndex:"timeRange",key:"timeRange",ellipsis:!0},{title:"对账方",dataIndex:"statementParty",key:"statementParty",ellipsis:!0},{title:"对账金额",dataIndex:"amount",key:"amount",ellipsis:!0},{title:"状态",dataIndex:"status",key:"status",ellipsis:!0},{title:"操作",dataIndex:"operation",key:"operation",slots:{customRender:"operation"}}]),o=Object(c["reactive"])([]),i=Object(c["reactive"])([]),s=(Object(c["reactive"])([]),Object(c["ref"])(!1)),u=Object(c["ref"])(""),d=Object(c["ref"])("send"),l=Object(c["ref"])("code"),h=Object(c["ref"])(""),f=Object(c["ref"])(""),b=Object(c["reactive"])([]),m=function(e){switch(e){case"draft":return"草稿";case"published":return"已发送";case"confirmed":return"已确认";case"rejected":return"已驳回";case"untreated":return"未处理";default:return e}},j=function(){n.value=!0,Object(v["h"])().then((function(e){e.content.forEach((function(e){o.push({key:String(o.length+1),id:e.id,code:e.code,custName:e.custName,timeRange:g()(e.startTime).format("YYYY-MM-DD")+"--"+g()(e.endTime).format("YYYY-MM-DD"),statementParty:e.statementParty,amount:e.amount,received:e.received,unreceived:e.unreceived,status:m(e.status),authorizationCode:e.authorizationCode,rowVersion:e.rowVersion})}))})).catch((function(e){p["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){n.value=!1}))},O=function(){n.value=!0,Object(v["g"])().then((function(e){i.splice(0),e.content.forEach((function(e){i.push({key:String(i.length+1),id:e.id,code:e.code,custName:e.custName,timeRange:g()(e.startTime).format("YYYY-MM-DD")+"--"+g()(e.endTime).format("YYYY-MM-DD"),statementParty:e.statementParty,amount:e.amount,received:e.received,unreceived:e.unreceived,status:m(e.status),rowVersion:e.rowVersion,authorizationCode:e.authorizationCode})}))})).catch((function(e){p["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){n.value=!1}))},y=function(e,t){Object(v["j"])({expCondition:e,expContent:t}).then((function(e){o.splice(0),e.content.forEach((function(e){o.push({key:String(o.length+1),id:e.id,code:e.code,custName:e.custName,timeRange:g()(e.startTime).format("YYYY-MM-DD")+"--"+g()(e.endTime).format("YYYY-MM-DD"),statementParty:e.statementParty,amount:e.amount,received:e.received,unreceived:e.unreceived,status:m(e.status),authorizationCode:e.authorizationCode,rowVersion:e.rowVersion})}))})).catch((function(e){p["a"].error({message:"错误",description:e}),console.debug(e)}))},x=function(e,t){Object(v["k"])({expCondition:e,expContent:t}).then((function(e){i.splice(0),e.content.forEach((function(e){i.push({key:String(i.length+1),id:e.id,code:e.code,custName:e.custName,timeRange:g()(e.startTime).format("YYYY-MM-DD")+"--"+g()(e.endTime).format("YYYY-MM-DD"),statementParty:e.statementParty,amount:e.amount,received:e.received,unreceived:e.unreceived,status:m(e.status),rowVersion:e.rowVersion,authorizationCode:e.authorizationCode})}))})).catch((function(e){p["a"].error({message:"错误",description:e}),console.debug(e)}))};return{optLoading:e,generateLoading:t,listLoading:n,selectedKeys:a,columns:r,sourceData:o,receivedSourceData:i,rejectReasonModal:s,reason:u,textFormat:m,queryAll:j,queryAllReceivedStatement:O,currentKey:d,ids:b,searchExp:f,searchType:l,searchReceivedType:h,searchStatementByExp:y,searchStatementReceivedByExp:x}},watch:{currentKey:{handler:function(e){switch(e){case"send":this.searchType="code",this.searchExp="",this.ids.splice(0),this.sourceData.splice(0),this.queryAll();break;case"receive":this.searchReceivedType="custName",this.searchExp="",this.ids.splice(0),this.receivedSourceData.splice(0),this.queryAllReceivedStatement();break;default:break}},immediate:!0}},methods:{handleSelectChange:function(e,t){this.searchType=e},setIds:function(e){var t=this;t.ids.splice(0),t.selectedKeys.splice(0),null!==e&&(console.log(e),e.forEach((function(e){switch(t.currentKey){case"send":"草稿"!==e.status?p["a"].warning({message:"警告",description:"对账单号"+e.code+e.status+",不能重复勾选"}):(t.ids.push(e.id),t.selectedKeys.push(e.key));break;case"receive":"未处理"!==e.status?p["a"].warning({message:"警告",description:"对账单号"+e.code+e.status+",不能重复勾选"}):(t.ids.push(e.id),t.selectedKeys.push(e.key));break;default:break}})))},addStatement:function(){this.$router.push({path:"/statementRecordDtl"})},generateInvoice:function(){var e=this;e.generateLoading=!0,Object(v["c"])(this.ids).then((function(e){200===e.code&&p["a"].success({message:"成功",description:"已成功生成发票"})})).catch((function(e){p["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){e.generateLoading=!1}))},onSearch:function(e){switch(this.currentKey){case"send":this.searchStatementByExp(this.searchType,this.searchExp);break;case"receive":this.searchStatementReceivedByExp(this.searchType,this.searchExp);break;default:break}},send:function(){var e=this;f["a"].confirm({title:"请确认",content:"确定要发送当前对账单吗?",cancelText:"取消",okText:"确认",onOk:function(){e.optLoading=!0,Object(v["l"])(e.ids).then((function(t){"send"===e.currentKey?(e.searchType="code",e.searchExp="",e.ids.splice(0),e.queryAll()):"receive"===e.currentKey&&(e.searchReceivedType="custName",e.searchExp="",e.ids.splice(0),e.queryAllReceivedStatement()),200===t.code&&p["a"].success({message:"成功",description:"发送成功"})})).catch((function(e){p["a"].error({message:"错误",description:e}),console.debug(e)})).finally((function(){e.optLoading=!1}))}})},handleReceivedStatement:function(e){var t=this,n={ids:this.ids,result:e,reason:this.reason};Object(v["e"])(n).then((function(e){"send"===t.currentKey?(t.searchType="code",t.searchExp="",t.ids.splice(0),t.queryAll()):"receive"===t.currentKey&&(t.searchReceivedType="custName",t.searchExp="",t.ids.splice(0),t.queryAllReceivedStatement()),t.rejectReasonModal=!1,200===e.code&&p["a"].success({message:"成功",description:"已处理"})})).catch((function(e){p["a"].error({message:"错误",description:e}),console.debug(e)}))}}});n("1e76");x.render=h;t["default"]=x},e32c:function(e,t,n){"use strict";var c=n("da05");c["b"].install=function(e){e.component(c["b"].name,c["b"])},t["a"]=c["b"]}}]);